<div class="ui-g">
    <div class="ui-g-12 no-padding">
        <div class="card no-padding">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-12">
                            <h2 i18n class="panel-title pull-left">
                                Drawdown Approvals
                                <!-- Tranche Disbursement Booking Approval -->  
                            </h2>
                        </div>
                    </div>
                </div>
                <div class="panel-body">
                    <p-accordion *ngIf="isPoolRequest == true"  #accordion1>
                        <p-accordionTab i18n-header [selected]="true" header="DRAWDOWN REQUEST - GENERAL POOL" >
                            <!-- Add general Datatable here (onRowSelect)="onSelectedLoanChange($event)"-->
                            <p-dataTable [paginator]="true" resizableColumns="true" [responsive]="true"
                                [value]="loanApprovalData" [rows]="5" 
                                 (onRowSelect)="pushSelectedPendingLoanRequests($event)" (onRowUnselect)="popSelectedPendingLoanRequests($event)">
                                <p-column [style]="{'width':'37px'}" [selection]=true selectionMode="multiple" (onRowSelect)="pushSelectedPendingLoanRequests($event)" (onRowUnselect)="popSelectedPendingLoanRequests($event)" ></p-column>
                                <p-column i18n-header [style]="{'width':'70px'}" field="divisionCode" header="Unit" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>

                                <p-column i18n-header field="systemArrivalDateTime" [style]="{'width':'90px'}" header="Arrival Date" sortable="true" [filter]="true" filterMatchMode="contains">
                                <ng-template let-i="rowIndex" let-row="rowData" pTemplate type="body">
                                    {{ row.systemArrivalDateTime | date: 'medium' }}
                                </ng-template>
                            </p-column>
                                <p-column i18n-header field="loanTypeName" [style]="{'width':'100px'}" header="Type" sortable="true"
                                    [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header field="productClassName" [style]="{'width':'100px'}" header="Class" sortable="true"
                                    [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header field="productTypeName" [style]="{'width':'145px'}" header="Facility Type"
                                    sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header field="applicationReferenceNumber" [style]="{'width':'100px'}" header="Ref No"
                                    sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header [style]="{'width':'50px'}" field="isLineFacilityString" header="Is A Line"
                                    sortable="true" [filter]="true" filterMatchMode="contains"></p-column>

                                <p-column i18n-header field="customerName" [style]="{'width':'150px'}" header="Obligor Name" sortable="true"
                                    [filter]="true" filterMatchMode="contains">
                                    <ng-template pTemplate="body" let-item="rowData">
                                        <span *ngIf="item.loanTypeId == 3">{{item.applicantName}}</span>
                                        <span *ngIf="item.loanTypeId != 3">{{item.customerName}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header [style]="{'text-align':'right','width':'135px'}" field="approvedAmount"
                                    header="Approved Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                                    <ng-template pTemplate="body" let-item="rowData">
                                        {{item.approvedAmount | currency:item.currencyCode:true:'1.2-2'}}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header [style]="{'text-align':'right','width':'135px'}" field="requestedAmount"
                                    header="Amount Requested" sortable="true" [filter]="true" filterMatchMode="contains">
                                    <ng-template pTemplate="body" let-item="rowData">
                                        {{item.requestedAmount | currency:item.currencyCode:true:'1.2-2'}}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header [style]="{'width':'50px'}" field="interestRate" header="Interest" [filter]="true"
                                    filterMatchMode="contains"></p-column>
                                <p-column i18n-header [style]="{'width':'80px'}" field="approvedTenor" header="Tenor" sortable="true"
                                    [filter]="true" filterMatchMode="contains">
                                    <ng-template pTemplate="body" let-item="rowData">
                                        {{item.approvedTenorString}}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header [style]="{'width':'9%'}">
                                    <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                        <div class="btn-group"
                                            [innerHtml]="getApplicationStatus(row.approvalStatusId)">
                                        </div>
                                    </ng-template>
                                </p-column>
                            </p-dataTable>                            
                            <div *ngIf="workflowTargets.length > 0" class="row">
                                <div></div>
                                <div class="form-group" class="col-md-12 ">
                                    <div class="col-md-12" >
                                        <button (click)="AddToMyDesk()" class="btn btn-primary pull-right">
                                            <span class="glyphicon glyphicon-plus"></span>
                                            <ng-container i18n>Add To My Desk</ng-container>
                                            
                                        </button>
                                    </div>
                                </div>
                            </div>  
                        </p-accordionTab>                
                    </p-accordion>
                    <p-accordion  #accordion2>
                        <p-accordionTab i18n-header [selected]="true" header="MY DESK" >
                                <p-dataTable [paginator]="true" resizableColumns="true" [responsive]="true"
                                    [value]="assignedApplications" [rows]="5" selectionMode="single" [(selection)]="loanSelection"
                                    (onRowSelect)="onSelectedLoanChange($event)">
                                    <p-column [style]="{'width':'37px'}" selectionMode="single"></p-column>
                                    <p-column i18n-header [style]="{'width':'70px'}" field="divisionCode" header="Unit" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
    
                                    <p-column i18n-header field="systemArrivalDateTime" [style]="{'width':'90px'}" header="Arrival Date" sortable="true" [filter]="true" filterMatchMode="contains">
                                    <ng-template let-i="rowIndex" let-row="rowData" pTemplate type="body">
                                        {{ row.systemArrivalDateTime | date: 'medium' }}
                                    </ng-template>
                                </p-column>
                                    <p-column i18n-header field="loanTypeName" [style]="{'width':'100px'}" header="Type" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="productClassName" [style]="{'width':'100px'}" header="Class" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="productTypeName" [style]="{'width':'145px'}" header="Facility Type"
                                        sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="applicationReferenceNumber" [style]="{'width':'100px'}" header="Ref No"
                                        sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header [style]="{'width':'50px'}" field="isLineFacilityString" header="Is A Line"
                                        sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
    
                                    <p-column i18n-header field="customerName" [style]="{'width':'150px'}" header="Obligor Name" sortable="true"
                                        [filter]="true" filterMatchMode="contains">
                                        <ng-template pTemplate="body" let-item="rowData">
                                            <span *ngIf="item.loanTypeId == 3">{{item.applicantName}}</span>
                                            <span *ngIf="item.loanTypeId != 3">{{item.customerName}}</span>
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header [style]="{'text-align':'right','width':'135px'}" field="approvedAmount"
                                        header="Approved Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                                        <ng-template pTemplate="body" let-item="rowData">
                                            {{item.approvedAmount | currency:item.currencyCode:true:'1.2-2'}}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header [style]="{'text-align':'right','width':'135px'}" field="requestedAmount"
                                        header="Amount Requested" sortable="true" [filter]="true" filterMatchMode="contains">
                                        <ng-template pTemplate="body" let-item="rowData">
                                            {{item.requestedAmount | currency:item.currencyCode:true:'1.2-2'}}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header [style]="{'width':'50px'}" field="interestRate" header="Interest" [filter]="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header [style]="{'width':'80px'}" field="approvedTenor" header="Tenor" sortable="true"
                                        [filter]="true" filterMatchMode="contains">
                                        <ng-template pTemplate="body" let-item="rowData">
                                            {{item.approvedTenorString}}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header   header="My Desk">
                                        <ng-template let-assignedApplications="rowData" let-i="rowIndex" pTemplate="body">
                                            <a (click)="onReturnToPool(assignedApplications)" style="display: block" href="javascript:void(0)">
                                                <i class="fa fa-undo" aria-hidden="true"></i>Undo
                                            </a>
                                        </ng-template>
                                    </p-column>
                                    <p-column [style]="{'width':'9%'}">
                                        <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                            <div class="btn-group"
                                                [innerHtml]="getApplicationStatus(row.approvalStatusId)">
                                            </div>
                                        </ng-template>
                                    </p-column>
                                </p-dataTable>                            
                                                          
                        </p-accordionTab>
                    </p-accordion>
                </div>
            </div>
        </div>
    </div>
</div>

<p-dialog [responsive]=true [(visible)]="displayLoanToApproveModal" [draggable]="false" 
    modal="modal" width="1200" [contentStyle]="{'overflow':'auto','max-height':'700px'}">
    <div class="panel-heading">
        <div class="row">
            <div class="col-md-12">
                <h2 class="panel-title">
                    DrawDown Booking Approval :: {{loanSelectedData.customerName}}
                    <!-- Tranche Disbursement Booking Approval :: {{loanSelectedData.customerName}} -->
                </h2>
                <div class="pull-right">
                    <a class="close" (click)="closeDrawdown()">&times;</a>
                </div>
            </div>
        </div>
    </div>
    <div class="panel-body">

        <p-tabView>
             <p-tabPanel i18n-header *ngIf="!userIsAccountOfficer" header="Drawdown Memo">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 i18n class="panel-title pull-left">
                                        Drawdown Memo
                                    </h2>
                                    <button i18n  (click)="printMemo()" style="margin-left:25px" >Generate Drawdown Memo</button>
                                           
                                     <!-- <button type="button" (click)="displayReport=false" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button> -->
                                </div>
                            </div>
                        </div>
                        <!-- <div *ngIf="drawdownHtml != null" class="panel-body" style="min-height:450px;">
                            <CKEDITOR [content]="drawdownHtml" [height]="400"
                                (contentChange)="contentChange($event)"></CKEDITOR>
                        </div> -->
                        <div id="print-section" *ngIf="!userIsAccountOfficer" class="panel-body" [innerHtml]="drawdownHtml">
                        </div>
                    </div>
            </p-tabPanel>
            <!-- <p-tabPanel header="Deferral Memo">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left">
                                            Deferral Memo
                                    </h2>
                
                                </div>
                            </div>
                        </div>
                        <<div *ngIf="drawdownHtml != null" class="panel-body" style="min-height:450px;">
                            <CKEDITOR [content]="drawdownHtml" [height]="400"
                                (contentChange)="contentChange($event)"></CKEDITOR>
                        </div> 
                        <div class="panel-body" [innerHtml]="drawdownDeferralHtml">
                        </div>
                    </div>
            </p-tabPanel> -->
            <p-tabPanel i18n-header header="Loan Disbursement Approval">
                <div class="panel-body" style="overflow:scroll; height:300px">
                    <h5>
                        <b>Source: </b>{{ loanSource }}
                    </h5>
                    <div class="col-md-8">
                        <span *ngIf="isLienPlacementForLoan" style="color: red; font-weight: bold;">NOTE: LIEN HAS BEEN PLACED FOR THIS LOAN!</span>
                    </div>
                    <form novalidate [formGroup]="generalInputForm" autocomplete="off">
                    <table class="table table-customer-information">
                        <tbody>
                            <tr>
                                <td><strong i18n>Application Reference Number</strong></td>
                                <td>{{ loanSelectedData.applicationReferenceNumber }}</td>
                                <td><strong i18n>Loan Type</strong></td>
                                <td>{{ loanSelectedData.loanTypeName }}</td>
                            </tr>
                            <tr>
                                <td><strong i18n>Product Name</strong></td>
                                <td>{{ loanSelectedData.productName }}</td>
                                <td><strong i18n>Product Type</strong></td>
                                <td>{{ loanSelectedData.productTypeName}}</td>
                            </tr>
                            <tr>
                                <td><strong i18n>Approved Tenor</strong></td>
                                <td>{{ loanSelectedData.approvedTenorString }}</td>
                                <td><strong i18n>Interest Rate</strong></td>
                                <td>{{ loanSelectedData.interestRate }}</td>
                            </tr>
                            <tr>
                                <td><strong i18n>Approved Amount</strong></td>
                                <td>{{loanSelectedData.approvedAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                                <td><strong i18n>Disbursed Amount</strong></td>
                                <td>{{ loanSelectedData.amountDisbursed | number: '1.2'}}</td>
                            </tr>
                            <tr>
                                <td><strong i18n>Previous Request</strong></td>
                                <td>{{ loanSelectedData.allRequestAmount - loanSelectedData.requestedAmount | currency:loanSelectedData.currencyCode:true: '1.2-2' }}
                                </td>
                                <td><strong i18n>New Request</strong></td>
                                <td>{{ loanSelectedData.requestedAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                            </tr>
                            <tr>
                                <td><strong i18n>Unapproved Request</strong></td>
                                <td>{{ loanSelectedData.pendingRequestAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                                <td><strong i18n>Approved Request</strong></td>
                                <td>{{ loanSelectedData.approveRequestAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                            </tr>
                            <tr>
                                <td><strong i18n>Total Request</strong></td>
                                <td>{{ loanSelectedData.allRequestAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                                <td><strong i18n>Available Balance</strong></td>
                                <td>{{ loanSelectedData.approvedAmount - loanSelectedData.allRequestAmount | currency:loanSelectedData.currencyCode:true: '1.2-2'}}
                                </td>
                            </tr>
                            <tr>
                                <td><strong i18n>Receiving Account</strong></td>
                                <td>{{ loanSelectedData.accountNumber ? loanSelectedData.accountNumber : 'n/a'}}</td>
                                <td><strong i18n>Paying Account</strong></td>
                                <td>{{ loanSelectedData.accountNumber2 ? loanSelectedData.accountNumber2 : 'n/a'}}</td>
                            </tr>
                            <tr>
                                <td *ngIf="loanSelectedData.isLineMaintained == true && staffRoleRecord.staffRoleCode == 'LEGAL'">
                                    <input type="checkbox" [(ngModel)]="documentProvided" class="form-control" name="documentProvided" id="documentProvided" formControlName="documentProvided"
                                    class="form-control" (click)="setLegalDocumentStatusForLineFacility($event)"
                                     value="{{loanSelectedData?.documentProvided}}"> Document is provided?
                                </td>
                                <td>
                                </td>
                                <td></td>
                                <td></td>
                            </tr>
                            

                            <!-- <tr>
                                <td><strong i18n>Comment</strong></td>
                                <td><textarea [ngClass]="!loanSelectedData.comment ? 'required-input' : 'valid-input'" class="form-control" [(ngModel)]="loanSelectedData.comment" name="comment" cols="15" rows="3"></textarea></td>
                                <td><strong i18n>Status</strong></td>
                                <td>
                                    <select name="approvalStatus" (change)="resetButton($event.target.value)" id="approvalStatus" class="form-control" [(ngModel)]="loanSelectedData.loanApprovalStatusId" [ngClass]="!loanSelectedData.loanApprovalStatusId ? 'required-input' : 'valid-input'">
                                            <option value="">--- Select Approval Status ---</option>
                                            <option *ngFor="let item of approvalStatusData" [value]="item.approvalStatusId">{{item.approvalStatusName}}</option>
                                        </select>
                                </td>
                            </tr> -->
                        </tbody>
                    </table>
                    </form>

                </div>
            </p-tabPanel>
            <p-tabPanel i18n-header header="Appraisal Memorandum">
                <div *ngIf="isMultipleDrawdown" class="panel-body">
                    <p-dataTable [paginator]="false" resizableColumns="true" [responsive]="true"
                        [value]="drawdownFacilitiesInformation" selectionMode="single"
                        (onRowSelect)="pushSelectedLoans($event)" (onRowUnselect)="popSelectedLoans($event)">
                        <p-header i18n>Multiple Facility Drawdown</p-header>
                        <!-- <p-column [style]="{'width':'38px'}" selectionMode="multiple"></p-column> -->
                        <p-column i18n-header [style]="{'width':'150px'}" field="productTypeName" header="Facility Type"
                            sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header [style]="{'width':'150px'}" field="productName" header="Facility Name" sortable="true"
                            [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header field="applicationReferenceNumber" header="Ref No" sortable="true" [filter]="true"
                            filterMatchMode="contains"></p-column>
                        <p-column i18n-header [style]="{'width':'150px'}" field="customerName" header="Obligor Name" sortable="true"
                            [filter]="true" filterMatchMode="contains">
                            <ng-template pTemplate="body" let-item="rowData">
                                <span *ngIf="item.loanTypeId == 3">{{item.applicantName}}</span>
                                <span *ngIf="item.loanTypeId != 3">{{item.customerName}}</span>
                            </ng-template>
                        </p-column>
                        <p-column i18n-header [style]="{'text-align':'right','width':'115px'}" field="approvedAmount"
                            header="Approved Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                            <ng-template pTemplate="body" let-item="rowData">
                                {{item.approvedAmount | currency:item.currencyCode:true: '1.2-2'}}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header [style]="{'text-align':'right','width':'115px'}" field="amountDisbursed"
                            header="Disbursed Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                            <ng-template pTemplate="body" let-item="rowData">
                                {{item.amountDisbursed | currency:item.currencyCode:true: '1.2-2'}}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header [style]="{'text-align':'right','width':'115px'}" field="allRequestAmount"
                            header="Requested Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                            <ng-template pTemplate="body" let-item="rowData">
                                {{item.allRequestAmount | currency:item.currencyCode:true: '1.2-2'}}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header [style]="{'width':'50px'}" field="interestRate" header="Interest" [filter]="true"
                            filterMatchMode="contains"></p-column>
                        <p-column i18n-header [style]="{'width':'80px'}" field="approvedTenor" header="Tenor" sortable="true"
                            [filter]="true" filterMatchMode="contains">
                            <ng-template pTemplate="body" let-item="rowData">
                                {{item.approvedTenorString}}
                            </ng-template>
                        </p-column>
                    </p-dataTable>
                </div>
                <!-- [disabled]="disableAppraisalMemorandumTab || applicationSelection.productClassProcessId == 2"> -->

                <!-- cam document -->
                <div class="card no-padding">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-9">
                                </div>
                                <div class="col-md-3">
                                    <div class="pull-right">
                                        <!-- <button *ngIf="displayDocumentation == false" (click)="previewDocumentation()" style="padding: 3px 6px 3px 6px;">
                                        <span class="glyphicon glyphicon-file"></span> Preview</button> -->
                                        <button (click)="previewDocumentation(true)" style="padding: 3px 6px 3px 6px;">
                                            <span class="glyphicon glyphicon-print"></span><span i18n>Print</span></button>
                                    </div>
                                    
                                </div>
                            </div>
                            <h2  *ngIf="documentations?.length > 0" class="panel-title">
                                <ng-container i18n> Appraisal Documentation for REFERENCE:</ng-container>
                                <strong>{{ loanSelection?.applicationReferenceNumber }}</strong> of OBLIGOR:
                                <strong>{{ loanSelection?.customerName }}</strong>
                            </h2>
                        </div>

                        <!-- Default FAM Preview -->
                        <div class="panel panel-default">
                            <!-- <div class="panel-heading">
                            <h2 i18n *ngIf="documentations != null && documentations != undefined && documentations.length > 0" class="panel-title">
                                Appraisal Documentation for REFERENCE:
                                <strong>{{ loanSelection?.applicationReferenceNumber }}</strong> of OBLIGOR:
                                <strong>{{ loanSelection?.customerName }}</strong>
                            </h2>
                            <div class="pull-right">
                                <a class="close" (click)="closeDocumentation()">&times;</a>
                            </div>
                        </div> -->

                            <div class="panel-body" style="overflow:auto;height:400px">
                                <div *ngFor="let x of documentations">
                                    <p><strong>{{x.title}}</strong></p>
                                    <p><span [innerHtml]="x.templateDocument"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- endof cam document 1 -->
            </p-tabPanel>
            <p-tabPanel i18n-header header="Offer Letter">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-md-12">
                                <h2 i18n class="panel-title pull-left">
                                    Generated Offer Letter
                                </h2>
                                <!-- <button type="button" (click)="displayReport=false" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button> -->
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="500px" width="750px"
                            style="overflow:auto"></iframe>
                        <!-- <div class="col-md-12"  style=" width:1000px; overflow:auto;">

                    </div> -->
                    </div>
                </div>
            </p-tabPanel> 
            <p-tabPanel i18n-header header="Approval Comments">
                <div class="panel panel-default" *ngIf="loanSelectedData">
                        <app-approval-comments [all]="true" [tableLabel]="'Approval Process Comments'" [operationId]="loanSelectedData?.appraisalOperationId" [applicationId]="loanSelectedData?.loanApplicationId"></app-approval-comments>
                           
                        <!-- <app-approval-comments [operationId]="loanSelectedData?.appraisalOperationId" 
                        [applicationId]="loanSelectedData?.loanApplicationId"  [tableLabel]="creditAppraisalComment">
                    </app-approval-comments>

                    <app-approval-comments [operationId]="loanSelectedData.operationId" 
                        [tableLabel]="drawdownComment"
                        [applicationId]="loanSelectedData.loanBookingRequestId">
                    </app-approval-comments> -->
                </div>
                <!-- <p-dataTable [value]="approvalWorkflowData" [paginator]="true" [rows]="5" [responsive]="true">
                    <p-column field="requestStaffName" header="Intiated By"></p-column>
                    <p-column field="requestApproval Level" header="Initiator Approval Level"></p-column>
                    <p-column field="responseStaffName" header="Directed To"></p-column>
                    <p-column field="responseApproval Level" header="Response Approval Level"></p-column>
                    <p-column field="approvalStatus" header="Approval Status"></p-column>
                    <p-column field="comment" header="Comment"></p-column>
                    <p-column field="systemArrivalDate" header="Date of Arrival">
                        <ng-template let-col let-apr="rowData" pTemplate="body">
                            {{apr[col.field] | date: 'medium'}}
                        </ng-template>
                    </p-column>
                    <p-column field="systemResponseDate" header="Date of Response">
                        <ng-template let-col let-apr="rowData" pTemplate="body">
                            {{apr[col.field] | date: 'medium' }}
                        </ng-template>
                    </p-column>
                </p-dataTable> -->
            </p-tabPanel>
            <!-- <p-tabPanel header="Customer Information">
                    <app-customer-information-detail [loanApplicationId]="loanApplId">
                    </app-customer-information-detail>
                </p-tabPanel> -->
            <p-tabPanel i18n-header header="Other Information">
                <div class="panel-body">
                    <p-accordion #accordion>
                        <p-accordionTab i18n-header [selected]="true" header="Customer Information">
                            <div class="panel-body" style="overflow:auto; height:300px">
                                <app-customer-information-detail [loanApplicationId]="loanApplId">
                                </app-customer-information-detail>
                            </div>
                        </p-accordionTab>
                        <p-accordionTab i18n-header header="Loan Details">

                            <button type="button" class="btn btn-primary"
                                (click)="showLoanInformation()" style="margin-right:5px">
                                <i class="glyphicon glyphicon-info"></i> <ng-container i18n>Show Loan Information</ng-container></button>

                            <app-loan-application-details-view [isRecommendedInfo]="true">
                            </app-loan-application-details-view>
                        </p-accordionTab>
                        <p-accordionTab i18n-header header="Loan Collateral(s)">
                            <div class="panel-body" style="overflow:auto; height:200px">
                                <div>
                                    <app-collaterals-proposed *ngIf="loanData?.loanApplicationId>0"
                                        [loanApplicationId]="loanData?.loanApplicationId"
                                        [currencyId]="loanData?.currencyId"
                                        [reload]="loanData?.loanApplicationId"
                                        [isForSwap]="false">
                                    </app-collaterals-proposed>
                                </div>
                                <p-dataTable *ngIf="loanSelection != null" id="loanCollateralList"
                                    [value]="loanSelection.loanCollateral" [responsive]="true" [paginator]="true"
                                    [rows]="5">
                                    <p-column i18n-header field="collateralTypeName" header="Type" [style]="{'width':'280px'}"
                                        sortable="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="currencyCode" header=""
                                        [style]="{'text-align':'right','width':'40px'}" sortable="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="collateralValue" header="Value" sortable="true"
                                        filterMatchMode="contains">
                                        <ng-template pTemplate="body" let-item="rowData">
                                            {{item.collateralValue | number:'1.2'}}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="haircut" header="Haircut" sortable="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="valuationCycle" header="Valuation Cycle" sortable="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header [style]="{'width':'60px'}" field="allowSharing" header="share Allowed"
                                        sortable="true" filterMatchMode="contains">
                                        <ng-template pTemplate="header">Can Share?</ng-template>
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <span *ngIf="d.allowSharing">Yes</span>
                                            <span *ngIf="!d.allowSharing">No</span>
                                        </ng-template>
                                    </p-column>
                                    <!-- <p-column [style]="{'width':'40px'}">
                                        <ng-template pTemplate="header"></ng-template>
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <a (click)="ViewCollateralDetails(d)" href="javascript:void(0)">View</a>
                                        </ng-template>
                                    </p-column> -->
                                </p-dataTable>
                            </div>

                        </p-accordionTab>

                        <p-accordionTab i18n-header header="Loan Monitoring Trigger">
                            <div class="panel-body" style="overflow:auto; height:300px">
                                <p-dataTable [value]="loanSelectedData.monitoringTriggers" [responsive]="true"
                                    [paginator]="false" [rows]="5">
                                    <p-column i18n-header field="monitoringTrigger" header="Monitoring Trigger"></p-column>
                                    <!-- <p-footer> Number of Guarantors: {{loanSelectedData.monitoringTriggers.count}}</p-footer> -->
                                </p-dataTable>
                            </div>
                        </p-accordionTab>

                    </p-accordion>
                </div>
            </p-tabPanel>
            <p-tabPanel i18n-header header="Checklist">
                    <div class="panel-body">
                        <app-condition-checklist  [isLMSChecklist]="false"  [showOrHideList]='false'></app-condition-checklist>
                    </div>
                </p-tabPanel>

            <!-- ========================================================================================= -->
            <p-tabPanel i18n-header header="Supporting Documents">
               
                <div class="panel panel-default">
                    <div class="panel-heading">
                        Documents For Upload
                    </div>
                    <div class="panel-body">
                
                        <p-dataTable [value]="requiredDocumentTypes" [responsive]="true" [paginator]="true" [rows]="5">
                            <p-column i18n-header field="productClassName" [filter]="true" header="Product Class Name" sortable="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="productName" [filter]="true" header="Product Name" sortable="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="documentCategoryName" header="Document Category" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="documentType" header="Document Type Name" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="sectorName" header="Sector Name" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="subSectorName" header="Sub-Sector Name" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header field="required" header="Is Required" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column [style]="{'width':'100px'}">
                                <ng-template pTemplate="header" i18n>Is uploaded</ng-template>
                                <ng-template pTemplate="body" let-col let-i="rowData">
                                    <b [innerHTML]="documentIsUploaded(i.documentTypeId)"></b>
                                        {{checkIfRequiredDocumentsAreUploaded()}}
                                </ng-template>
                            </p-column>
                        </p-dataTable>
                
                    </div>
            </div>
            
            <div class="panel-heading">
                <h2 class="panel-title">
                    {{ panelTitle }}
                </h2>
            </div>
            
            <div class="panel panel-default" *ngIf="showUploadForm">
                <form novalidate [formGroup]="documentUploadForm" autocomplete="off">
                    <div class="panel-body">
                        <div class="form-horizontal">
            
                            <div class="form-group">
                                <label i18n for="fileName" class="control-label col-md-3">Document Category</label>
                                <label i18n for="fileName" class="control-label col-md-3">Document Type</label>
                                <label i18n for="fileData" class="control-label col-md-6">Select Document</label>
                                <div class="col-md-3">
                                    <select (change)="getDocumentTypesByCategory($event.target.value)" name="documentCategoryId" id="documentCategoryId"
                                        formControlName="documentCategoryId" class="form-control"
                                        [ngClass]="!documentUploadForm.controls['documentCategoryId'].valid ? 'required-input' : 'valid-input'">
                                        <option i18n value="">-- Select Document Category --</option>
                                        <option *ngFor=" let x of documentCategories" [value]="x.documentCategoryId">{{x.documentCategoryName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <select name="documentTypeId" formControlName="documentTypeId"
                                        [ngClass]="!documentUploadForm.controls['documentTypeId'].valid ? 'required-input' : 'valid-input'"
                                        id="documentTypeId" class="form-control">
                                        <option i18n value="">Select Document Type</option>
                                        <option *ngFor="let x of documentTypes" value="{{x.documentTypeId}}">{{x.documentTypeName}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <input type="file" (change)="onFileChange($event)" formControlName="fileData"
                                        [ngClass]="!documentUploadForm.controls['fileData'].valid ? 'required-input' : 'valid-input'"
                                        placeholder="Upload file" accept=".pdf,.doc,.docx,.jpg,.jpeg,.xls,.xlsx,.png" #fileInput
                                        name="fileInput" style="padding-top:2px;" class="form-control" i18n-placeholder>
                                </div>
                            </div>
            
                            <div class="form-group" *ngIf="documentDates">
                                <label i18n for="issueDate" class="control-label col-md-6">Issue Date</label>
                                <label i18n for="expiryDate" class="control-label col-md-6">Expiry Date</label>
                                <div class="col-md-6">
                                    <p-calendar id="issueDate" formControlName="issueDate" [monthNavigator]="true"
                                        [yearNavigator]="true" yearRange="1900:2030" [showIcon]="true"
                                        [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225'}"
                                        [style]="{'width': '100%', 'z-index': '999'}"
                                        [ngClass]="!documentUploadForm.controls['issueDate'].valid ? 'required-input' : 'valid-input'">
                                    </p-calendar>
                                </div>
                                <div class="col-md-6">
                                    <p-calendar id="expiryDate" formControlName="expiryDate" [monthNavigator]="true"
                                        [yearNavigator]="true" yearRange="1900:2030" [showIcon]="true"
                                        [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225'}"
                                        [style]="{'width': '100%', 'z-index': '999'}"
                                        [ngClass]="!documentUploadForm.controls['expiryDate'].valid ? 'required-input' : 'valid-input'">
                                    </p-calendar> 
                                </div>
                            </div>
            
                        </div>
                       
            
                    </div>
                </form>
            
                <div class="panel-footer">
                    <div class="row">
                        <div class="col-md-12">
                            <button type="button" (click)="saveDocumentUpload(documentUploadForm)"
                                [disabled]="documentUploadForm.invalid" class="btn btn-success pull-right">
                                <span class="glyphicon glyphicon-upload"></span> 
                                <ng-container i18n>Upload</ng-container>
                                
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- <div class="panel panel-default">
                <div class="panel-body">
                    <div class="panel-heading">
                        <h2 class="panel-title">
                            CREDIT APPRAISAL DOCUMENTS
                        </h2>
                    </div>
                    <p-dataTable [value]="creditDocumentUploads" [responsive]="true" [paginator]="true" [rows]="5">
                        <p-column header="DateTime Uploaded">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.dateTimeCreated | date : 'MMM d, y, h:mm a' }}
                            </ng-template>
                        </p-column>
                        <p-column field="uploadedBy" header="Uploaded By" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column header="File Name">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="d.fileExtension == 'doc'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'docx'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'pdf'" class="icon-file-pdf"></span>
                                <span *ngIf="d.fileExtension == 'jpg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'jpeg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'png'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'txt'" class="icon-file-text"></span>
                                <span *ngIf="d.fileExtension == 'xls'" class="icon-file-excel"></span>
                                <span *ngIf="d.fileExtension == 'xlsx'" class="icon-file-excel"></span>
                                {{d.fileName}}
                            </ng-template>
                        </p-column>
                        <p-column field="fileSizeString" header="File Size" sortable="true" filterMatchMode="contains" [style]="{'width':'100px'}"></p-column>
                        <p-column field="documentTypeName" header="Document Type" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column field="documentCategoryName" header="Document Category" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column  [style]="{'width':'120px'}">
                            <ng-template pTemplate="header"> </ng-template>
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <div style="text-align:center" >
                                    <span *ngIf="deleteLink && d.owner"><a (click)="deleteDocumentUpload(d)" href="javascript:void(0)">Delete</a>
                                        <span style="padding:3px;"> | </span>
                                    </span>
                                    <a *ngIf="['jpg','jpeg', 'png','JPG','JPEG', 'PNG'].indexOf(d.fileExtension.toLowerCase()) > -1" (click)="downloadDocument(d,true)" href="javascript:void(0)">View</a>
                                    <a *ngIf="['doc','docx', 'pdf','xls', 'xlsx'].indexOf(d.fileExtension.toLowerCase()) > -1 && d.documentTypeName !='CREDIT BUREAU'" (click)="downloadDocument(d)" href="javascript:void(0)">Download</a>
                                    <a *ngIf="['doc','docx', 'pdf','xls', 'xlsx'].indexOf(d.fileExtension.toLowerCase()) > -1 && d.documentTypeName =='CREDIT BUREAU'" (click)="downloadDocumentCreditBereau(d)" href="javascript:void(0)">Download</a>
                                </div>
                            </ng-template>
                        </p-column>
                    </p-dataTable>
                </div>
            </div> -->

            <div class="panel panel-default" *ngIf="showUploadGrid">
                <div class="panel-body">
                    <div class="panel-heading">
                        <h2 class="panel-title">
                            <ng-container i18n>DRAWDOWN DOCUMENTS</ng-container>
                        </h2>
                    </div>
                    <p-dataTable [value]="documentUploads" [responsive]="true" [paginator]="true" [rows]="5">
                        <p-column i18n-header header="DateTime Uploaded">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.dateTimeCreated | date : 'MMM d, y, h:mm a' }}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header field="uploadedBy" header="Uploaded By" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header header="File Name">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="d.fileExtension == 'doc'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'docx'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'pdf'" class="icon-file-pdf"></span>
                                <span *ngIf="d.fileExtension == 'jpg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'jpeg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'png'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'txt'" class="icon-file-text"></span>
                                <span *ngIf="d.fileExtension == 'xls'" class="icon-file-excel"></span>
                                <span *ngIf="d.fileExtension == 'xlsx'" class="icon-file-excel"></span>
                                {{d.fileName}}
                            </ng-template>
                        </p-column>
                        <!-- <p-column field="fileName" header="File Name" sortable="true" filterMatchMode="contains"></p-column> -->
                        <!-- <p-column field="fileExtension" header="File Extension" sortable="true" filterMatchMode="contains"></p-column> -->
                        <p-column i18n-header field="fileSizeString" header="File Size" sortable="true" filterMatchMode="contains" [style]="{'width':'100px'}"></p-column>
                        <!-- <p-column field="expiryDate" header="Expiry Date" sortable="true" filterMatchMode="contains"></p-column> -->
                        <p-column i18n-header field="documentTypeName" header="Document Type" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header field="documentCategoryName" header="Document Category" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  [style]="{'width':'120px'}">
                            <ng-template pTemplate="header"> </ng-template>
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <div style="text-align:center" >
                                    <span *ngIf="deleteLink && d.owner"><a i18n (click)="deleteDocumentUpload(d)" href="javascript:void(0)">Delete</a>
                                        <span style="padding:3px;"> | </span>
                                    </span>
                                    <a i18n *ngIf="['jpg','jpeg', 'png','JPG','JPEG', 'PNG'].indexOf(d.fileExtension.toLowerCase()) > -1" (click)="downloadDocument(d,true)" href="javascript:void(0)">View</a>
                                    <a i18n *ngIf="['doc','docx', 'pdf','xls', 'xlsx'].indexOf(d.fileExtension.toLowerCase()) > -1 && d.documentTypeName !='CREDIT BUREAU'" (click)="downloadDocument(d)" href="javascript:void(0)">Download</a>
                                    <a i18n *ngIf="['doc','docx', 'pdf','xls', 'xlsx'].indexOf(d.fileExtension.toLowerCase()) > -1 && d.documentTypeName =='CREDIT BUREAU'" (click)="downloadDocumentCreditBereau(d)" href="javascript:void(0)">Download</a>
                                </div>
                            </ng-template>
                        </p-column>
                        <!-- <p-column field="uploadedBy" header="Uploaded By" sortable="true" filterMatchMode="contains"></p-column> -->
            
                    </p-dataTable>
            
                </div>
            </div>
            
            <div class="panel panel-default" *ngIf="showUploadGrid">
                <div class="panel-body">
            
                    <p-dataTable [value]="documentDeleted" [responsive]="true" [paginator]="true" [rows]="5">
                        <p-column i18n-header header="Date / Time Deleted">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.dateTimeDeleted | date : 'MMM d, y, h:mm a' }}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header field="uploadedBy" header="Deleted By" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header header="File Name">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="d.fileExtension == 'doc'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'docx'" class="icon-file-word"></span>
                                <span *ngIf="d.fileExtension == 'pdf'" class="icon-file-pdf"></span>
                                <span *ngIf="d.fileExtension == 'jpg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'jpeg'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'png'" class="icon-file-picture"></span>
                                <span *ngIf="d.fileExtension == 'txt'" class="icon-file-text"></span>
                                <span *ngIf="d.fileExtension == 'xls'" class="icon-file-excel"></span>
                                <span *ngIf="d.fileExtension == 'xlsx'" class="icon-file-excel"></span>
                                {{d.fileName}}
                            </ng-template>
                        </p-column>
                        
                        <p-column i18n-header field="fileSizeString" header="File Size" sortable="true" filterMatchMode="contains" [style]="{'width':'100px'}"></p-column>        
                        <p-column i18n-header field="documentTypeName" header="Document Type" sortable="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header field="documentCategoryName" header="Document Category" sortable="true" filterMatchMode="contains"></p-column>                   
            
                    </p-dataTable>
            
                </div>
            </div>
            
           
                <!-- <div *ngIf="loanSelectedData">
                    <document-upload *ngIf="loanSelectedData.loanApplicationId>0" [reload]="loanSelectedData.loanApplicationDetailId"
                        [showUploadForm]="true" [operationId]="loanSelectedData.operationId" 
                        [customerId]="loanSelectedData.customerId"
                        (hideModal)="hidePreviousModal()"
                        [targetId]="loanSelectedData.loanApplicationDetailId"
                        [targetReferenceNumber]="loanSelectedData.applicationReferenceNumber">
                    </document-upload>
                    
                </div> -->


                <!-- ========================================================================================= -->
                <!-- </div> -->
            </p-tabPanel>
            <p-tabPanel i18n-header *ngIf="userIsAccountOfficer" header="Drawdown Memo">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 i18n class="panel-title pull-left">
                                        Drawdown Memo
                                    </h2>
                                     <!-- <button type="button" (click)="displayReport=false" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button> -->
                                </div>
                            </div>
                        </div>
                        <!-- <div *ngIf="drawdownHtml != null" class="panel-body" style="min-height:450px;">
                            <CKEDITOR [content]="drawdownHtml" [height]="400"
                                (contentChange)="contentChange($event)"></CKEDITOR>
                        </div> -->
                        <div class="panel-body" [innerHtml]="drawdownHtml">
                        </div>
                    </div>
            </p-tabPanel>
            <!-- *ngIf="operationId==202 || operationId==146" -->
            <p-tabPanel i18n-header  header="Approval Memo" *ngIf="loanSelection?.appraisalOperationId == 202 || loanSelection?.appraisalOperationId == 146">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 i18n class="panel-title pull-left">
                                        Approval Memo
                                    </h2>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body" [innerHtml]="cashBackMemoHtml">
                        </div>
                    </div>
            </p-tabPanel>
                
            <!-- <p-tabPanel i18n-header header="CRMS Regulatory" *ngIf="isCRMSstaff">
                <crms-regulatories [loanSystemTypeId]="loanSystemTypeId" [loanId]="loanId" [isLms]="isLms">
                </crms-regulatories>
            </p-tabPanel> -->

            <p-tabPanel i18n-header header="Lien Placement">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 i18n class="panel-title pull-left">
                                        Cash Collateral Lien Placement
                                    </h2>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <app-lien-on-investment *ngIf="loanId>0"
                                [loanApplicationId]="loanData?.loanApplicationId"
                                [applicationDetailId]="loanData?.loanApplicationDetailId"
                                [currencyId]="loanData?.currencyId"
                                [reload]="loanData?.loanApplicationId"
                                [isUserLegal]="isUserLegal"
                                (allLiensArePlaced)=lienIsSatisfied($event)>
                            </app-lien-on-investment>
                        </div>
                    </div>
            </p-tabPanel>
            <p-tabPanel i18n-header header="Project Risk Rating" *ngIf="(loanSelectedData != null && loanSelectedData.isProjectRelate == true)">
                            <div class="panel panel-default">
        
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h2 i18n class="panel-title pull-left">
                                                Project Risk Rating
                                            </h2>
                                            <div class="pull-right">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            
                                <div class="panel-body">
                            
                                     <table class="table table-bordered table-hover">
                            
                                            <tr>
                                                <th>SN</th>
                                                <th>Criteria</th>
                                                <th>Value</th>
                                            </tr>
                                            <tbody>
                            
                                                <!-- <tr *ngFor="let field of projectRiskRatingComputation; let i = index;">
                                                    <td>{{i + 1}}</td>
                                                    <td>{{field.categoryName}}</td>
                                                    <td>{{field.categoryValue}}</td>
                                                </tr> -->
                                                <tr>
                                                    <td><strong>1</strong></td>                                        
                                                    <td colspan=""><strong i18n>OBLIGOR/ CONTRACTOR
                                                    </strong></td>
                                                    <td><strong>{{rating}}</strong></td>                                        
                                                </tr>
                                                <tr>
                                                    <td><strong>2</strong></td>                              

                                                    <td colspan=""><strong i18n>Rating
                                                    </strong></td>
                                                    <td><strong>{{computation}}</strong></td>                                        
                                                </tr>
                                                <tr>
                                                    <td><strong>3</strong></td>                                        

                                                    <td colspan=""><strong i18n>Risk Categorisation
                                                    </strong></td>
                                                    <td><strong>{{riskCategorisation}}</strong></td>                                        
                                                </tr>
                                                <tr>
                                                    <td><strong>4</strong></td>                                        

                                                    <td colspan=""><strong i18n>Project Location
                                                    </strong></td>
                                                    <td><strong>{{projectLocation}}</strong></td>                                        
                                                </tr>
                                                <tr>
                                                    <td><strong>5</strong></td>                                        

                                                    <td colspan=""><strong i18n>Project Details
                                                    </strong></td>
                                                    <td><strong>{{projectDetails}}</strong></td>                                        
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="panel-footer">
                                            <div class="row">
                                                <div class="col-md-12">
                                                </div>
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </p-tabPanel> 
        </p-tabView>
    </div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12">
                <div class="btn-group pull-right">
                    <button i18n (click)="displayLoanToApproveModal=false" type="button" class="btn btn-danger"
                        style="margin-right:5px">Close</button>
                    <!-- <button (click)="!loanSelectedData.comment || !loanSelectedData.loanApprovalStatusId" type="button" (click)="showConfirmDialog()" class="btn btn-success">Submit For Approval</button> -->
                    <button i18n (click)="showApprovalForm(false)" type="button" class="btn btn-success"
                        style="margin-right:5px">Submit For Approval</button>
                                  
                </div>
                <div class="btn-group pull-left">
                    <button (click)="showReferBackForm()" type="button" class="btn btn-danger"
                        style="margin-right:5px">
                        <ng-container i18n> Refer Back</ng-container>
                    </button>
                    <!-- <button *ngIf="apiRequestId == null" (click)="showReferBackForm()" type="button" class="btn btn-danger"
                        style="margin-right:5px">Refer Back</button> -->
                </div>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog  [responsive]=true [(visible)]="displayReferBackForm" modal="modal" showEffect="fade" width="700">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n class="panel-title">Refer back</h2>
        </div>
        <app-refer-back [referBackOperationId]="operationId" [forbidExternalNotification]="true" [referBackTargetId]="targetId" (notify)="displayStatus($event)" 
        (notifyAfterReferBack)="referBackResultControl($event)"></app-refer-back>
    </div>
</p-dialog> 
<!-- <p-dialog [responsive]=true [(visible)]="displayReferBackForm" id="reccol-modal" modal="modal" showEffect="fade" width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title">Refer back</h2>
        </div>
        <form novalidate [formGroup]="referBackForm">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <div class="col-md-12">
                            <label>Comment</label>
                        </div>
                        <div class="col-md-12">
                            <textarea name="comment" formControlName="comment" id="comment" class="form-control"
                                [ngClass]="!referBackForm.controls['comment'].valid ? 'required-input' : 'valid-input'"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-12">Approval Level</label>
                        <div class="col-md-12">
                            <select name="approvalLevelId" formControlName="approvalLevelId" id="approvalLevelId"
                                class="form-control"
                                [ngClass]="referBackForm.controls['approvalLevelId'].valid ? 'valid-input' : 'required-input'">
                                <option value="">-- Select Approval Level --</option>
                                <option *ngFor="let x of trailApprovalLevels" [value]="x.fromApprovalLevelId">
                                    {{ x.fromApprovalLevelName }}</option>
                            </select>
                        </div>
                    </div>
                    Refer back
                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" [disabled]="referBackForm.invalid" style="margin-right:5px" type="button"
                            (click)="showConfirmDialog()" class="btn btn-success pull-right">Refer</button>
                        <button type="button" (click)="displayReferBackForm=false"
                            class="btn btn-danger">Cancel</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog> -->


<app-fintrakbanking-dialog [title]="title" [show]="displayConfirmDialog" [width]="width" [message]="message"
    (approveEvent)="decideMovement()" (closeEvent)="cancelApproval()"></app-fintrakbanking-dialog>

<p-dialog [responsive]=true [(visible)]="displayApprovalForm" id="reccol-modal" modal="modal" showEffect="fade"
    width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n class="panel-title">Approval</h2>
        </div>
        <form novalidate [formGroup]="approvalForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <div class="col-md-12">
                            <label i18n>Comment</label>
                        </div>
                        <div class="col-md-12">
                            <textarea name="comment" formControlName="comment" id="comment" class="form-control"
                                [ngClass]="!approvalForm.controls['comment'].valid ? 'required-input' : 'valid-input'"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label i18n class="control-label col-md-12">Decision</label>
                        <div class="col-md-12">
                            <select name="approvalStatusId" formControlName="approvalStatusId" id="approvalStatusId"
                                class="form-control"
                                [ngClass]="approvalForm.controls['approvalStatusId'].valid ? 'valid-input' : 'required-input'">
                                <option i18n value="">-- Select Approval Status --</option>
                                <option *ngFor="let x of approvalStatusData" [value]="x.approvalStatusId">
                                    {{ x.approvalStatusName }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <!-- <div class="col-md-12">
                            <label>Document is provided?</label>
                        </div> -->
                        
                    </div>
                    
                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button i18n type="button" (click)="showConfirmDialog()" style="margin-right:5px"
                            [disabled]="approvalForm.invalid" class="btn btn-success pull-right">Submit</button>
                        <button i18n type="button" (click)="displayApprovalForm=false" class="btn btn-danger">Cancel</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayReport" width="1200" modal="modal" showEffect="fade">
  <div class="panel panel-default">
      <div class="panel-heading">
          <div class="row">
              <div class="col-md-12">
                  <h2 i18n class="panel-title pull-left">
                     Drawdown Memo

                  </h2>
                        
                  <button i18n type="button" (click)="displayReport=false" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button>


              </div>
          </div>
      </div>
      <div class="panel-body">

          <div class="col-md-12" *ngIf="displayTestReport" style=" width:1200px; overflow:auto;" >
              <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="500px" width="1200px" style="overflow:auto"></iframe>
          </div>
      </div>
  </div>
  <div class="panel-footer">
      <div class="row">
          <div class="col-md-12">
              <button i18n type="button" (click)="displayReport=false" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button>
          </div>
      </div>
  </div>
</p-dialog>

 <!-- [autoZIndex]="autoZIndex" [style]="{'z-index': 10}" -->
 <p-dialog [responsive]=true [(visible)]="displayDocument" modal="modal" [contentStyle]="{'overflow-y': 'auto', 'overflow-x': 'hidden', 
 'max-height': '80vh','min-height':'500px'}" width="1000" [style]="{'z-index': 10}">
     <div style="margin-bottom:0" class="panel panel-default">
 
         <div class="panel-heading">
             <h2 class="panel-title">
                <ng-container i18n>Document Title:</ng-container>
                 <strong>{{selectedDocument}}</strong>
             </h2>
             <div class="pull-right">
                 <a class="close" (click)="displayDocument=false">&times;</a>
             </div>
         </div>
 
         <div class="panel-body" style="overflow:auto;height:1500;">
             <img *ngIf="binaryFile" style="max-width: 100%; display: block 2px black;"
             [src]="'data:image/jpg;base64,'+binaryFile" alt="">
 
         </div>
     </div>
 </p-dialog>
 
