<div class="ui-g">
    <div class="ui-g-12 no-padding">
        <!-- <span [innerHtml]="test"></span> -->
        <!--module header-->
        <div class="panel panel-default">

            <div class="panel-heading">
                <div class="row">
                    <div class="col-md-12">
                        <h2 class="panel-title pull-left">
                            Credit Appraisal
                            <!-- <button (click)="testflow()">Test Workflow</button> -->
                        </h2>
                        <h2 class="panel-title pull-right">
                            <small
                                *ngIf="applicationSelection != null && applicationSelection?.approvalStatusId != 2 && applicationSelection?.approvalStatusId != 3 && applicationSelection?.approvalStatusId != 0">
                               <ng-container i18n> Selected application is at</ng-container>
                               
                                <b>{{ applicationSelection?.currentApprovalLevel }}</b>
                            </small>
                        </h2>
                    </div>
                </div>

            </div>
            <!--endof module header-->

            <!-- <expfacility [customerId]="33"></expfacility> -->

            <p-tabView [activeIndex]="activeTabindex" (onChange)="onTabChange($event)">

                <p-tabPanel i18n-header header="Loan Applications">

                    <!-- loan applications -->
                    <div class="card no-padding">
                        <div class="panel panel-default">

                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h2 class="panel-title pull-left">
                                            <ng-container i18n>Loan Applications</ng-container>
                                            <small *ngIf="filteredProductClass != null && searching == false"> -
                                                {{filteredProductClass}}</small>
                                            <small *ngIf="searchString.length > 0 && searching == true">
                                                <ng-container i18n> - Search results for</ng-container>
                                                <i>{{searchString}}</i>
                                            </small>
                                        </h2>
                                    </div>
                                </div>
                            </div>
                            <!-- this is hard coding and not configurable -->
                            <div style="margin-top:8px;margin-left:15px;">
                                <a (click)="reset()" href="javascript:void(0)" title="All" i18n>All</a>
                                <span *ngFor="let x of productPrograms; let i = index">
                                    <span style="padding:3px;">|</span>
                                    <a (click)="filterByProductClass(x.productClassId,x.productClassName)"
                                        href="javascript:void(0)" title="{{x.productClassName}}">{{ x.productClassName
                                        }}
                                        ({{ x.pendingNumber }})</a>
                                </span>
                                <span *ngIf="productPrograms.length == 0" i18n>loading...</span>
                            </div>

                            <div class="pull-left" style="margin-left:15px;margin-bottom:2px;">
                                <!-- <span *ngIf="searchString.length > 0 && searching == true"> - Search results for <i>{{searchString}}</i></span> -->
                            </div>

                            <div class="pull-right" style="margin-right:16px;margin-bottom:2px;">
                                <input type="search" [(ngModel)]="searchString" id="searchString" name="searchString"
                                    placeholder="Search loan applications..." aria-label="Search" size="30"
                                    minlength="4" maxlength="50">
                                <button (click)="getLoanApplications(0,20,null,true)" i18n>Search</button>
                                <button (click)="reset()" title="Refresh">
                                    <span class="glyphicon glyphicon-refresh"></span>
                                </button>
                            </div>
                            <br />

                            <div class="panel-body">
                                <p-accordion *ngIf="isPoolRequest == true" #accordion1>
                                    <p-accordionTab i18n-header [selected]="true" header="APPLICATION REQUEST - GENERAL POOL">
                                        <!-- (onRowSelect)="onSelectedApplicationChange()" -->
                                        <p-dataTable [value]="applications" [responsive]="true" [paginator]="true"
                                            [lazy]="true" [loading]="showLoadIcon" [rows]="5"
                                            dataKey="loanApplicationId" (onRowSelect)="pushSelectedLoans($event)"
                                            (onRowUnselect)="popSelectedLoans($event)" [rowsPerPageOptions]="[10,20,30]"
                                            [totalRecords]="itemTotal" (onLazyLoad)="loadData($event)">

                                            <p-column i18n-header *ngIf="pageReady" [style]="{'width':'38px'}" [selection]=true
                                                selectionMode="multiple" (onRowSelect)="pushSelectedLoans($event)"
                                                (onRowUnselect)="popSelectedLoans($event)"></p-column>
                                            <!-- <p-column i18n-header  [style]="{'width':'40px'}">
                                        <ng-template let-application="rowData" let-i="rowIndex" pTemplate="body">
                                            <a *ngIf="application.toStaff == null" (click)="onViewSelection(application)" style="display: block" href="javascript:void(0)">
                                                view
                                            </a>

                                        </ng-template>
                                    </p-column> -->
                                            <!-- <p-column i18n-header *ngIf="pageReady == true" [style]="{'width':'4%'}" selectionMode="single" (onRowSelect)="onSelectedApplicationChange()">
                                    </p-column> -->

                                            <!-- for row selection -->

                                            <p-column i18n-header field="systemDateTime" header="Date Created" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'8%'}">
                                                <ng-template pTemplate="header">
                                                   <span  i18n>Date Created</span>
                                                </ng-template>
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{d.systemDateTime | date: 'dd-MM-yyyy'}}
                                                </ng-template>
                                            </p-column>

                                            <!-- <p-column i18n-header [style]="{'width':'50px'}" field="approvalStatusId" header="Reference" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->
                                            <p-column i18n-header [style]="{'width':'8%'}" field="applicationReferenceNumber"
                                                header="Reference" [filter]="false" filterMatchMode="contains">
                                            </p-column>
                                            <!-- <p-column i18n-header [style]="{'width':'150px'}" field="productClassName" header="Product Class" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->

                                            <p-column i18n-header [style]="{'width':'8%'}" field="loanTypeName" header="Type"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header [style]="{'width':'10%'}" field="facility" header="Facility"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header header="Customer Name/Group" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'16%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.customerName }} {{ d.customerGroupName }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="applicationAmount" header="Amount" [filter]="false"
                                                filterMatchMode="contains"
                                                [style]="{'width':'9%','text-align':'right'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.applicationAmount | number : '1.2' }}
                                                </ng-template>
                                            </p-column>

                                            <!-- <p-column i18n-header field="applicationTenor" header="Tenor" [filter]="false" filterMatchMode="contains" [style]="{'width':'3%px'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.tenorString }}
                                        </ng-template>
                                    </p-column> -->

                                            <p-column i18n-header field="productClassId" header="CP" [style]="{'width':'2%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span
                                                        *ngIf="d.productClassProcessId == productProgramClassProcessId"
                                                        style="color:#a9a9a9;" class="glyphicon glyphicon-ok"></span>
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="timeIn" header="Time In" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'11%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.timeIn | date: 'medium' }}
                                                </ng-template>
                                            </p-column>

                                            <!-- <p-column i18n-header field="timeLapse" header="Time In" [filter]="false"
                                        filterMatchMode="contains" [style]="{'width':'11%'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.timeLapse }}
                                        </ng-template>
                                    </p-column> -->

                                            <!-- <p-column i18n-header field="timeIn" header="Time In" [filter]="false"
                                        filterMatchMode="contains" [style]="{'width':'8%'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.timeIn | date: 'dd-MM-yyyy' }}
                                        </ng-template>
                                    </p-column> -->

                                            <!-- <p-column i18n-header [style]="{'width':'16%'}" field="currentApproval Level" header="Current Level" [filter]="false" filterMatchMode="contains"></p-column> -->
                                            <!-- <p-column i18n-header [style]="{'width':'16%'}" field="timeIn" header="timein" [filter]="false" filterMatchMode="contains"></p-column> -->
                                            <p-column i18n-header [style]="{'width':'5%'}" field="divisionShortCode"
                                                header="Division" [filter]="false" filterMatchMode="contains">
                                            </p-column>

                                            <p-column i18n-header header="SLA" [filter]="false" filterMatchMode="contains"
                                                [style]="{'width':'4%px'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span class="label label-{{d.slaGlobalStatus}}">_</span> <ng-container i18n> Global</ng-container>
                                                    <span class="label label-{{d.slaInduvidualStatus}}">_</span><ng-container i18n>Individual</ng-container>
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header [style]="{'width':'9%'}">
                                                <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                                    <div class="btn-group">
                                                        <!-- <a href="javascript:;" title="See More Info.." (click)="popoverSeeMore($event,row.loanApplicationId)">More</a> -->
                                                    </div>
                                                    <div class="btn-group"
                                                        [innerHtml]="getApplicationStatus(row.submittedForAppraisal,row.approvalStatusId)">
                                                    </div>
                                                </ng-template>
                                            </p-column>

                                        </p-dataTable>
                                        <!-- (click)="setRouteMode()" -->
                                        <div class="row" *ngIf="workflowTargets.length > 0">
                                            <div class="form-group">
                                                <div class="col-md-2"
                                                    *ngIf="isAmongActivities('Reassign Requests') == false">
                                                    <button (click)="AddToMyDesk()" class="btn btn-primary pull-left">
                                                        <span class="glyphicon glyphicon-plus"></span>
                                                        <ng-container i18n>Add To My Desk</ng-container>
                                                    </button>
                                                </div>
                                                <div class="col-md-1"
                                                    *ngIf="isAmongActivities('Reassign Requests') == true">
                                                    <app-reassign-request [newUsage]="true" [isMultiple]="true"
                                                        [showInPanel]="false" [panelLabel]="'Team Lead Routing'"
                                                        [reassignButtonLabel]="'Assign'" [enableReassign]="true"
                                                        [approvalTrailIds]="approvalTrailIds"
                                                        (refreshCallerGrid)="resetGrid($event)">
                                                    </app-reassign-request>
                                                </div>
                                            </div>
                                        </div>
                                    </p-accordionTab>
                                </p-accordion>

                                <p-accordion *ngIf="isPoolRequest == false" #accordion2>
                                    <p-accordionTab i18n-header [selected]="true" header="MY DESK">
                                        <p-dataTable [value]="assignedApplications" [responsive]="true"
                                            [paginator]="true" [lazy]="true" [loading]="showLoadIcon" [rows]="5"
                                            [(selection)]="applicationSelection" dataKey="loanApplicationId"
                                            (onRowSelect)="onSelectedApplicationChange()"
                                            [rowsPerPageOptions]="[10,20,30]" [totalRecords]="itemTotal"
                                            (onLazyLoad)="loadData($event)">

                                            <p-column i18n-header *ngIf="pageReady == true" [style]="{'width':'4%'}"
                                                selectionMode="single">
                                            </p-column>

                                            <!-- for row selection -->

                                            <p-column i18n-header field="systemDateTime" header="Date Created" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'8%'}">
                                                <ng-template pTemplate="header">
                                                    <span  i18n>Date Created</span>
                                                 </ng-template>
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{d.systemDateTime | date: 'dd-MM-yyyy'}}
                                                </ng-template>
                                            </p-column>

                                            <!-- <p-column i18n-header [style]="{'width':'50px'}" field="approvalStatusId" header="Reference" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->
                                            <p-column i18n-header [style]="{'width':'8%'}" field="applicationReferenceNumber"
                                                header="Reference" [filter]="false" filterMatchMode="contains">
                                            </p-column>
                                            <!-- <p-column i18n-header [style]="{'width':'150px'}" field="productClassName" header="Product Class" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->

                                            <p-column i18n-header [style]="{'width':'8%'}" field="loanTypeName" header="Type"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header [style]="{'width':'10%'}" field="facility" header="Facility"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header header="Customer Name/Group" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'16%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.customerName }} {{ d.customerGroupName }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="applicationAmount" header="Amount" [filter]="false"
                                                filterMatchMode="contains"
                                                [style]="{'width':'9%','text-align':'right'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.applicationAmount | number : '1.2' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="productClassId" header="CP" [style]="{'width':'2%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span
                                                        *ngIf="d.productClassProcessId == productProgramClassProcessId"
                                                        style="color:#a9a9a9;" class="glyphicon glyphicon-ok"></span>
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="timeIn" header="Time In" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'11%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.timeIn | date: 'medium' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header [style]="{'width':'5%'}" field="divisionShortCode"
                                                header="Division" [filter]="false" filterMatchMode="contains">
                                            </p-column>

                                            <p-column i18n-header header="SLA" [filter]="false" filterMatchMode="contains"
                                                [style]="{'width':'4%px'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span class="label label-{{d.slaGlobalStatus}}">_</span><ng-container i18n> Global</ng-container>
                                                    <span class="label label-{{d.slaInduvidualStatus}}">_</span>
                                                    <ng-container i18n> Individual</ng-container>
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header [style]="{'width':'9%'}">
                                                <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                                    <div class="btn-group">
                                                        <!-- <a href="javascript:;" title="See More Info.." (click)="popoverSeeMore($event,row.loanApplicationId)">More</a> -->
                                                    </div>
                                                    <div class="btn-group"
                                                        [innerHtml]="getApplicationStatus(row.submittedForAppraisal,row.approvalStatusId)">
                                                    </div>
                                                </ng-template>
                                            </p-column>
                                        </p-dataTable>
                                    </p-accordionTab>
                                </p-accordion>

                                <p-accordion *ngIf="isPoolRequest == true" #accordion3>
                                    <p-accordionTab i18n-header [selected]="true" header="MY DESK">
                                        <p-dataTable [value]="assignedApplications" [responsive]="true"
                                            [paginator]="true" [rows]="5" [(selection)]="applicationSelection"
                                            (onRowSelect)="onSelectedApplicationChange()"
                                            [rowsPerPageOptions]="[10,20,30]">

                                            <p-column i18n-header *ngIf="pageReady == true" [style]="{'width':'4%'}"
                                                selectionMode="single">
                                            </p-column>
                                            <!-- for row selection -->

                                            <p-column i18n-header field="systemDateTime" header="Date Created" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'7%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{d.systemDateTime | date: 'dd-MM-yyyy'}}
                                                </ng-template>
                                            </p-column>

                                            <!-- <p-column i18n-header [style]="{'width':'50px'}" field="approvalStatusId" header="Reference" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->
                                            <p-column i18n-header [style]="{'width':'7%'}" field="applicationReferenceNumber"
                                                header="Reference" [filter]="false" filterMatchMode="contains">
                                            </p-column>
                                            <!-- <p-column i18n-header [style]="{'width':'150px'}" field="productClassName" header="Product Class" sortable="true" [filter]="true" filterMatchMode="contains"></p-column> -->

                                            <p-column i18n-header [style]="{'width':'8%'}" field="loanTypeName" header="Type"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header [style]="{'width':'10%'}" field="facility" header="Facility"
                                                [filter]="false" filterMatchMode="contains"></p-column>

                                            <p-column i18n-header header="Customer Name/Group" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'17%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.customerName }} {{ d.customerGroupName }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="applicationAmount" header="Amount" [filter]="false"
                                                filterMatchMode="contains"
                                                [style]="{'width':'8%','text-align':'right'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.applicationAmount | number : '1.2' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="productClassId" header="CP" [style]="{'width':'2%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span
                                                        *ngIf="d.productClassProcessId == productProgramClassProcessId"
                                                        style="color:#a9a9a9;" class="glyphicon glyphicon-ok"></span>
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="timeIn" header="Time In" [filter]="false"
                                                filterMatchMode="contains" [style]="{'width':'11%'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.timeIn | date: 'medium' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header [style]="{'width':'4%'}" field="divisionShortCode"
                                                header="Division" [filter]="false" filterMatchMode="contains">
                                            </p-column>

                                            <p-column i18n-header header="SLA" [filter]="false" filterMatchMode="contains"
                                                [style]="{'width':'5%px'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    <span class="label label-{{d.slaGlobalStatus}}">_</span> <ng-container i18n>Global</ng-container>
                                                    
                                                    <span class="label label-{{d.slaInduvidualStatus}}">_</span>
                                                    <ng-container i18n>Individual</ng-container>
                                                    
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header header="My Desk">
                                                <ng-template let-assignedApplications="rowData" let-i="rowIndex"
                                                    pTemplate="body">
                                                    <a (click)="onReturnToPool(assignedApplications)"
                                                        style="display: block" href="javascript:void(0)">
                                                        <i class="fa fa-undo" aria-hidden="true"></i>
                                                        <ng-container i18n>Undo</ng-container>
                                                        
                                                    </a>
                                                </ng-template>
                                            </p-column>
                                            <p-column i18n-header [style]="{'width':'9%'}">
                                                <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                                    <div class="btn-group">
                                                        <!-- <a href="javascript:;" title="See More Info.." (click)="popoverSeeMore($event,row.loanApplicationId)">More</a> -->
                                                    </div>
                                                    <div class="btn-group"
                                                        [innerHtml]="getApplicationStatus(row.submittedForAppraisal,row.approvalStatusId)">
                                                    </div>
                                                </ng-template>
                                            </p-column>
                                        </p-dataTable>
                                    </p-accordionTab>
                                </p-accordion>
                            </div>

                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-3 col-md-offset-9 ">
                                        <!-- buttons -->
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- endof loan applications -->

                </p-tabPanel>
                <!-- <p-tabPanel i18n-header *ngIf="!userIsAccountOfficer || applicationSelection==2" -->
                <p-tabPanel *ngIf="!userIsAccountOfficer" header="{{CamFamName}}"
                    [disabled]="disableApplicationInformationTab">
                    <!-- [disabled]="disableAppraisalMemorandumTab || applicationSelection.productClassProcessId == 2"> -->

                    <!-- cam document -->
                    <div class="card no-padding">
                        <div class="panel panel-default">

                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-9">
                                        <form novalidate [formGroup]="documentSectionForm" autocomplete="off">
                                            <select (change)="onDocumentSectionChange($event.target.value)"
                                                formControlName="sectionId" name="sectionId" id="sectionId"
                                                class="form-control">
                                                <option value="" i18n>-- Select Document Section --</option>
                                                <option *ngFor="let x of documentationSections" [value]="x.sectionId">
                                                    {{ x.staffRoleName }} :: {{ x.title }}</option>
                                            </select>

                                        </form>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="pull-right">
                                            <button *ngIf="displayDocumentation == false"
                                                (click)="previewDocumentation()" style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-file"></span><ng-container i18n>Preview</ng-container>
                                                </button>
                                            <button (click)="previewDocumentation(true)"
                                                style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-print"></span> <ng-container i18n>Print</ng-container>
                                                </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Default FAM Preview -->

                            <!-- FAM -->
                            <div *ngIf="displayDocumentation == false" class="panel-body"
                                style="min-height:100vh; height:100vh;">
                                <CKEDITOR *ngIf="editMode == true" [content]="sectionContent" [height]="'100%'"
                                    (contentChange)="contentChange($event)"></CKEDITOR>
                                <div id="print-selected-section" *ngIf="!editMode == true" [innerHTML]="sectionContent"
                                    style="overflow:auto;height:320px">
                                </div>
                                <div><i>{{ sectionDescription }}</i></div>

                            </div>



                            <div class="panel-footer">
                                <div class="row" style="padding-left:inherit;">
                                    <div class="col-md-12">
                                        <div class="form-horizontal">
                                            <div *ngIf="applicationSelection?.approvalStatusId != 2 && applicationSelection?.approvalStatusId != 3"
                                                class="form-group">

                                                <button *ngIf="allowTemplateToLoad == true" type="button"
                                                    (click)="getDocumentTemplate()" class="btn btn-warning" >
                                                    <span class="glyphicon glyphicon-plus"
                                                        style="padding-right:4px;"></span><ng-container i18n>Load Template</ng-container></button>


                                                <button [disabled]="selectedSectionIdIndex == null" type="button"
                                                    (click)="nextSection(1)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-left"
                                                        style="padding-right:4px;"></span> <ng-container i18n>Previous</ng-container>
                                                        </button>

                                                <button [disabled]="selectedSectionIdIndex == null" type="button"
                                                    (click)="nextSection(2)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-right"
                                                        style="padding-right:4px;"></span><ng-container i18n>Next</ng-container>
                                                        </button>

                                                <!-- <button [disabled]="!canForward() || !canEditDocument() || !(editMode == true)" -->
                                                <button [disabled]="!(editMode == true)" type="button"
                                                    (click)="saveSection(true)" class="btn btn-success"
                                                    style="margin-right:10px;">
                                                    <span class="glyphicon glyphicon-floppy-disk"
                                                        style="padding-right:4px;"></span><ng-container i18n> Save Changes</ng-container>
                                                        </button>


                                                <button
                                                    [disabled]="(selectedSectionIdIndex == null || editMode == true)"
                                                    type="button" (click)="printSelectedSection()"
                                                    class="btn btn-success" style="margin-right:10px;">
                                                    <span class="" style="padding-right:4px;"></span>
                                                        <ng-container i18n>Print Section</ng-container>
                                                        
                                                </button>


                                                <!-- <div class="pull-right">
                                                            <button (click)="DisplayExposureForm()" pButton type="button" label="Display Exposure" icon="fa-plus"></button>
                                                        </div> -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                    <!-- endof cam document 1 -->
                </p-tabPanel>

                <p-tabPanel i18n-header header="Application Information" [disabled]="disableApplicationInformationTab">
                    <div class="panel-body">
                        <div *ngIf="trailRecent != null" class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title">Last Comment</h2>
                            </div>
                            <div class="panel-body">
                                <div *ngIf="applicationSelection?.relatedReferenceNumber != null" class="col-md-12">
                                    <h4>
                                        <strong>RELATED APPLICATION:
                                            {{ applicationSelection?.relatedReferenceNumber }}</strong>
                                    </h4>
                                </div>
                                <div class="col-md-12">
                                    <h5>
                                        <b i18n>From: </b>{{ trailRecent.staffName }},
                                        <b i18n>Level: </b>{{ trailRecent.fromApprovalLevelName }},
                                        <b i18n>Time: </b>{{ trailRecent.systemArrivalDateTime | date: 'medium' }},
                                        <b i18n>Source: </b>{{ loanSource }}
                                    </h5>
                                    <h4>
                                        <i>{{ trailRecent.comment }}</i>
                                    </h4>
                                </div>
                            </div>
                        </div>

                        <app-customer-information-detail *ngIf="enabled" [loanApplicationId]="loanApplicationId">
                        </app-customer-information-detail>
                        <app-loan-application-details-view *ngIf="enabled" [isRecommendedInfo]="true"
                            [loanApplicationId]="applicationSelection?.loanApplicationId"
                            [isAccountOfficer]="userIsAccountOfficer"
                            [loanInformation]="applicationSelection?.loanInformation"
                            (loanApplicationDetailIds)="getMessage($event)">
                        </app-loan-application-details-view>



                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Customer Account Statistics</h2>
                            </div>

                            <div class="panel-body">
                                <div class="form-group" class="col-md-12">
                                    <div class="col-md-3">
                                        <select class="form-control" [(ngModel)]="applicationCustomerId"
                                            (change)="getCustomerByCustomerId($event.target.value)">
                                            <option value="0" i18n>-- Select Customer --</option>
                                            <option *ngFor="let x of applicationCustomers" [value]="x.customerId">
                                                {{ x.fullName }}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="searchItem" class="control-label col=md-2" i18n>
                                            Start Date
                                        </label>
                                            <p-calendar [(ngModel)]="startDate" dateFormat="dd-MM-yy" [monthNavigator]="true" [yearNavigator]="true"
                                                yearRange="2000:2050" [showIcon]="true">
                                            </p-calendar> 
                                    </div>
                                    <div class="col-md-3">
                                        <label for="searchItem" class="control-label col=md-2" i18n>
                                            End Date
                                        </label>
                                            <p-calendar [(ngModel)]="endDate" dateFormat="dd-MM-yy" [monthNavigator]="true" [yearNavigator]="true"
                                                yearRange="2000:2050" [showIcon]="true">
                                            </p-calendar> 
                                    </div>
                                    <div class="col-md-3">
                                        <button (click)="getCustomerTurnover()" class="btn btn-primary" i18n>
                                            Load Customer Turnover</button>
                                        <button (click)="onCustomerChange()" class="btn btn-primary" i18n>
                                            Fetch Customer Account Statistics</button>
                                    </div>
                                </div>

                                <br />
                                <!-- <div class="form-group" class="col-md-12">
                                    <div class="col-md-2">
                                        <strong i18n>Customer Rating</strong>
                                    </div>
                                    <div class="col-md-4">
                                        {{ selectedCustomerRating }}
                                    </div>
                                </div> -->


                            </div>
                        </div>

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Customer And Facility Rating</h2>
                            </div>

                            <div class="panel-body">
                                <div class="form-group" class="col-md-12">
                                    <div class="col-md-4">
                                        <!-- <button (click)="getCorporateCustomerRatingFromBasel()" class="btn btn-primary" i18n>
                                            Generate Customer Rating</button>
                                        <button (click)="getFacilityRatingFromBasel()" class="btn btn-primary">
                                            Load Facility Rating</button>
                                        <button (click)="getCustomerRatiosFromBasel()" class="btn btn-primary">
                                            Load Customer Ratios</button>  -->
                                            <div *ngIf="productClassProcessId !=2" class="col-md-2"><label class="control-label ">Credit Grade</label></div>
                                            <div *ngIf="productClassProcessId !=2" class="col-md-3">
                                                
                                                <select class="form-control " [(ngModel)]="creditGradeId" [disabled]="isAmongActivities('Edit Credit Grade') == false" [ngClass]="creditGradeId == null || creditGradeId <= 0 ? 'required-input' : 'valid-input'">
                                                    <option value="0" selected>--Select Credit Grade--</option>
                                                    <option [value]="1">Standard Grade</option>
                                                    <option [value]="2">Investment Grade</option>
                                                    <option [value]="3">Renewal </option>
                                                    
                                                </select>
                                            </div> 
                                    </div> 
                                </div>
                            </div>
                        </div> 

                        <div *ngIf="trailRecent != null" class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Term Sheet Details</h2>
                            </div>
                            <div class="panel-body" style="overflow-x: scroll; max-width: width auto;">
                                <p-dataTable [value]="termSheets" [responsive]="true" [paginator]="false" [rows]="8">
                                    <p-column i18n-header field="termSheetCode" header="Term Sheet Code" sortable="true"
                                        filterMatchMode="contains" [style]="{'width':'10%'}">
                                    </p-column>
                                    <p-column i18n-header field="computationOfInterest" header="Computation Of Interest"
                                        sortable="true" filterMatchMode="contains" [style]="{'width':'10%'}">
                                    </p-column>
                                    <p-column i18n-header field="repaymentSource" header="Repayment Source" sortable="true"
                                        filterMatchMode="contains" [style]="{'width':'25%'}">
                                    </p-column>
                                    <p-column i18n-header field="availability" header="Availability" sortable="true"
                                        filterMatchMode="contains" [style]="{'width':'25%'}"></p-column>
                                    <p-column i18n-header field="processingFee" header="Processing Fee" sortable="true"
                                        filterMatchMode="contains" [style]="{'width':'10%'}">
                                    </p-column>
                                    <p-column i18n-header [style]="{'width':'10%'}" header="View">
                                        <ng-template pTemplate="header"> </ng-template>
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <div style="text-align:center">
                                                <a (click)="viewTermSheetDetails(d)" href="javascript:void(0)" i18n>View Details</a>
                                            </div>
                                        </ng-template>
                                    </p-column>
                                </p-dataTable>
                            </div>

                        </div>


                        <!--<div class="panel panel-default">-->
                        <!--<div class="panel-heading">-->
                        <!--<h2 class="panel-title">Customer Financial Statement</h2>-->
                        <!--</div>-->
                        <!--<div class="panel-body">-->
                        <!--<app-customer-financial-statement [customerId]="applicationSelection?.customerId"-->
                        <!--[viewCustomerFinancialStatement]="viewCustomerFinancialStatement"-->
                        <!--[canDoFinancialStatementEntry]="canDoFinancialStatementEntry"-->
                        <!--[isAnalyst]="userisAnalyst"></app-customer-financial-statement>-->
                        <!--</div>-->
                        <!--<div class="panel-body">-->
                        <!--<p-dataTable [value]="customerRatios" [paginator]="true" [rows]="5">-->
                        <!--<p-header >Customer Ratio</p-header>-->
                        <!--<p-column i18n-header field="description" header="Description"></p-column>-->
                        <!--<p-column i18n-header field="value" header="Value"></p-column>-->
                        <!--</p-dataTable>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--===============================  customer ratios section ========================-->
                        <div class="panel panel-default" *ngIf="showFinancialStatement">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Customer Financial Statement</h2>
                            </div>
                            <div class="panel-body">
                                <!-- <button pButton type="button" style="margin:5px; width:150.168px" label="Customer Financial Statement"
                                    (click)="viewFinancialStatement()" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">
                                    <span class="ink ripple-animate" style="height: 290.25px;width: 290.25px;top: -130.313px;left: -19.625px;pointer-events: none;"></span>
                                </button>  -->
                                <!-- <app-customer-financial-statement [customerId]="applicationSelection?.customerId" [viewCustomerFinancialStatement]="true" [canDoFinancialStatementEntry]="false"></app-customer-financial-statement> -->
                                <app-customer-financial-statement [customerId]="applicationSelection?.customerId"
                                    [viewCustomerFinancialStatement]="viewCustomerFinancialStatement"
                                    [canDoFinancialStatementEntry]="canDoFinancialStatementEntry"
                                    [isAnalyst]="userisAnalyst"></app-customer-financial-statement>
                            </div>
                            <div class="panel-body">
                                <p-dataTable [value]="customerRatios" [paginator]="true" [rows]="5">
                                    <p-header i18n>Customer Ratio</p-header>
                                    <p-column i18n-header field="description" header="Description"></p-column>
                                    <p-column i18n-header field="value" header="Value"></p-column>
                                </p-dataTable>
                            </div>
                        </div>
                        <!--=============================== end of customer ratios section ========================-->


                        <div *ngIf="isProductProgram == false" class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Customer Rating</h2>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <div class="col-md-2">
                                        <select [attr.disabled]="isAnalyst == false ? true : null" class="form-control"
                                            [(ngModel)]="riskRatingId">
                                            <option value="null" i18n>-- Select Ratings--</option>
                                            <option *ngFor="let x of ratings" [value]="x.riskRatingId">
                                                {{ x.riskRating }}</option>
                                        </select>
                                    </div>
                                    <div *ngIf="isAnalyst == true" class="col-md-3">
                                        <button (click)="saveCustomerRating()" class="btn btn-primary form-control" i18n>
                                            Save and Validate Limit</button>
                                    </div>
                                    <div class="col-md-2">
                                        <span style="vertical-align:-5px;" *ngIf="obligorLimitValidated == true">
                                            <i class="glyphicon glyphicon-ok"></i>
                                        </span>
                                        <span style="vertical-align:-5px;" *ngIf="obligorLimitValidated == false">
                                            <i class="glyphicon glyphicon-remove"></i>
                                        </span>
                                    </div>
                                    <div>
                                        <b i18n>Limit:</b> {{ limitValidation?.limit | number:'1.2'}}
                                        <b i18n>Exposure:</b> {{ totalObligorExposure | number:'1.2'}}
                                        <b i18n>Available Limit:</b>
                                        {{ (limitValidation?.limit - totalObligorExposure) | number:'1.2' }}
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body">
                                <div class="row">

                                    <div class="col-md-2">
                                        <strong i18n>Undisbursed Approved Loans Balance</strong>
                                        <div>{{ totalExposureLimit?.undisbursedApprovedLoansBalance | number : '1.2' }}
                                        </div>
                                    </div>

                                    <div class="col-md-2">
                                        <strong i18n>RM NPL Exposure</strong>
                                        <div>{{ totalExposureLimit?.accountOfficerNPLExposure | number : '1.2' }}</div>
                                    </div>

                                    <div class="col-md-2">
                                        <strong i18n>RM NPL Limit</strong>
                                        <div>{{ totalExposureLimit?.accountOfficerNPLLimitString }}</div>
                                    </div>

                                    <div class="col-md-2">
                                        <strong i18n>Branch Exposure</strong>
                                        <div>{{ totalExposureLimit?.branchNPLExposure | number : '1.2' }}</div>
                                    </div>

                                    <div class="col-md-2">
                                        <strong i18n>Branch Limit</strong>
                                        <div>{{ totalExposureLimit?.branchNPLLimitString }}</div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <p-dataTable [value]="totalExposureLimit?.requestExposureLimits"
                                            [paginator]="true" [rows]="5" selectionMode="single">

                                            <p-column i18n-header field="productCustomerName" header="Facility"></p-column>

                                            <p-column i18n-header field="obligorExposure" header="Obligor Exposure" [filter]="false"
                                                filterMatchMode="contains"
                                                [style]="{'width':'120px','text-align':'right'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.obligorExposure | number : '1.2' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="obligorLimitString" header="Obligor Limit"
                                                [style]="{'width':'100px'}"></p-column>

                                            <p-column i18n-header field="sectorExposure" header="Sector Exposure" [filter]="false"
                                                filterMatchMode="contains"
                                                [style]="{'width':'120px','text-align':'right'}">
                                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                    {{ d.sectorExposure | number : '1.2' }}
                                                </ng-template>
                                            </p-column>

                                            <p-column i18n-header field="SectorLimitString" header="Sector Limit"
                                                [style]="{'width':'100px'}"></p-column>


                                        </p-dataTable>


                                    </div>
                                </div>

                            </div>
                        </div>

                        <div *ngIf="isProductProgram == true" class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Product Rating</h2>
                            </div>
                            <div class="panel-body">
                                <p-dataTable [value]="proposedItems" [paginator]="true" [rows]="5">
                                    <p-column i18n-header field="proposedProductName" header="Proposed Product"></p-column>
                                    <p-column i18n-header field="productRiskRating" header="Rating"></p-column>
                                </p-dataTable>
                            </div>
                        </div>

                        <!-- <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title">Tranche Disbursement Approval Level</h2>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <div class="col-md-3">
                                        <select class="form-control" [(ngModel)]="tranchDisbursmentApproval LevelId"
                                            [attr.disabled]="isAnalyst == false ? true : null">
                                            <option value="null">-- Select Approval Level --</option>
                                            <option *ngFor="let x of tranchDisbursmentApproval Levels" [value]="x.id">
                                                {{ x.name }}</option>
                                        </select>
                                    </div>
                                    <div *ngIf="isAnalyst == true" class="col-md-3">
                                        <button (click)="saveTranchDisbursmentApproval Level()"
                                            class="btn btn-primary form-control"> Save Approval Level</button>
                                    </div>
                                    <div class="col-md-3">
                                    </div>
                                </div>
                            </div>
                        </div> -->

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Loan Application Checklist</h2>
                            </div>
                            <div class="panel-body">
                                <app-loan-checklist [operationId]="OPERATION_ID"
                                    [productClassProcessId]="productClassProcessId" [productId]="productId"
                                    [loanApplicationDetailId]="loanApplicationId"
                                    [loanApplicationId]="loanApplicationId" [isCAMchecklist]="true"
                                    [isAvailmentChecklist]="false" [onPageLoad]="false"
                                    [applicationSelection]="applicationSelection"
                                    [customerId]="applicationSelection?.customerId">
                                </app-loan-checklist>
                            </div>
                        </div>

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Fee Rates & Concessions</h2>
                            </div>
                            <div class="panel-body">

                                <table class="table table-casa-information">
                                    <tbody>
                                        <tr>
                                            <th i18n>Facility</th>
                                            <th i18n>Fee</th>
                                            <th i18n>Default</th>
                                            <th i18n>Recommended</th>
                                            <th i18n>Status</th>
                                            <th i18n>Concession</th>
                                            <th i18n>Concession Reason</th>
                                        </tr>
                                        <tr *ngFor="let x of fees">
                                            <td>{{ x.productName }}</td>
                                            <td>{{ x.feeName }}</td>
                                            <td>{{ x.defaultFeeRate | number:'1.2' }}</td>
                                            <td>{{ x.recommendedFeeRate | number:'1.2' }}</td>
                                            <td>{{ x.approvalStatus }}</td>
                                            <td>{{ x.hasConcession ? 'Yes' : '' }}</td>
                                            <td>{{ x.concessionReason }}</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- <pre>{{applicationSelection | json}}</pre> -->
                            </div>
                        </div>
                        <!--
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title">Facility Summary</h2>
                            </div>
                            <div class="panel-body">
                               <app-facility-summary [reload]="reload" [applicationId]="applicationSelection?.loanApplicationId"></app-facility-summary>
                            </div>
                        </div> -->

                        <p-accordion #accordion>
                            <!-- // *ngIf="customer.length > 0"> -->
                            <p-accordionTab i18n-header [selected]="true" header="List of existing loans">
                                <expfacility [reload]="loanApplicationId" [customer]="customer"
                                    [loanTypeId]="loanTypeId">
                                </expfacility>
                            </p-accordionTab>
                            <p-accordionTab i18n-header header="List of Written-off Facilities">
                                <expcamsol [reload]="loanApplicationId" [customer]="customer" [loanTypeId]="loanTypeId">
                                </expcamsol>
                            </p-accordionTab>
                        </p-accordion>


                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Approval Process Changes</h2>
                            </div>
                            <div class="panel-body">

                                <button *ngIf="changeLog.length == 0 && showSpinnerChangeLog == false"
                                    (click)="getLoanDetailChangeLog()" class="btn btn-default">
                                    <ng-container i18n>Show Changes</ng-container><span class="glyphicon glyphicon-refresh"></span>
                                </button>

                                <div *ngIf="showSpinnerChangeLog == true" class="little-spinner"></div>

                                <div *ngIf="displayChangeLog == true" class="row" style="padding:0 15px 0 15px;">
                                    <table class="table table-casa-information">
                                        <tbody>
                                            <tr>
                                                <th i18n>Customer Name</th>
                                                <th i18n>Product Name</th>
                                                <th i18n>Tenor</th>
                                                <th i18n>Rate</th>
                                                <th i18n>Amount</th>
                                                <th i18n>Exchange Rate</th>
                                                <th i18n>Approval Status</th>
                                                <th i18n>Staff</th>
                                            </tr>
                                            <tr *ngFor="let x of changeLog">
                                                <td>{{ x.customerName }}</td>
                                                <td>{{ x.approvedProductName }}</td>
                                                <td >{{ x.approvedTenor/30 | number : '1.0-0' }} months</td>
                                                <td>{{ x.approvedRate | number:'1.2' }}</td>
                                                <td>{{ x.approvedAmount | number:'1.2' }}</td>
                                                <td>{{ x.exchangeRate | number:'1.2' }}</td>
                                                <td>{{ getApprovalStatus(x.statusId) }}</td>
                                                <td>{{ x.staffName }}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title">Existing Loans</h2>
                            </div>
                            <div class="panel-body">
                                <button *ngIf="existingLoans.length == 0 && showSpinnerExistingLoans == false"
                                    (click)="getCustomerExistingLoans()" class="btn btn-default">
                                    Show Existing Loans
                                    <span class="glyphicon glyphicon-refresh"></span>
                                </button>

                                <div *ngIf="showSpinnerExistingLoans == true" class="little-spinner"></div>

                                <div *ngIf="displayExistingLoans == true" class="row" style="padding:0 15px 0 15px;">

                                    <p-dataTable [value]="existingLoans" [responsive]="true">
                                        <p-column i18n-header field="loanReferenceNumber" header="Loan Reference Number"></p-column>
                                        <p-column i18n-header field="productName" header="Product" [style]="{'width': '200px'}">
                                        </p-column>
                                        <p-column i18n-header field="equityContribution" header="Equity Contribution"
                                            [style]="{'text-align': 'right'}"></p-column>
                                        <p-column i18n-header field="disburseDate" header="Date Disbursed">
                                            <ng-template let-col let-loan="rowData" pTemplate="body">
                                                {{loan[col.field] | date : 'dd/MM/yyyy' }}
                                            </ng-template>
                                        </p-column>
                                        <p-column i18n-header field="outstandingPrincipal" header="Oustanding Principal"
                                            [style]="{'text-align': 'right'}">
                                            <ng-template let-col let-loan="rowData" pTemplate="body">
                                                {{loan[col.field] | number : '1.2' }}
                                            </ng-template>
                                        </p-column>
                                        <p-column i18n-header field="approvedAmount" header="Amount Approved"
                                            [style]="{'text-align': 'right'}">
                                            <ng-template let-col let-loan="rowData" pTemplate="body">
                                                {{loan[col.field] | number : '1.2' }}
                                            </ng-template>
                                        </p-column>
                                        <p-footerColumnGroup>
                                            <p-row>
                                                <p-column i18n-header footer="Totals:" colspan="4"></p-column>
                                                <p-column i18n-header [footer]="existingExposure" [style]="{'text-align': 'right'}">
                                                </p-column>
                                                <p-column i18n-header [footer]="existingApproved" [style]="{'text-align': 'right'}">
                                                </p-column>
                                            </p-row>
                                        </p-footerColumnGroup>
                                    </p-dataTable>
                                </div>

                            </div>
                        </div> -->

                        <!-- de-dupe checks -->

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title"><ng-container i18n>Other applications check found</ng-container>
                                 ({{duplications.length}})</h2>
                            </div>
                            <div class="panel-body">
                                <p-dataTable [value]="duplications" [paginator]="true" [rows]="5" [responsive]="true">
                                    <p-column i18n-header field="applicationDate" header="Application Date">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.applicationDate | date: 'medium' }}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="applicationReferenceNumber" header="Reference Number"></p-column>
                                    <p-column i18n-header field="branchName" header="Branch Name"></p-column>
                                    <p-column i18n-header field="applicationAmount" header="Amount">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.applicationAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>
                                </p-dataTable>
                            </div>
                        </div>

                        <!-- pen -->

                        <prelimanary-evaluation-view-template
                            *ngIf="applicationSelection?.loanPreliminaryEvaluationId != null" [reload]="reload"
                            [penId]="applicationSelection?.loanPreliminaryEvaluationId"
                            [applicationId]="applicationSelection?.loanApplicationId">
                        </prelimanary-evaluation-view-template>

                        <!-- product limit validation -->

                        <div class="panel panel-default"
                            *ngIf="isAnalyst == true && applicationSelection?.productClassId == 7">

                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h2 class="panel-title pull-left" i18n>Product Limit Validation</h2>
                                    </div>
                                    <div class="pull-right">
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body">

                                <p-dataTable [value]="limitValidations" [paginator]="true" [rows]="5"
                                    selectionMode="single">

                                    <p-column i18n-header field="productCustomerName" header="Facility"></p-column>

                                    <p-column i18n-header field="recommendedAmount" header="Amount" [filter]="false"
                                        filterMatchMode="contains" [style]="{'width':'120px','text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.recommendedAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header field="controlAmount" header="Last Session School Fees" [filter]="false"
                                        filterMatchMode="contains" [style]="{'width':'180px','text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.controlAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header field="percentageLimit" header="Limit (%)" [style]="{'width':'100px'}">
                                    </p-column>

                                    <p-column i18n-header field="limit" header="Limit" [filter]="false" filterMatchMode="contains"
                                        [style]="{'width':'120px','text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.limit | number : '1.2' }}
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header field="isValid" header="Validity" [filter]="false"
                                        filterMatchMode="contains" [style]="{'width':'100px','text-align':'center'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <span *ngIf="d.isValid == true" class="label label-success" i18n>IS VALID</span>
                                            <span *ngIf="d.isValid == false" class="label label-danger" i18n>NOT VALID</span>
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header [style]="{'width':'103px'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <div style="text-align:center">
                                                <a (click)="editRecommended(d)" href="javascript:void(0)" i18n>Edit Limit</a>
                                            </div>
                                        </ng-template>
                                    </p-column>

                                </p-dataTable>
                                <!-- {{limitValidations | json}} -->
                            </div>
                        </div>

                        <!-- end product limit validation -->

                        <!-- SHARED COMPONENTS -->
                        <app-repayment-terms *ngIf="enabled" [reload]="applicationSelection?.loanApplicationId" [isAnalyst]="true"
                            [proposedItems]="proposedItems" [applicationId]="applicationSelection?.loanApplicationId"
                            (hasTerms)="hasTerms($event)" [applicationDetailId]="applicationSelection?.loanApplicationDetailId">
                        </app-repayment-terms>

                        <app-collateral-recommendation [reload]="applicationSelection?.loanApplicationId"
                            [isAnalyst]="isAnalyst" [applicationId]="applicationSelection?.loanApplicationId"
                            [proposedItems]="proposedItems">
                        </app-collateral-recommendation>

                        <app-loan-covenant [reload]="applicationSelection?.loanApplicationId"
                            [isAnalyst]="userisAnalyst" [applicationId]="applicationSelection?.loanApplicationId"
                            [proposedItems]="proposedItems">
                        </app-loan-covenant>

                        <app-additional-comment [reload]="applicationSelection?.loanApplicationId"
                            [isAnalyst]="isAnalyst" [applicationId]="applicationSelection?.loanApplicationId">
                        </app-additional-comment>

                        <!-- END SHARED COMPONENTS -->

                        <loan-accredited-consultants [reload]="applicationSelection?.loanApplicationId"
                            [applicationId]="applicationSelection?.loanApplicationId" [proposedItems]="proposedItems">
                        </loan-accredited-consultants>

                        <!-- <suggested-conditions *ngIf="isBusiness" [reload]="reload"
                            [applicationId]="applicationSelection?.loanApplicationId" [proposedItems]="proposedItems">
                        </suggested-conditions> -->



                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>
                                    Application Status
                                </h2>
                            </div>
                            <form novalidate [formGroup]="loanApplicationTagsForm" autocomplete="off">
                                <div class="panel-body">
                                    <div class="form-horizontal">
                                        <div class="form-group">

                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="isProjectRelated" id="isProjectRelated"
                                                        type="checkbox" (change)="changed($event)">
                                                </div><label i18n for="isProjectRelated" class="checkbox">Project  Related</label>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="isOnLending" id="isOnLending"
                                                        type="checkbox">
                                                </div><label i18n for="isOnLending" class="checkbox">On Lending</label>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="isInterventionFunds"
                                                        id="isInterventionFunds" type="checkbox">
                                                </div><label i18n for="isInterventionFunds" class="checkbox">Intervention Funds</label>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="domiciliationNotInPlace"
                                                        id="domiciliationNotInPlace" type="checkbox">
                                                </div><label i18n for="domiciliationNotInPlace"
                                                    class="checkbox">Domiciliation is not in place</label>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="withInstruction" id="withInstruction"
                                                        type="checkbox">
                                                </div><label i18n for="withInstruction" class="checkbox">Is With Instruction</label>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="isAgricRelated" id="isAgricRelated"
                                                        type="checkbox">
                                                </div><label i18n for="isAgricRelated" class="checkbox">Is Agric Related</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-md-2">
                                                <div class="checkbox-container">
                                                    <input formControlName="isSyndicated" id="isSyndicated"
                                                        type="checkbox">
                                                </div><label i18n for="isSyndicated" class="checkbox">Is Syndicated</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">
                                        <button type="button" (click)="saveLoanApplicationTags(loanApplicationTagsForm)"
                                            class="btn btn-success btn-xs pull-right" i18n>Save changes</button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Actions</h2>
                            </div>
                            <div class="panel-body">
                                <!-- <div class="panel-body" *ngIf="loanHasValidFacilityNumbers()"> -->

                                <!-- <button *ngIf="(!(!canForward() || trailCount < 1)) && userIsAccountOfficer != true" type="button" (click)="refer()" -->
                                <button
                                    *ngIf="userIsAccountOfficer == true && loanApplicationId > 0 && operationId > 0 && apiRequestId == null"
                                    type="button" (click)="sendLoanToApplications()" class="btn btn-primary">
                                    <span
                                        class="glyphicon glyphicon-chevron-left" style="padding-right:8px;"></span>
                                    <ng-container  i18n>Send to applications for edit</ng-container></button>

                                <button *ngIf="((canForward() || trailCount > 1)) && userIsAccountOfficer == false"
                                    type="button" (click)="refer()" class="btn btn-primary" ><span
                                        class="glyphicon glyphicon-chevron-left" style="padding-right:4px;"></span>
                                        <ng-container i18n> Refer Back</ng-container>
                                </button>

                                <button *ngIf="!(!canForward() || privilege.canApprove)" type="button"
                                    (click)="forward()" class="btn btn-success"><span
                                        class="glyphicon glyphicon-chevron-right" style="padding-right:4px;"></span>
                                    {{AcceptButtonText}}</button>

                                <button *ngIf="!(!canForward() || !privilege.canApprove)" type="button"
                                    (click)="disapprove()" class="btn btn-danger"><span
                                        class="glyphicon glyphicon-remove" style="padding-right:4px;"></span>
                                    <ng-container i18n>Decline</ng-container>
                                    </button>

                                <button *ngIf="!(!canForward() || !privilege.canApprove)" type="button"
                                    (click)="approve()" class="btn btn-success"><span class="glyphicon glyphicon-ok"
                                        style="padding-right:4px;"></span><span
                                        [innerHTML]="getApproveButtonLabel()"></span></button>

                                <button *ngIf="privilege.canEscalate == true" type="button" (click)="escalate()"
                                    class="btn btn-warning"><span class="glyphicon glyphicon-export"
                                        style="padding-right:4px;"></span>
                                        <ng-container i18n>Escalate</ng-container>
                                        
                                    </button>

                                <button *ngIf="(legalLendingLimitImpact > 0)" type="button"
                                    (click)="selectApprover()" class="btn btn-default"><span
                                        class="glyphicon glyphicon-user" style="padding-right:4px;"></span>
                                        <ng-container>Select Approver</ng-container>
                                        
                                    </button>
                                <button *ngIf="isBusiness && !(legalLendingLimitImpact > 0)" type="button"
                                    class="btn btn-default"><span class="glyphicon glyphicon-user"
                                        style="padding-right:4px;"></span>
                                        <ng-container i18n>Fetching Approvers</ng-container>
                                        ...</button>

                                <button *ngIf="selectedApprover != ''" type="button" class="btn btn-default"
                                    style="border-color:transparent;"><i>{{selectedApprover}}</i></button>

                            </div>
                        </div>

                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header header="Risk Acceptance Criteria" [disabled]="disableConditionsTab">
                    <div class="panel-heading">
                        <h2 class="panel-title" i18n>
                            Risk Acceptance Criteria
                        </h2>
                    </div>
                    <div class="panel-body">
                        <div class="form-horizontal">
                            <div class="form-group">

                                <div class="col-md-4">
                                    <select name="productDropDown" id="productDropDown"
                                        (change)="getRac($event.target.value)" [(ngModel)]="productDropDown"
                                        class="form-control">
                                        <option value="" i18n>-- Select Facility --</option>
                                        <option *ngFor="let x of faciliies" [value]="x.productId">
                                            {{ x.productName }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div>
                            <risk-acceptance-criteria-detail [customerId]="customerId"
                                [loanApplicationId]="loanApplicationDetailId" [operationId]="2"
                                [productId]="proposedProductId" [reload]="proposedProductId">
                            </risk-acceptance-criteria-detail>
                        </div>
                    </div>
                </p-tabPanel>
                <p-tabPanel i18n-header header="Conditions" [disabled]="disableConditionsTab">

                    <div class="panel panel-default">
                        <!-- default -->
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left">
                                        <ng-container i18n>Conditions</ng-container>
                                        
                                        <small>- {{ workingLoanApplication }}</small>
                                        <!-- {{selectedConditions | json}} -->
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <!-- <suggested-conditions [reload]="reload" [callerId]="1" [isAnalyst]="isAnalyst" [applicationId]="applicationSelection?.loanApplicationId"
                        [isCondition]="isCondition" [proposedItems]="proposedItems"></suggested-conditions> -->

                        <app-credit-condition [reload]="reload" [callerId]="1" [isAnalyst]="true" [isBusiness]="true"
                            [applicationId]="applicationSelection?.loanApplicationId" [proposedItems]="proposedItems">
                        </app-credit-condition>

                    </div>

                </p-tabPanel>

                <p-tabPanel i18n-header header="Transaction Dynamics" [disabled]="disableDynamicsTab">

                    <div class="panel panel-default">
                        <!-- default -->
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left">
                                      <ng-container i18n>Transaction Dynamics</ng-container><small>- {{ workingLoanApplication }}</small>
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <app-transaction-dynamics [reload]="reload" [callerId]="1" [isAnalyst]="true"
                            [isBusiness]="true" [applicationId]="applicationSelection?.loanApplicationId"
                            [proposedItems]="proposedItems">
                        </app-transaction-dynamics>

                    </div>
                </p-tabPanel>

                <p-tabPanel i18n-header header="Collateral Information" [disabled]="disableSupportingDocumentsTab">

                    <div style="padding: 15px 0px 15px 0px">
                        <collateral-information [applicationId]="applicationSelection?.loanApplicationId"
                            [customerGroupId]="customerGroupId" [loanTypeId]="loanTypeId"
                            [isRegistrationDoneViaLoanApplication]="isRegistrationDoneViaLoanApplication"
                            [applicationCustomerId]="applicationSelection?.customerId" [showCustomerCollaterals]="true"
                            [applicationCustomerName]="applicationSelection?.customerName" [currencyId]="currencyId"
                            [applicationCustomerGroupId]="applicationSelection?.customerGroupId"
                            [reloadCustomerCollateral]="reload" [autoMapNew]="true" [hideProposeButton]="false" [collateralAtAppraisal]="true"
                            (proceedEvent)="refreshCollateral()" [hideCreateButton]="false" [canEditExternally]="false">
                        </collateral-information>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">

                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left">
                                       <ng-container i18n> Proposed Collaterals</ng-container>
                                        <b [innerHtml]="getCollateralCoverageStatus()"></b>
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <div class="panel-body coll-list">
                            <p-dataTable [value]="proposedCollateral" [paginator]="true" [rows]="3">
                                <p-column i18n-header field="collateralCode" header="Collateral Code" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header field="collateralOwnerName" header="Collateral Owner"
                                    filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header field="productName" header="Product Name" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header field="customerName" header="Obligor Name" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header field="facilityAmount" header="Propose Facility Amount"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.facilityAmount | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="availableCollateralValue" header="Available Collateral Value"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.baseCurrencyCode}} {{ d.availableCollateralValue | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="expectedCoveragePercentage" header="Expected Collateral Coverage (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.expectedCoveragePercentage }} %
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="expectedCollateralCoverage" header="Expected Coverage"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.expectedCollateralCoverage | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="actualCollateralCoverage" header="Actual Coverage"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.actualCollateralCoverage | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="actualCoveragePercentage" header="Actual Collateral Coverage (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.actualCoveragePercentage }} %
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header field="totalCoverage" header="Total Facility Coverage Achieved (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.totalCoverage }} %
                                    </ng-template>
                                </p-column>

                            </p-dataTable>
                        </div>
                    </div>
                    <!-- ======== end ======== -->
                </p-tabPanel>

                <p-tabPanel i18n-header header="Supporting Documents" [disabled]="disableSupportingDocumentsTab">
                    <!-- <document-upload
                        [deleteLink]="false"
                        [panelTitle]="CREDITAPPRIASALDOC"
                        [reload]="reload"
                        [operationId]="applicationSelection?.operationId"
                        [isOperationSpecific]="false"
                        [targetId]="applicationSelection?.loanApplicationId"
                        [targetReferenceNumber]="applicationSelection?.applicationReferenceNumber">
                    </document-upload>  -->

                    <document-upload [operationId]="OPERATION_ID" [isLms]="false"
                        [reload]="applicationSelection?.loanApplicationId"
                        [customerId]="applicationSelection?.customerId"
                        [customerGroupId]="applicationSelection?.customerGroupId"
                        [targetId]="applicationSelection?.loanApplicationId" [isOperationSpecific]="false"
                        (requiredDocumentsUploadSatisfied)="setrequiredUploadValue($event)"
                        [targetReferenceNumber]="applicationSelection?.relatedReferenceNumber == null ? applicationSelection?.applicationReferenceNumber : applicationSelection?.relatedReferenceNumber"
                        [reload]="loanApplicationId">
                    </document-upload>

                </p-tabPanel>

                <p-tabPanel i18n-header header="Comments" [disabled]="disableApprovalsAndCommentsTab">
                    <div class="panel panel-default">
                        <!-- <app-approval-comments [all]="true" [tableLabel]="Approval Process Comments" [operationId]="applicationSelection?.operationId" [applicationId]="applicationSelection?.loanApplicationId"></app-approval-comments> -->

                        <app-approval-comments [operationId]="applicationSelection?.operationId"
                            [applicationId]="applicationSelection?.loanApplicationId" [all]="true">
                        </app-approval-comments>

                    </div>

                </p-tabPanel>

                <p-tabPanel i18n-header header="Monitoring Triggers" [disabled]="disableTriggersTab" *ngIf="isAnalyst">
                    <app-monitoring-triggers [reload]="reload" [isAnalyst]="isAnalyst"
                        [applicationId]="applicationSelection?.loanApplicationId" [proposedItems]="proposedItems">
                    </app-monitoring-triggers>
                </p-tabPanel>



                <!-- <p-tabPanel i18n-header header="Job Requests" [disabled]="applicationSelection == null">
                   
                    <div class="form-horizontal">
                        <div class="form-group">
                            <label i18n class="control-label col-md-12">Select Facility</label>
                            <div class="col-md-6">
                                <select [(ngModel)]="selectedApplicationDetailId" class="form-control">
                                    <option value="">-- Select Facility --</option>
                                    <option *ngFor="let x of proposedItems" [ngValue]="x.loanApplicationDetailId">
                                        {{ x.obligorName }} -- {{ x.proposedProductName }} -- {{ x.proposedAmount }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="selectedApplicationDetailId != null">
                        <job-request-template [hideCloseButton]=true [operationAvailable]=true
                            [targetId]="selectedApplicationDetailId" [jobSourceId]=jobSourceId
                            [moduleReferenceNumber]="applicationSelection?.applicationReferenceNumber"
                            [operationsId]="OPERATION_ID">
                        </job-request-template>
                    </div>

                    <div class="panel-body" style="overflow:auto;height:250px">
                        <job-request-view [loanApplicationId]="applicationSelection?.loanApplicationId"
                            [loanApplicationDetailId]="selectedApplicationDetailId" [operationId]=OPERATION_ID
                            [showTitle]="false">
                        </job-request-view>
                    </div>
                </p-tabPanel> -->

                <p-tabPanel *ngIf="userIsAccountOfficer && (operationId !=202 || operationId !=146)"
                    header="{{CamFamName}}" [disabled]="disableApplicationInformationTab">
                    <!-- [disabled]="disableAppraisalMemorandumTab || applicationSelection.productClassProcessId == 2"> -->

                    <!-- cam document -->
                    <div class="card no-padding">
                        <div class="panel panel-default">

                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-9">
                                        <form novalidate [formGroup]="documentSectionForm" autocomplete="off">
                                            <select (change)="onDocumentSectionChange($event.target.value)"
                                                formControlName="sectionId" name="sectionId" id="sectionId"
                                                class="form-control">
                                                <option value="" i18n>-- Select Document Section --</option>
                                                <option *ngFor="let x of documentationSections" [value]="x.sectionId">
                                                    {{ x.staffRoleName }} :: {{ x.title }}</option>
                                            </select>

                                        </form>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="pull-right">
                                            <button *ngIf="displayDocumentation == false"
                                                (click)="previewDocumentation()" style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-file"></span><ng-container i18n>Preview</ng-container>
                                                </button>
                                            <button (click)="previewDocumentation(true)"
                                                style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-print"></span><ng-container i18n>Print</ng-container>
                                                </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Default FAM Preview -->

                            <!-- FAM -->
                            <div *ngIf="displayDocumentation == false" class="panel-body"
                                style="min-height:100vh; height:100vh;">
                                <CKEDITOR *ngIf="(editMode == true)" [content]="sectionContent" [height]="250"
                                    (contentChange)="contentChange($event)"></CKEDITOR>
                                <div id="print-selected-section" *ngIf="!(editMode == true)"
                                    [innerHTML]="sectionContent" style="overflow:auto;height:320px">
                                </div>
                                <div><i>{{ sectionDescription }}</i></div>

                            </div>



                            <div class="panel-footer">
                                <div class="row" style="padding-left:inherit;">
                                    <div class="col-md-12">
                                        <div class="form-horizontal">
                                            <div *ngIf="applicationSelection?.approvalStatusId != 2 && applicationSelection?.approvalStatusId != 3"
                                                class="form-group">

                                                <button *ngIf="allowTemplateToLoad == true" type="button"
                                                    (click)="getDocumentTemplate()" class="btn btn-warning">
                                                    <span class="glyphicon glyphicon-plus"
                                                        style="padding-right:4px;"></span>
                                                        <ng-container i18n>Load Template</ng-container>
                                                    </button>


                                                <button [disabled]="selectedSectionIdIndex == null" type="button"
                                                    (click)="nextSection(1)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-left"
                                                        style="padding-right:4px;"></span> <ng-container i18n>Previous</ng-container>
                                                        </button>

                                                <button [disabled]="selectedSectionIdIndex == null" type="button"
                                                    (click)="nextSection(2)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-right"
                                                        style="padding-right:4px;"></span> Next</button>

                                                <!-- <button [disabled]="!canForward() || !canEditDocument() || !(editMode == true)" -->
                                                <button [disabled]="!(editMode == true)" type="button"
                                                    (click)="saveSection(true)" class="btn btn-success"
                                                    style="margin-right:10px;">
                                                    <span class="glyphicon glyphicon-floppy-disk"
                                                        style="padding-right:4px;"></span><ng-container i18n>Save Change</ng-container>
                                                        </button>

                                                <button type="button" (click)="DisplayExposureForm()"
                                                    class="btn btn-success" style="margin-right:10px;">
                                                    <span class="" style="padding-right:4px;"></span>
                                                <ng-container i18n>Update Exposure</ng-container>
                                                
                                                </button>

                                                <button
                                                    [disabled]="(selectedSectionIdIndex == null || editMode == true)"
                                                    type="button" (click)="printSelectedSection()"
                                                    class="btn btn-success" style="margin-right:10px;">
                                                    <span class="" style="padding-right:4px;"></span><ng-container i18n>Print Section</ng-container>
                                                    </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                    <!-- endof cam document 1 -->
                </p-tabPanel>
                <p-tabPanel i18n-header header="Contractor's Rating" [disabled]="disableTriggersTab"
                    *ngIf="contractTierings != null && contractTierings != undefined && contractTierings != {}">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left" i18n>
                                        Contractor Rating
                                    </h2>
                                    <div class="pull-right">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-body">

                            <table class="table table-bordered table-hover">

                                <tr>
                                    <th i18n>SN</th>
                                    <th i18n>Criteria</th>
                                    <th i18n>Value</th>
                                </tr>
                                <tbody>

                                    <tr *ngFor="let field of contractTieringComputation; let i = index;">
                                        <td>{{i + 1}}</td>
                                        <td>{{field.criteria}}</td>
                                        <td>{{field.actualValue}}</td>
                                        <td><a *ngIf="userIsAccountOfficer"
                                                (click)="editContractorTiering(field.contractorTierId)"
                                                href="javascript:void(0)" i18n>Edit</a></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2"><strong i18n>Customer Tier</strong></td>
                                        <td><strong>{{rating}}</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-tabPanel>
                <!-- cash   -->
                <!-- <p-tabPanel i18n-header *ngIf="operationId==202 || operationId==146" header="Approval Memo"
                    [disabled]="disableApplicationInformationTab">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 class="panel-title pull-left">
                                        Credit Card Approval Memo
                                    </h2>
                                    <button *ngIf="userIsAccountOfficer" type="button" (click)="editCashBack()"
                                        class="btn btn-success pull-right">Edit Memo</button>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="cashBackHtml != null" class="panel-body" style="min-height:450px;">
                            <app-ckeditior-project [content]="cashBackHtml" [height]="400"
                                (contentChange)="contentChange($event)"></app-ckeditior-project>
                        </div>

                    </div>

                </p-tabPanel> -->

            </p-tabView>
        </div>
    </div>
</div>

<p-dialog [responsive]=true [(visible)]="showCasgBackForm" id="add-modal" modal="modal" showEffect="fade" width="1200">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title" i18n>
                CASHBACK
            </h2>
        </div>

        <form novalidate [formGroup]="cashBackForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label i18n for="" class="control-label col-md-2">Background</label>
                        <div class="col-md-4 pull-left">
                            <textarea style="height:87px;widows: 100px;" formControlName="background"
                                [ngClass]="!cashBackForm.controls['background'].valid ? 'required-input' : 'valid-input'"
                                name="background" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label i18n for="" class="control-label col-md-2">Issues</label>
                        <div class="col-md-4 pull-left">
                            <textarea style="height:87px;widows: 100px;" formControlName="issues"
                                [ngClass]="!cashBackForm.controls['issues'].valid ? 'required-input' : 'valid-input'"
                                name="issues" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label i18n for="" class="control-label col-md-2">Request</label>
                        <div class="col-md-4 pull-left">
                            <textarea style="height:87px;widows: 100px;" formControlName="request"
                                [ngClass]="!cashBackForm.controls['request'].valid ? 'required-input' : 'valid-input'"
                                name="request" class="form-control"></textarea>
                        </div>
                    </div>

                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" (click)="submitCashbackForm(cashBackForm)"
                            [disabled]="cashBackForm.invalid" class="btn btn-success pull-right" i18n>Save</button>
                        <button type="button" (click)="showCasgBackForm=false" style="margin-right:5px"
                            class="btn btn-danger pull-right" i18n>Cancel</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog>
<!--modal for obligor / Loan details starts-->

<!--modal ends-->


<!--append modal-->
<p-dialog [responsive]=true [(visible)]="displayAppendModal" id="append-modal" modal="modal" showEffect="fade"
    width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title" i18n>Load Document Template</h2>
            <div class="pull-right">
                <a class="close" (click)="displayAppendModal=false">&times;</a>
            </div>
        </div>

        <form novalidate [formGroup]="appendForm" autocomplete="off">

            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n for="creditTemplateId" class="control-label col-md-4">Document Template</label>
                        <div class="col-md-8">
                            <select name="creditTemplateId" id="creditTemplateId" formControlName="creditTemplateId"
                                class="form-control"
                                [ngClass]="appendForm.controls['creditTemplateId'].valid ? 'valid-input' : 'required-input'">
                                <option value="" i18n>-- Select Document Template --</option>
                                <option *ngFor="let x of documentTemplates" [value]="x.templateId">{{ x.templateName }}
                                </option>
                            </select>
                        </div>
                    </div>

                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" (click)="loadDocumentTemplate(appendForm)" [disabled]="appendForm.invalid"
                            class="btn btn-warning pull-right" i18n>Load Document</button>
                    </div>
                </div>
            </div>

        </form>

    </div>
</p-dialog>
<!--end of append modal-->



<!--modal for obligor / Loan details starts-->


<!--modal ends-->


<!--comment form modal-->
<p-dialog [responsive]=true [(visible)]="displayCommentForm" id="comment-modal" modal="modal" showEffect="fade"
    width="1200" [contentStyle]="{'overflow':'auto','max-height':'700px'}">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title">
                {{ commentTitle }}
                <!-- CHANGES: {{this.recommendedItems.length}}, -->
                <!-- VALID ITEMS {{validLineItems()}},  -->
                <!-- CHANGED: {{ recommendedItems.length }} -->
            </h2>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="panel-body">

                    <div *ngIf="warningMessage != ''" class="alert alert-danger">
                        <strong i18n>Warning!</strong> {{ warningMessage }}
                    </div>

                    <div style="display: inline-block;
                        max-width: 100%;
                        margin-bottom: 5px;
                        font-weight: 700;" ><ng-container i18n>Loans -</ng-container>
                        <small i18n>Select facility to review</small>
                    </div>

                    <p-dataTable [value]="proposedItems" [paginator]="true" [rows]="5" selectionMode="single"
                        (onRowSelect)="onLineRowSelect($event.data)">

                        <p-column i18n-header field="obligorName" header="Customer Name"></p-column>
                        <p-column i18n-header field="proposedProductName" header="Proposed Product"></p-column>

                        <p-column i18n-header header="Proposed Tenor" [style]="{'width':'100px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.proposedTenorString }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="approvedRate" header="Proposed Rate" [style]="{'width':'100px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.proposedRate | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="proposedAmount" header="Proposed Limit" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.proposedAmount | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="currencyCode" header="" [style]="{'width':'43px'}"></p-column>

                        <p-column i18n-header field="exchangeRate" header="Ex. Rate" [style]="{'width':'60px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.exchangeRate
                                | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header header="Total Amount" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.proposedAmount * d.exchangeRate | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <!-- RESERVED - grid with updated changes -->

                        <!-- <p-column i18n-header field="obligorName" header="Customer Name"></p-column>
                        <p-column i18n-header field="approvedProductName" header="Proposed Product"></p-column>
                        <p-column i18n-header field="approvedTenor" header="Proposed Tenor" [style]="{'width':'100px'}"></p-column>

                        <p-column i18n-header field="approvedRate" header="Proposed Rate" [style]="{'width':'100px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.approvedRate | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="approvedAmount" header="Proposed Limit" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.approvedAmount | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="currencyCode" header="" [style]="{'width':'43px'}"></p-column>

                        <p-column i18n-header field="exchangeRate" header="Ex. Rate" [style]="{'width':'60px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.exchangeRate | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="convertedApprovedAmount" header="Total Amount" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.convertedApprovedAmount | number : '1.2' }}
                            </ng-template>
                        </p-column> -->

                        <!-- RESERVED - column for Cancellation of facility -->

                        <!-- <p-column i18n-header field="statusId" header="" [style]="{'text-align':'center','width':'60px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <a *ngIf="d.statusId == 2" (click)="onLineItemChange(5,3,d.loanApplicationDetailId)" href="javascript:void(0)" title="Cancel this product">Cancel</a>
                                <a *ngIf="d.statusId != 2" (click)="onLineItemChange(5,2,d.loanApplicationDetailId)" href="javascript:void(0)" title="Accept this product">Accept</a>
                            </ng-template>
                        </p-column> -->

                        <p-column i18n-header *ngIf="canSupport()" field="statusId" header="Status"
                            [style]="{'color':'#555','text-align':'center','width':'150px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <select (change)="onLineItemChange(5,$event.target.value,d.loanApplicationDetailId)">
                                    <option *ngIf="d.statusId != 2 && d.statusId != 3" value="" i18n >-- Select Status --
                                    </option>
                                    <option *ngIf="d.statusId != 3" >
                                        <small i18n>Not Supported</small>
                                    </option>
                                    <option *ngIf="d.statusId != 2" value="2" >
                                        <small i18n>Supported</small>
                                    </option>
                                    <option *ngIf="d.statusId == 3" value="3" selected="selected" >
                                        <small i18n>Not Supported</small>
                                    </option>
                                    <option *ngIf="d.statusId == 2" value="2" selected="selected" >
                                        <small i18n>Supported</small>
                                    </option>
                                </select>
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="statusId" header="" [style]="{'text-align':'right','width':'30px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="d.statusId == 2">
                                    <i class="glyphicon glyphicon-ok"></i>
                                </span>
                                <span *ngIf="d.statusId == 3">
                                    <i class="glyphicon glyphicon-remove"></i>
                                </span>
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="loanApplicationDetailId" header=""
                            [style]="{'text-align':'right','width':'25px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="touchedLineItems.indexOf(d.loanApplicationDetailId) > -1">*</span>
                            </ng-template>
                        </p-column>

                        <!-- <p-column i18n-header [style]="{'width':'58px'}"> <ng-template pTemplate="header"> </ng-template>
                            <ng-template let-x="rowData" let-i="rowIndex" pTemplate="body">
                                <a (click)="onSelectedLineChange(x.loanApplicationDetailId)" href="javascript:void(0)" title="Change Details">Change </a>
                            </ng-template>
                        </p-column> -->

                    </p-dataTable>

                </div>
            </div>
        </div>

        <form novalidate [formGroup]="commentForm" autocomplete="off">
            <div class="row">
                <div class="col-md-7">
                    <div class="panel-body" style="padding-right:0;">
                        <div class="form-horizontal">
                            <!-- <div class="form-group">
                                <label i18n for="" class="col-md-9">Recommended Product</label>
                                <label i18n for="" class="col-md-3"></label>
                                <div class="col-md-12">
                                    <select (change)="onLineItemChange(4,$event.target.value)"
                                        [attr.disabled]="enebleFacilityChange == false ? true : null" name="productId"
                                        formControlName="productId" id="productId" class="form-control"
                                        [ngClass]="!commentForm.controls['productId'].valid ? 'required-input' : 'valid-input'">
                                        <option value="">-- Change Product --</option>
                                        <option *ngFor="let x of products" [value]="x.productId">{{ x.productName }}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <select (change)="onLineItemChange(5,$event.target.value)" [attr.disabled]="true || isAnalyst == false || selectedLineId == null || privilege.canApprove == false ? true : null" name="statusId" formControlName="statusId" id="statusId" class="form-control" [ngClass]="!commentForm.controls['statusId'].valid ? 'required-input' : 'valid-input'">
                                        <option value="2">Accepted</option>
                                        <option value="3">Canceled</option>
                                    </select>
                                </div>
                            </div> -->
                            <!-- <div class="form-group">
                                <label i18n for="principal" class="col-md-3">Recommended Limit</label>
                                <label i18n for="rate" class="col-md-3">Recommended Rate</label>
                                <label i18n for="tenor" class="col-md-3">Recommended Tenor</label>
                                <label i18n for="exchangeRate" class="col-md-3">Exchange Rate</label>
                                <label i18n class="col-md-3">.</label>
                                <div class="col-md-3">
                                    <input (change)="onLineItemChange(1,$event.target.value)" type="text"
                                        [attr.disabled]="enebleFacilityChange == false ? true : null" name="principal"
                                        formControlName="principal" formatM id="principal" class="numeric form-control"
                                        [ngClass]="!commentForm.controls['principal'].valid ? 'required-input' : 'valid-input'">
                                </div>
                                <div class="col-md-3">
                                    <input (change)="onLineItemChange(2,$event.target.value)" type="text" [attr.disabled]="enebleFacilityChange == false ? true : null" name="rate" formControlName="rate" formatM id="rate" class="numeric form-control" [ngClass]="!commentForm.controls['rate'].valid ? 'required-input' : 'valid-input'">
                                </div>
                                <div class="col-md-3">
                                    <input (change)="onLineItemChange(3,$event.target.value)" type="text"
                                        [attr.disabled]="enebleFacilityChange == false ? true : null" name="tenor"
                                        formControlName="tenor" formatM id="tenor" class="numeric form-control"
                                        [ngClass]="!commentForm.controls['tenor'].valid ? 'required-input' : 'valid-input'">
                                </div>
                                <div class="col-md-3">
                                    <input (change)="onLineItemChange(6,$event.target.value)" type="text"
                                        [attr.disabled]="enebleFacilityChange == false ? true : null"
                                        name="exchangeRate" formControlName="exchangeRate" formatM id="exchangeRate"
                                        class="numeric form-control"
                                        [ngClass]="!commentForm.controls['exchangeRate'].valid ? 'required-input' : 'valid-input'">
                                </div>
                                <div class="col-md-3">
                                    <button (click)="getLoanDetailChangeLog(true)"
                                        class="btn btn-default btn-block">View Changes</button>
                                </div>
                            </div> -->

                            <!-- RESERVED - calculations of totals -->

                            <!-- <div class="form-group">
                                <label i18n for="initialExposure" class="col-md-3">Initial Limit</label>
                                <label i18n for="totalExposure" class="col-md-3">Authorized Limit</label>
                                <label i18n for="newExposure" class="col-md-3">New Set Limit</label>
                                <label i18n class="col-md-3">.</label>
                                <div class="col-md-3">
                                    <input type="text" [attr.disabled]="true" name="initialExposure" formControlName="initialExposure" id="initialExposure" class="numeric form-control">
                                </div>
                                <div class="col-md-3">
                                    <input type="text" [attr.disabled]="true" name="totalExposure" formControlName="totalExposure" id="totalExposure" class="numeric form-control">
                                </div>
                                <div class="col-md-3">
                                    <input type="text" [attr.disabled]="true" name="newExposure" formControlName="newExposure" id="newExposure" class="numeric form-control">
                                </div>
                                <div class="col-md-3">.
                                </div>
                            </div> -->

                            <!-- <div class="form-group">
                                <label i18n class="col-md-12">.</label>
                                <label i18n class="col-md-3"></label>
                                <label i18n class="col-md-3"></label>
                                <label i18n class="col-md-3"></label>
                                <div class="col-md-3">
                                    <button (click)="getLoanDetailChangeLog(true)" class="btn btn-default btn-block">View Changes</button>
                                </div>
                            </div> -->

                            <div class="form-group">
                                <div *ngIf="errorMessage.length > 0" class="alert alert-danger col-md-12" role="alert"
                                    style="margin: 0 15px 0 15px;width: -webkit-fill-available;">
                                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                    <span class="sr-only">Error: </span>{{ errorMessage }}
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- {{ commentForm.value | json }} -->
                </div>
                <!-- </div> -->
                <div class="col-md-5" style="background-color:#F5F5F5;border-left:solid 1px #ccc;">
                    <div class="panel-body">
                        <div class="form-horizontal">

                            <div *ngIf="forwardAction == 5" class="form-group">
                                <label i18n for="staffName" class="col-md-12">Target Level / Staff</label>
                                <div class="col-md-12">
                                    <!-- <input [(ngModel)]="queryReferBack" (keyup)="filterReferBack()" placeholder="Search for staff..." type="text" name="staffName" formControlName="staffName" id="staffName" class="form-control" [ngClass]="!commentForm.controls['staffName'].valid ? 'required-input' : 'valid-input'">
                                        <div class="autocomplete-suggestions" *ngIf="filteredTrail.length > 0">
                                            <ul *ngFor="let item of filteredTrail">
                                                <li style="list-style:none;">
                                                    <a href="javascript:;" (click)="selectReferBackLevel(item.fromApprovalLevelId, item.staffName)">{{item.staffName}}</a>
                                                </li>
                                            </ul>
                                        </div> -->
                                    <select (change)="onTargetStaffLevelChange($event.target.value)" type="text"
                                        name="trailId" formControlName="trailId" id="trailId" class="form-control"
                                        [ngClass]="!commentForm.controls['trailId'].valid ? 'required-input' : 'valid-input'">
                                        <option value="" i18n>-- Select Staff / Level --</option>
                                        <option *ngFor="let x of backtrail" [value]="x.approvalTrailId">
                                            {{ x.fromApprovalLevelName }} -- {{ x.fromStaffName }}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-md-12">
                                    <!-- <label i18n for="comment">{{ commentLabel }}</label> -->
                                    <label i18n for="comment">Comment/Recommendation</label>

                                </div>
                                <div class="col-md-12">
                                    <textarea style="height:87px;" name="comment" formControlName="comment" id="comment"
                                        class="form-control"
                                        [ngClass]="!commentForm.controls['comment'].valid ? 'required-input' : 'valid-input'"></textarea>
                                </div>
                            </div>

                            <div class="form-group"
                                *ngIf="isBusiness == false && forwardAction != 5 && userIsRelationshipManager == false && userIsAccountOfficer == false && userisAnalyst == false">
                                <!-- <div class="form-group" *ngIf="isBusiness === false && forwardAction !== 5 "> -->
                                <label i18n for="" class="col-md-12">Credit Decision </label>
                                <div class="col-md-6">
                                    <select name="vote" formControlName="vote"
                                        [ngClass]="!commentForm.controls['vote'].valid ? 'required-input' : 'valid-input'"
                                        id="vote" class="form-control">
                                        <option value="" i18n>-- Select Decision --</option>
                                        <option value="1" i18n>Decline</option>
                                        <option value="2" i18n>Accept</option>
                                        <option *ngIf="isBoard == true" value="3" i18n>Decline with condition</option>
                                        <option *ngIf="isBoard == false" value="4" i18n>Accept with condition</option>
                                        <!-- <option *ngIf="userIsRelationshipManager == false || userIsAccountOfficer == false" value="5">Non Decision Maker</option> -->
                                    </select>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="forwardCam(commentForm)"
                        [disabled]="commentForm.invalid || !(legalLendingLimitImpact > 0)"
                        class="btn btn-success pull-right">
                        <span class="glyphicon glyphicon-send" style="padding-right:4px;"></span>
                        <ng-container i18n>Save and Send</ng-container>
                        
                    </button>
                    <button type="button" (click)="cancelForm()" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>

        <!-- <div>{{commentForm.value | json}}</div> -->
        <!-- <div>{{ recommendedItems | json }}</div> -->

    </div>

</p-dialog>
<!--end of form modal-->

<!--modal for all documentation -->

<!-- <p-dialog [responsive]=true [(visible)]="displayDocumentation" modal="modal" showEffect="fade" width="1200" height="650">
    <div *ngIf="displayDocumentation" class="panel panel-default">

        <div class="panel-heading">
            <h2 class="panel-title">
                Appraisal Documentation for REFERENCE:
                <strong>{{ applicationSelection?.applicationReferenceNumber }}</strong> of OBLIGOR:
                <strong>{{ applicationSelection?.customerName }}</strong>
            </h2>
            <div class="pull-right">
                <a class="close" (click)="closeDocumentation()">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="overflow:auto;height:700px">
            <div *ngFor="let x of documentations">
                <p><strong>{{x.title}}</strong></p>
                <p><span [innerHtml]="x.templateDocument"></span></p>
            </div>
        </div>

    </div>
</p-dialog> -->

<!--modal ends-->

<!--
<div id="print-section">
    <div class="row">
        <div class="col-md-12" *ngFor="let x of documentations">
            <p><strong>{{x.title}}</strong></p>
            <p><span [innerHtml]="x.templateDocument"></span></p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2" style="text-align:center;margin-bottom:5px;" *ngFor="let x of signatures">
            <p>
                <img style="max-width: 100%;height:50px; display: block; margin: 0 auto;" [src]="'data:image/jpg;base64,'+x.fileData">
                <cite>{{ x.staffName }}</cite>
            </p>
        </div>
    </div>
</div> -->


<!--modal for all log -->

<p-dialog [responsive]=true [(visible)]="showChangeLog" modal="modal" showEffect="fade" width="900">
    <div class="panel panel-default">

        <div class="panel-heading">
            <h2 class="panel-title" i18n>
                Change log
            </h2>
            <div class="pull-right">
                <a class="close" (click)="showChangeLog = false">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="overflow:auto;height:300px">

            <table class="table table-casa-information">
                <tbody>
                    <tr>
                        <th i18n>Customer Name</th>
                        <th i18n>Product Name</th>
                        <th i18n>Tenor</th>
                        <th i18n>Rate</th>
                        <th i18n>Amount</th>
                        <th i18n>Exchange Rate</th>
                        <th i18n>Decision</th>
                        <th i18n>Approval Status</th>
                        <th i18n>Staff</th>
                    </tr>
                    <tr *ngFor="let x of changeLog">
                        <td>{{ x.customerName }}</td>
                        <td>{{ x.approvedProductName }}</td>
                        <td >{{ x.approvedTenor/30 | number : '1.0-0' }} months</td>
                        <td>{{ x.approvedRate | number:'1.2' }}</td>
                        <td>{{ x.approvedAmount | number:'1.2' }}</td>
                        <td>{{ x.exchangeRate | number:'1.2' }}</td>
                        <td>{{ getDecision(x.decision) }}</td>
                        <td>{{ getApprovalStatus(x.statusId) }}</td>
                        <td>{{ x.staffName }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
</p-dialog>

<!--modal ends-->

<!--product limit modal-->
<p-dialog [responsive]=true [(visible)]="displayLimitValidationForm" id="product-limit-modal" modal="modal"
    showEffect="fade" width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title" i18n>Review Amount</h2>
        </div>
        <form novalidate [formGroup]="limitValidationForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <div class="col-md-12">
                            <label i18n>Last Session School Fees</label>
                        </div>
                        <div class="col-md-12">
                            <input (change)="calculateExpectedRecommended()" name="controlAmount"
                                formControlName="controlAmount" formatM id="controlAmount" class="form-control"
                                [ngClass]="!limitValidationForm.controls['controlAmount'].valid ? 'required-input' : 'valid-input'">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-12">
                            <label i18n for="recommendedAmount">Recommended Amount</label>
                        </div>
                        <div class="col-md-12">
                            <input name="recommendedAmount" formControlName="recommendedAmount" formatM
                                id="recommendedAmount" class="form-control"
                                [ngClass]="!limitValidationForm.controls['recommendedAmount'].valid ? 'required-input' : 'valid-input'">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-12">
                            <label for="recommendedAmount">Maximum Limit:
                                {{ expectedRecommendedAmount | number : '1.2' }}</label>
                        </div>
                    </div>

                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" (click)="saveProductLimitValidation(limitValidationForm)"
                            [disabled]="limitValidationForm.invalid" class="btn btn-success pull-right" i18n>
                            Save</button>
                        <button type="button" (click)="displayLimitValidationForm=false" style="margin-right:5px"
                            class="btn btn-danger pull-right" i18n>
                            Cancel</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayPageFour" [contentStyle]="{'overflow':'auto','max-height':'600px'}"
    modal="modal" showEffect="fade" width="1000">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title" i18n>Account Statistics</h2>
        </div>

        <!--================ start search here ======================== -->
        <div class="card">
            <form novalidate [formGroup]="accountAnanalysisFilterForm" autocomplete="off">
                <div class="form-group col-md-12">
                    <!-- <label i18n for="" class="control-label col-md-2">
                        Accounts
                    </label>
                    <div class="col-md-3">
                        <select class="form-control" formControlName="account">
                            <option value="0">-- Select Customer --</option>
                            <option *ngFor="let x of applicationCustomers" [value]="x.customerId">
                                {{ x.fullName }}</option>
                        </select>
                    </div> -->

                    <label i18n for="" class="control-label col-md-2">
                        From
                    </label>
                    <div class="col-md-3">
                        <select name="fromMonth" class="form-control" formControlName="fromMonth">
                            <option value="0" selected="selected" i18n>-- Select Month --</option>
                            <option value="1" i18n>January</option>
                            <option value="2" i18n>February</option>
                            <option value="3" i18n>March</option>
                            <option value="4" i18n>April</option>
                            <option value="5" i18n>May</option>
                            <option value="6" i18n>June</option>
                            <option value="7" i18n>July</option>
                            <option value="8" i18n>August</option>
                            <option value="9" i18n>September</option>
                            <option value="10" i18n>October</option>
                            <option value="11" i18n>November</option>
                            <option value="12" i18n>December</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="text" formControlName="fromYear" i18n-placeholder placeholder="Year" name="fromYear"
                            class="form-control">
                    </div>
                </div>
                <div class="form-group col-md-12">
                    <!-- <label i18n for="" class="control-label col-md-2"></label>
                    <div class="col-md-3">
                    </div> -->
                    <label i18n for="" class="control-label col-md-2">
                        To
                    </label>
                    <div class="col-md-3">
                        <select name="toMonth" class="form-control" formControlName="toMonth">
                            <option value="0" selected="selected" i18n>-- Select Month --</option>
                            <option value="1" i18n>January</option>
                            <option value="2" i18n>February</option>
                            <option value="3" i18n>March</option>
                            <option value="4" i18n>April</option>
                            <option value="5" i18n>May</option>
                            <option value="6" i18n>June</option>
                            <option value="7" i18n>July</option>
                            <option value="8" i18n>August</option>
                            <option value="9" i18n>September</option>
                            <option value="10" i18n>October</option>
                            <option value="11" i18n>November</option>
                            <option value="12" i18n>December</option>

                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="text" formControlName="toYear" i18n-placeholder placeholder="Year" name="toYear"
                            class="form-control">
                    </div>
                </div>

            </form>
            <div class="row">
                <div class="col-md-12">

                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">

                        <button type="button" (click)="processAccountAnalysisFilter(accountAnanalysisFilterForm)"
                            class="btn btn-success btn-xs pull-right" i18n>Search</button>
                    </div>
                </div>
            </div>
        </div>
        <!--===================== end  search area =================-->
        <p-tabView>

            <p-tabPanel i18n-header header="Turnover Details">
                <div class="panel-body">
                    <p-dataTable [value]="firstTransaction" [paginator]="true" [rows]="5" selectionMode="single">

                        <p-column i18n-header field="accountNumber" header="Account Number" sortable="true" [filter]="true"
                            filterMatchMode="contains"></p-column>

                        <p-column i18n-header field="productAccountName" header="Account Type" sortable="true" [filter]="true"
                            filterMatchMode="contains"></p-column>

                        <p-column i18n-header field="period" header="Period" sortable="true" [filter]="true"
                            filterMatchMode="contains"></p-column>

                        <p-column i18n-header field="year" header="Year" sortable="true" [filter]="true" filterMatchMode="contains">
                        </p-column>

                        <p-column i18n-header field="max_Debit_Balance" header="Highest Debit Amount" [filter]="false"
                            sortable="true" filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.max_Debit_Balance | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="min_Debit_Balance" header="Lowest Debit Amount" [filter]="false"
                            sortable="true" filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.min_Debit_Balance | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="max_Credit_Balance" header="Highest Credit Amount" [filter]="false"
                            sortable="true" filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.max_Credit_Balance | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="min_Credit_Balance" header="Lowest Credit Amount" [filter]="false"
                            sortable="true" filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.min_Credit_Balance | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="debit_Turnover" header="Debit Turn Over" [filter]="false" sortable="true"
                            filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.debit_Turnover | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="credit_Turnover" header="Credit Turn Over" [filter]="false" sortable="true"
                            filterMatchMode="contains" [style]="{'text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.credit_Turnover | number : '1.2' }}
                            </ng-template>
                        </p-column>

                    </p-dataTable>
                </div>
            </p-tabPanel>

            <p-tabPanel i18n-header header="Revenue Item">
                <div class="panel-body">
                    <p-dataTable [value]="secondTransaction" [paginator]="true" [rows]="5" selectionMode="single">

                        <p-column i18n-header field="accountNumber" header="Account Number"></p-column>
                        <!-- <p-column i18n-header field="productName" header="Account Type"></p-column> -->
                        <p-column i18n-header field="period" header="Period"></p-column>

                        <p-column i18n-header field="float_Charge" header="Float Charge" [filter]="false" filterMatchMode="contains"
                            [style]="{'width':'120px','text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.float_Charge | number : '1.2' }}
                            </ng-template>
                        </p-column>

                        <p-column i18n-header field="interest" header="Interest" [filter]="false" filterMatchMode="contains"
                            [style]="{'width':'180px','text-align':'right'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                {{ d.interest | number : '1.2' }}
                            </ng-template>
                        </p-column>

                    </p-dataTable>
                </div>
            </p-tabPanel>
        </p-tabView>
    </div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12">
                <button type="button" (click)="displayPageFour=false" style="margin-right:5px"
                    class="btn btn-danger pull-right" i18n>Close</button>
            </div>
        </div>
    </div>
</p-dialog>


<!--real time search form-->
<p-dialog [responsive]="true" [(visible)]="displayApproverSearchForm" modal="modal" id="searchModal" showEffect="fade"
    width="650">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <div style="margin-left:0" class="row">
                <h2 class="panel-title pull-left" i18n>
                    Search Staff
                </h2>
                <div class="pull-right">
                    <a class="close" style="margin: -10px 8px;" (click)="displayApproverSearchForm=false">&times;</a>
                </div>
            </div>
        </div>
        <div style="padding:3px" class="panel-body">
            <div class="form-group">
                <div class="col-md-12">
                    <input type="text" id="search" #approvalInPut (keyup)="searchApprover($event.target.value)"
                        class="form-control" placeholder="Type in the staff name...">

                    <!-- <input type="text" id="search" #approvalInPut class="form-control"
                        placeholder="Type in the staff name..."> -->
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-12">
                    <p>
                        <!--{{mfacilityType}}-->
                    </p>
                    <table *ngIf="availableApprovers" class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th i18n>Staff Code</th>
                                <th i18n>First Name</th>
                                <th i18n>Middle Name</th>
                                <th i18n>Last Name</th>
                                <th i18n>Staff Role</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr (click)="pickSearchedApprover(res)" style="cursor: pointer"
                                *ngFor="let res of availableApprovers; let i = index">
                                <td>{{res.staffCode}}</td>
                                <td>{{res.firstName}}</td>
                                <td>{{res.secondName}}</td>
                                <td>{{res.lastName}}</td>
                                <td>{{res.staffRoleName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog [responsive]="true" [(visible)]="displayExposureModal" id="limit-def-modal" modal="modal" showEffect="fade"
    width="700">

    <div class="panel panel-default">

        <div class="panel-heading">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="panel-title pull-left" i18n>
                        Modify Exposure
                    </h2>

                    <div class="pull-right">
                        <button type="button" (click)="CloseExposure()" style="margin-right:5px"
                            class="btn btn-danger pull-right" i18n>Close</button>
                        <button type="button" (click)="DisplayEditExposureForm()" style="margin-right:5px"
                            class="btn btn-success pull-right" i18n>Add</button>
                    </div>
                </div>
            </div>
        </div>


        <div class="panel-body">
            <p-dataTable [value]="exposureSave" [responsive]="true" [paginator]="true" [rows]="5">
                <p-column i18n-header field="productName" header="Facility Name" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>
                <p-column i18n-header field="loanReferenceNumber" header="Reference Number" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>

                <p-column i18n-header field="customerName" header="Customer Name" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>

                <p-column i18n-header field="outstandingExpo" header="Outstanding Exposure" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>
                <p-column i18n-header field="currencyCode" header="Currency Code" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>
                <p-column i18n-header field="impact" header="Legal Lending Unit Unit(NGN)" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>
                <p-column i18n-header field="approvedAmount" header="Approved Amount" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>

                <p-column i18n-header field="tenor" header="Tenor(Month)" [filter]="true" sortable="true"
                    filterMatchMode="contains">
                </p-column>

                <p-column i18n-header [style]="{'width':'100px'}" header="View">
                    <ng-template pTemplate="header"> </ng-template>
                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                        <div style="text-align:center">
                            <a (click)="deleteExposure(d)" href="javascript:void(0)" i18n>Remove</a>
                        </div>
                    </ng-template>
                </p-column>

            </p-dataTable>

        </div>
    </div>
</p-dialog>

<p-dialog [responsive]="true" [(visible)]="displayEditExposureModal" id="limit-def-modal" modal="modal"
    showEffect="fade" width="1000">

    <div class="panel panel-default">

        <div class="panel-heading">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="panel-title pull-left" i18n>
                        Modify Exposure
                    </h2>

                    <div class="pull-right">
                        <button type="button" (click)="CloseEditExposure()" style="margin-right:5px"
                            class="btn btn-danger pull-right" i18n>Close</button>

                    </div>
                </div>
            </div>
        </div>

        <div class="panel-body">

            <div style="margin-bottom:0" class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">
                        {{entityName}}
                    </h2>
                </div>
                <form novalidate [formGroup]="ExposureForm" autocomplete="off">
                    <div class="panel-body">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label i18n for="callLimitTypeId" class="col-md-2 control-label">Facility Name</label>
                                <div class="col-md-4">
                                    <select id="facilityName" formControlName="facilityName" name="facilityName"
                                        class="form-control"
                                        [ngClass]="!ExposureForm.controls['facilityName'].valid ? 'required-input' : 'valid-input'">
                                        <option value="" i18n>Select Facility</option>
                                        <option *ngFor="let facility of facilities" value="{{facility.productId}}">
                                            {{facility.productName}}
                                        </option>
                                    </select>
                                </div>

                                <label i18n for="callLimitTypeId" class="col-md-2 control-label">Currency</label>
                                <div class="col-md-4">
                                    <select id="currency" formControlName="currency" name="currency"
                                        class="form-control"
                                        [ngClass]="!ExposureForm.controls['currency'].valid ? 'required-input' : 'valid-input'">
                                        <option value="">Select Currency</option>
                                        <option *ngFor="let curr of currencies" value="{{curr.currencyId}}">
                                            {{curr.currencyName}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>


                        <div class="form-horizontal">
                            <div class="form-group">
                                <label i18n for="callLimitTypeId" class="col-md-2 control-label">Outstanding Exposure</label>
                                <div class="col-md-4">
                                    <input type="text" name="outstandingExpo" formControlName="outstandingExpo"
                                        id="outstandingExpo" class="numeric form-control" formatM
                                        [ngClass]="ExposureForm.controls['outstandingExpo'].valid ? 'valid-input' : 'required-input'">
                                </div>

                                <label i18n for="currencyCode" class="col-md-2 control-label">Currency Code</label>
                                <div class="col-md-4">
                                    <select id="currencyCode" formControlName="currencyCode" name="currencyCode"
                                        class="form-control"
                                        [ngClass]="!ExposureForm.controls['currencyCode'].valid ? 'required-input' : 'valid-input'">
                                        <option value="" i18n>Select Currency</option>
                                        <option *ngFor="let code of currencies" value="{{code.currencyCode}}">
                                            {{code.currencyName}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label i18n for="impact" class="col-md-2 control-label">LLL Unit(NGN)</label>
                            <div class="col-md-4">
                                <input type="text" name="impact" formControlName="impact" id="impact"
                                    class="numeric form-control" formatM
                                    [ngClass]="ExposureForm.controls['impact'].valid ? 'valid-input' : 'required-input'">
                            </div>

                            <label i18n for="approvedAmount" class="col-md-2 control-label">Approved Amount</label>
                            <div class="col-md-4">
                                <input type="text" name="approvedAmount" formControlName="approvedAmount"
                                    id="approvedAmount" class="numeric form-control" formatM
                                    [ngClass]="ExposureForm.controls['approvedAmount'].valid ? 'valid-input' : 'required-input'">
                            </div>
                        </div>


                        <div class="form-group">
                            <label i18n for="tenor" class="col-md-2 control-label">Tenor(Month)
                            </label>
                            <div class="col-md-2">
                                <input type="text" name="tenor" formControlName="tenor" id="tenor"
                                    class="numeric form-control" formatM
                                    [ngClass]="ExposureForm.controls['tenor'].valid ? 'valid-input' : 'required-input'">
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-12">
                                <button type="submit" [disabled]="ExposureForm.invalid"
                                    (click)="submitexposureForm(ExposureForm)" class="btn btn-success pull-right" i18n>Save Exposure</button>

                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</p-dialog>

<!-- =================================== contracror criteria ======================== -->
<p-dialog [responsive]="true" [(visible)]="displayContractorCriteriaModal" id="limit-def-modal" modal="modal"
    showEffect="fade" width="1000">

    <div class="panel panel-default"
        *ngIf="contractCriteria != null && contractCriteria != undefined && contractCriteria != {}">

        <div *ngIf="contractCriteria != null" class="panel-heading">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="panel-title pull-left" i18n>
                        Contractor Rating
                    </h2>
                    <div class="pull-right">
                    </div>
                </div>
            </div>
        </div>

        <div class="panel-body">

            <form *ngIf="contractCriteria != null && contractCriteria != undefined && contractCriteria != {}"
                [formGroup]="contractorCriteriaForm" class="form-horizontal" autocomplete="off">
                <table class="table table-bordered table-hover">

                    <tr>
                        <th i18n>SN</th>
                        <th i18n>Required</th>
                        <th i18n>Value</th>
                    </tr>
                    <tbody>

                        <tr *ngFor="let field of contractCriteria; let i = index;">
                            <td>{{i + 1}}</td>
                            <td>{{field.criteria}}</td>
                            <td>
                                <div class="form-group row" style="margin:0px">
                                    <div>
                                        <select class="form-control" id={{field.criteriaId}} name={{field.criteriaId}}
                                            formControlName={{field.criteriaId}}
                                            [ngClass]="contractorCriteriaForm.controls[field.criteriaId].valid ? 'valid-input' : 'required-input'">
                                            <option value="">-- Select --</option>
                                            <option *ngFor=" let x of field.options" [value]="x.optionValue">
                                                {{x.optionName}}</option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                        </tr>

                    </tbody>
                </table>
                <div class="panel-footer">
                    <div class="row">
                        <div class="col-md-12">
                            <button type="button" (click)="submitContractorTieringForm(contractorCriteriaForm)"
                                [disabled]="contractorCriteriaForm.invalid"
                                class="btn btn-success pull-right" i18n>Save</button>
                            <button type="button" (click)="displayContractorCriteriaModal=false"
                                style="margin-right:5px" class="btn btn-danger pull-right" i18n>Cancel</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

</p-dialog>

<!-- =================================== update contracror criteria ======================== -->
<p-dialog [responsive]="true" [(visible)]="displayEditContractorTiering" id="limit-def-modal" modal="modal"
    showEffect="fade" width="1000">

    <div class="panel panel-default"
        *ngIf="contractCriteria != null && contractCriteria != undefined && contractCriteria != {}">

        <div *ngIf="contractCriteria != null" class="panel-heading">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="panel-title pull-left" i18n>
                        Contractor Rating
                    </h2>
                    <div class="pull-right">
                    </div>
                </div>
            </div>
        </div>

        <div class="panel-body">

            <form *ngIf="contractCriteria != null && contractCriteria != undefined && contractCriteria != {}"
                [formGroup]="contractorCriteriaForm" class="form-horizontal" autocomplete="off">
                <table class="table table-bordered table-hover">
                    <tr>
                        <th i18n>SN</th>
                        <th i18n>Required</th>
                        <th i18n>Value</th>
                    </tr>
                    <tbody>

                        <tr *ngFor="let field of contractCriteria; let i = index;">
                            <td>{{i + 1}}</td>
                            <td>{{field.criteria}}</td>
                            <td>
                                <div class="form-group row" style="margin:0px">
                                    <div>
                                        <select class="form-control" id={{field.criteriaId}} name={{field.criteriaId}}
                                            formControlName={{field.criteriaId}}
                                            [ngClass]="contractorCriteriaForm.controls[field.criteriaId].valid ? 'valid-input' : 'required-input'">
                                            <option value="" i18n>-- Select --</option>
                                            <option *ngFor=" let x of field.options" [value]="x.optionValue">
                                                {{x.optionName}}</option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                        </tr>

                    </tbody>
                </table>
                <div class="panel-footer">
                    <div class="row">
                        <div class="col-md-12">
                            <button type="button" (click)="submitContractorTieringForm(contractorCriteriaForm)"
                                [disabled]="contractorCriteriaForm.invalid"
                                class="btn btn-success pull-right" i18n>Save</button>
                            <button type="button" (click)="displayEditContractorTiering=false" style="margin-right:5px"
                                class="btn btn-danger pull-right" i18n>Cancel</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayMoreTermSheetDetails" modal="modal" showEffect="fade" width="800" [contentStyle]="{'overflow':'auto','max-height':'700px'}">
    <div *ngIf="displayMoreTermSheetDetails" style="margin-bottom:0" class="panel panel-default">

        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title" i18n>
                    Term Sheet Details
                </h2>
                <div class="pull-right">
                    <a class="close" (click)="displayMoreTermSheetDetails=false">&times;</a>
                </div>
            </div>
            <div class="panel-body">
                <div class="row" style="padding:0 15px 0 15px;">
                    <table class="table table-casa-information">
                        <tbody>
                            <tr>
                                <td>
                                    <strong i18n>Term Sheet Code:</strong>
                                </td>
                                <td>{{ termSheetDetails.termSheetCode }}</td>
                                <td>
                                    <strong i18n>Computation Of Interest:</strong>
                                </td>
                                <td>{{ termSheetDetails.computationOfInterest }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Repayment Source:</strong>
                                </td>
                                <td>{{ termSheetDetails.repaymentSource }}</td>
                                <td>
                                    <strong i18n>Availability:</strong>
                                </td>
                                <td>{{ termSheetDetails.availability }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Processing Fee:</strong>
                                </td>
                                <td>{{ termSheetDetails.processingFee | number : '1.2'}}</td>
                                <td>
                                    <strong i18n>Security Condition:</strong>
                                </td>
                                <td>{{ termSheetDetails.securityCondition }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Other Condition:</strong>
                                </td>
                                <td>{{ termSheetDetails.otherCondition }}</td>
                                <td>
                                    <strong i18n>Taxes:</strong>
                                </td>
                                <td>{{ termSheetDetails.taxes }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Transferability: </strong>
                                </td>
                                <td>{{ termSheetDetails.transferability }}</td>
                                <td>
                                    <strong i18n>Additional Comment:</strong>
                                </td>
                                <td>{{ termSheetDetails.comment }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Borrower:</strong>
                                </td>
                                <td>{{ termSheetDetails.borrower }}</td>
                                <td>
                                    <strong i18n>Facility Amount:</strong>
                                </td>
                                <td>{{ termSheetDetails.facilityAmount }}</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong i18n>Facility Type</strong>
                                </td>
                                <td>{{ termSheetDetails.facilityType }}</td>
                                <td>
                                    <strong i18n>Purpose:</strong>
                                </td>
                                <td>{{ termSheetDetails.purpose }}</td>
                            </tr>

                            <tr>
                                <td>
                                    <strong i18n>Tenor</strong>
                                </td>
                                <td>{{ termSheetDetails.tenor }}</td>
                                <td>
                                    <strong i18n>Permitted Account:</strong>
                                </td>
                                <td>{{ termSheetDetails.permittedAccount }}</td>
                            </tr>

                            <tr>
                                <td>
                                    <strong i18n>Debt Service Reserve Account</strong>
                                </td>
                                <td>{{ termSheetDetails.debtServiceReserveAccount }}</td>
                                <td>
                                    <strong i18n>Cancellation:</strong>
                                </td>
                                <td>{{ termSheetDetails.cancellation }}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</p-dialog>

<scroll-to-top-button></scroll-to-top-button>


<!--

<div class="col-md-12" style=" width:1px; overflow:auto;">
    <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="1px" width="1px" style="overflow:auto"></iframe>
  </div> -->

<!--end of form modal-->

<!-- <pre>SEL: {{applications | json}}</pre> -->
<!-- <pre>SEL: {{applicationSelection | json}}</pre> -->

<!--
<pre>CE: {{canEditDocument()}}</pre> -->
<!-- <pre>SEL: {{applicationSelection | json}}</pre>
<pre>{{ recommendedItems | json }}</pre> -->
<!-- CUSTOM:
<pre>{{ customTriggers | json }}</pre>
COLLECTION
<pre>{{ monitoringTriggerCollection | json }}</pre> -->
<!-- COLL
<pre>{{monitoringTriggerCollection | json}}</pre>

SEL
<pre>{{selectedTriggers | json}}</pre>

CUST
<pre>{{ customTriggers | json }}</pre> -->
<!-- <pre>{{defaultConditions | json}}</pre> -->
<!-- <pre>{{ repaymentTerms | json }}</pre> -->

<!-- <pre>{{exposures | json}}</pre> -->
<!-- <pre>{{privilege | json}}</pre> -->
<!-- <pre>{{ applicationSelection | json }}</pre> -->
<!-- <pre>{{ ratings | json }}</pre> -->
<!--

 {
  "isNewApplication": false,
  "closeApplication": false,
  "loanApplicationId": 6975,
  "loanApplicationDetailId": 0,
  "applicationReferenceNumber": "1524571869",
  "customerId": 77,
  "operationId": 6,
  "requireCollateral": false,
  "newApplicationDate": "2018-03-30T00:00:00+01:00",
  "branchId": 2,
  "productClassId": 5,
  "productClassName": "Cash Backed",
  "productId": 0,
  "customerGroupId": null,
  "customerGroupCode": null,
  "loanTypeId": 1,
  "casaAccountId": 0,
  "currencyId": 0,
  "currencyCode": null,
  "loanStatusId": 0,
  "loanStatus": null,
  "relationshipOfficerId": 1,
  "relationshipManagerId": 2,
  "applicationDate": "0001-01-01T00:00:00+01:00",
  "applicationAmount": 44000000,
  "approvedAmount": 0,
  "applicationTenor": 425,
  "interestRate": 0,
  "effectiveDate": null,
  "expiryDate": null,
  "customerAccount": null,
  "tenorModeId": 0,
  "loanInformation": "<p></p>",
  "misCode": "001",
  "teamMisCode": null,
  "submittedForAppraisal": true,
  "isRelatedParty": false,
  "isPoliticallyExposed": false,
  "approvalStatusId": 1,
  "proposedAmount": 0,
  "proposedTenor": 0,
  "approvalLevelId": 0,
  "subSectorId": 0,
  "sectorId": 0,
  "sectorName": null,
  "isInvestmentGrade": false,
  "customerName": "TOM INVESTMENTS  ",
  "branchName": "Ikeja Office",
  "productName": null,
  "customerGroupName": "",
  "loanTypeName": "Single Customer",
  "relationshipOfficerName": "Adesina Mark Omoniyi",
  "relationshipManagerName": "Jane Doe v Doe",
  "tenorModeName": null,
  "applicantName": "TOM INVESTMENTS  ()",
  "loanPreliminaryEvaluationId": null,
  "exchangeRate": 0,
  "loanApplicationCollateral": null,
  "loanApplicationDetail": [],
  "details": null,
  "currentApprovalStateId": 2,
  "currentApprovalLevelId": 88,
  "currentApproval Level": "Business Development Manager (BDM)",
  "lastComment": "OK",
  "approvalTrailId": 15719,
  "applicationStatusId": 3,
  "isCollateralBacked": false,
  "tenor": 0,
  "customerInfoValidated": false,
  "notInNegativeCrms": false,
  "notInBlackbook": false,
  "notInCamsol": false,
  "notInXds": false,
  "notInCrc": false,
  "firstName": null,
  "middleName": null,
  "customerCode": null,
  "lastName": null,
  "groupRoleId": 0,
  "accountNumber": null,
  "applicationStatus": null,
  "relatedReferenceNumber": null,
  "toStaffId": null,
  "productClassProcessId": 2,
  "companyId": 0,
  "companyName": null,
  "createdBy": 1558,
  "lastUpdatedBy": 0,
  "dateTimeCreated": "0001-01-01T00:00:00+01:00",
  "dateTimeUpdated": null,
  "deleted": false,
  "deletedBy": null,
  "dateTimeDeleted": null,
  "canModified": false,
  "userBranchId": 0,
  "userIPAddress": null,
  "applicationUrl": null,
  "staffId": 0
}
-->

<p-dialog (onHide)='dialogHiding($event)' (onShow)='dialogShowing($event)' [responsive]=true
    [(visible)]="displayDocumentation"
    [contentStyle]="{'overflow':'visible','min-height': '95vh','overflow-y': 'scroll', 'height': '95vh'}"
    [draggable]="false" appendToBody="true" modal="modal" showEffect="fade" width="1200">
    <div *ngIf="displayDocumentation" style="margin-bottom:0" class="panel panel-default" style="height: auto;">

        <div class="panel-heading">
            <h2 *ngIf="documentations != null && documentations != undefined && documentations.length > 0"
                class="panel-title">
                <ng-container i18n>FACILITY APPROVAL MEMO No.:</ng-container>
                
                <strong>{{ applicationSelection?.applicationReferenceNumber }}</strong>
                <!-- of
                                        OBLIGOR:
                                        <strong>{{ applicationSelection?.customerName }}</strong> -->
            </h2>
            <div class="pull-right">
                <a class="close" (click)="closeDocumentation()">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="height: auto;">
            <div *ngFor="let x of documentations">
                <p><strong>{{x.title}}</strong></p>
                <span [innerHtml]="x.templateDocument"></span>
            </div>
        </div>

    </div>
</p-dialog>

<scroll-to-top-button></scroll-to-top-button>


<!-- 

<div class="col-md-12" style=" width:1px; overflow:auto;">
    <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="1px" width="1px" style="overflow:auto"></iframe>
  </div> -->

<!--end of form modal-->

<!-- <pre>SEL: {{applications | json}}</pre> -->
<!-- <pre>SEL: {{applicationSelection | json}}</pre> -->

<!-- 
<pre>CE: {{canEditDocument()}}</pre> -->
<!-- <pre>SEL: {{applicationSelection | json}}</pre>
<pre>{{ recommendedItems | json }}</pre> -->
<!-- CUSTOM:
<pre>{{ customTriggers | json }}</pre>
COLLECTION
<pre>{{ monitoringTriggerCollection | json }}</pre> -->
<!-- COLL
<pre>{{monitoringTriggerCollection | json}}</pre>

SEL
<pre>{{selectedTriggers | json}}</pre>

CUST
<pre>{{ customTriggers | json }}</pre> -->
<!-- <pre>{{defaultConditions | json}}</pre> -->
<!-- <pre>{{ repaymentTerms | json }}</pre> -->

<!-- <pre>{{exposures | json}}</pre> -->
<!-- <pre>{{privilege | json}}</pre> -->
<!-- <pre>{{ applicationSelection | json }}</pre> -->
<!-- <pre>{{ ratings | json }}</pre> -->
<!--

 {
  "isNewApplication": false,
  "closeApplication": false,
  "loanApplicationId": 6975,
  "loanApplicationDetailId": 0,
  "applicationReferenceNumber": "1524571869",
  "customerId": 77,
  "operationId": 6,
  "requireCollateral": false,
  "newApplicationDate": "2018-03-30T00:00:00+01:00",
  "branchId": 2,
  "productClassId": 5,
  "productClassName": "Cash Backed",
  "productId": 0,
  "customerGroupId": null,
  "customerGroupCode": null,
  "loanTypeId": 1,
  "casaAccountId": 0,
  "currencyId": 0,
  "currencyCode": null,
  "loanStatusId": 0,
  "loanStatus": null,
  "relationshipOfficerId": 1,
  "relationshipManagerId": 2,
  "applicationDate": "0001-01-01T00:00:00+01:00",
  "applicationAmount": 44000000,
  "approvedAmount": 0,
  "applicationTenor": 425,
  "interestRate": 0,
  "effectiveDate": null,
  "expiryDate": null,
  "customerAccount": null,
  "tenorModeId": 0,
  "loanInformation": "<p></p>",
  "misCode": "001",
  "teamMisCode": null,
  "submittedForAppraisal": true,
  "isRelatedParty": false,
  "isPoliticallyExposed": false,
  "approvalStatusId": 1,
  "proposedAmount": 0,
  "proposedTenor": 0,
  "approvalLevelId": 0,
  "subSectorId": 0,
  "sectorId": 0,
  "sectorName": null,
  "isInvestmentGrade": false,
  "customerName": "TOM INVESTMENTS  ",
  "branchName": "Ikeja Office",
  "productName": null,
  "customerGroupName": "",
  "loanTypeName": "Single Customer",
  "relationshipOfficerName": "Adesina Mark Omoniyi",
  "relationshipManagerName": "Jane Doe v Doe",
  "tenorModeName": null,
  "applicantName": "TOM INVESTMENTS  ()",
  "loanPreliminaryEvaluationId": null,
  "exchangeRate": 0,
  "loanApplicationCollateral": null,
  "loanApplicationDetail": [],
  "details": null,
  "currentApprovalStateId": 2,
  "currentApprovalLevelId": 88,
  "currentApproval Level": "Business Development Manager (BDM)",
  "lastComment": "OK",
  "approvalTrailId": 15719,
  "applicationStatusId": 3,
  "isCollateralBacked": false,
  "tenor": 0,
  "customerInfoValidated": false,
  "notInNegativeCrms": false,
  "notInBlackbook": false,
  "notInCamsol": false,
  "notInXds": false,
  "notInCrc": false,
  "firstName": null,
  "middleName": null,
  "customerCode": null,
  "lastName": null,
  "groupRoleId": 0,
  "accountNumber": null,
  "applicationStatus": null,
  "relatedReferenceNumber": null,
  "toStaffId": null,
  "productClassProcessId": 2,
  "companyId": 0,
  "companyName": null,
  "createdBy": 1558,
  "lastUpdatedBy": 0,
  "dateTimeCreated": "0001-01-01T00:00:00+01:00",
  "dateTimeUpdated": null,
  "deleted": false,
  "deletedBy": null,
  "dateTimeDeleted": null,
  "canModified": false,
  "userBranchId": 0,
  "userIPAddress": null,
  "applicationUrl": null,
  "staffId": 0
}
-->