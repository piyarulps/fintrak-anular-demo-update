<div class="ui-g">
    <div class="ui-g-12 no-padding">
        <div class="panel panel-default">

            <div class="panel-heading">
                <!--module header-->
                <div class="row">
                    <div class="col-md-12">
                        <h2 i18n  class="panel-title pull-left">
                            Loan Review Appraisal
                        </h2>

                        <h2  class="panel-title pull-right" >
                            <small *ngIf="application != null && application?.approvalStatusId != 2 && application?.approvalStatusId != 3">
                                <ng-container i18n>Selected application is at</ng-container>
                                <b>{{ application?.currentApprovalLevel }}</b>
                            </small>
                        </h2>
                    </div>
                </div>
            </div>


            <p-tabView [activeIndex]="activeTabindex" (onChange)="onTabChange($event)" >

                <p-tabPanel i18n-header  header="Loan Review Applications" >
                    <loan-review-application-list [isApraisal]="true" [reload]="reloadGrid" [isInRouteMode]="false" [operationId]="OPERATION_ID" (selectedApplication)="onApplicationSelected($event)"></loan-review-application-list>
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Application Information" [disabled]="disableApplicationInformationTab">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2 i18n  class="panel-title">
                                        Application Details
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <div class="panel-body">

                            <div *ngIf="trailRecent != null" class="panel panel-default">
                                <div class="panel-heading">
                                    <h2 i18n  class="panel-title">Last Comment</h2>
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <h5>
                                            <b>From: </b>{{ trailRecent.fromStaffName }},
                                            <b>Level: </b>{{ trailRecent.fromApprovalLevelName }},
                                            <b>Time: </b>{{ trailRecent.systemArrivalDateTime | date: 'medium' }}</h5>
                                        <h4>
                                            <i>{{ trailRecent.comment }}</i>
                                        </h4>
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="showCustomer ==false"> <button pButton type="button" (click)="DisplayCustomerComponent()" i18n-label label="Show Customer Information" class="ui-button-info pull-left"> </button></div>
                            <div *ngIf="showComponents && showCustomer == true">
                                <!-- [loadWithCustomerId]="getSingleCustomerIds()" -->
                                <app-customer-information-detail [doNotCallLoadingService]="true" [loadWithCustomerId]="getSingleCustomerIds()"></app-customer-information-detail>
                            </div>

                            <table class="table table-casa-information">
                                <tbody>
                                    <tr>
                                        <th i18n>Application Date</th>
                                        <td>{{ application?.applicationDate | date: 'dd-MM-yyyy' }}</td>
                                        <th i18n>Reference Number</th>
                                        <td>{{ application?.referenceNumber }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Current Approval Level</th>
                                        <td>{{ application?.currentApprovalLevel }}</td>
                                        <th i18n>Approval Status</th>
                                        <td>{{ application?.approvalStatus }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Customer Name</th>
                                        <td>{{ application?.customerName }}</td>
                                        <th i18n>Branch Name</th>
                                        <td>{{ application?.branchName }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Last Comment</th>
                                        <td colspan=3>{{ application?.lastComment }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Activity Type</th>
                                        <td>{{ application?.operationTypeName }}</td>
                                        <th i18n>Review Details</th>
                                        <td>{{ operationTypeNames }}</td>
                                    </tr>

                                    <tr>
                                        <th i18n>Approved Rate</th>
                                        <td>{{ approvedRate }}</td>
                                        <th i18n>Proposed Rate</th>
                                        <td>{{ proposedRate }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Approved Tenor</th>
                                        <td>{{ approvedTenor }}</td>
                                        <th i18n>Proposed Tenor</th>
                                        <td>{{ proposedTenor }}</td>
                                    </tr>
                                    <tr>
                                        <th i18n>Approved Amount</th>
                                        <td>{{ approvedAmount }}</td>
                                        <th i18n>Proposed Amount</th>
                                        <td>{{ proposedAmount }}</td>
                                    </tr>
                                    <tr *ngIf="lmsLoanSystemTypeId != 4">
                                        <th i18n>Account Name</th>
                                        <td>{{ accountName }}</td>
                                        <th i18n>Account Number</th>
                                        <td>{{ accountNumber }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Loan Details</h2>
                        </div>
                        <div class="panel-body">

                            <div class="col-md-6">
                                <select (change)="onFacilityChange($event.target.value)" class="form-control"  [ngClass]="reloadLoanDetails == null ? 'required-input' : 'valid-input'">
                                    <option i18n  value="null">-- Select Facility --</option>
                                    <option  *ngFor="let x of proposedItems" [value]="x.loanApplicationDetailId">{{ x.approvedProductName }} -- {{ x.obligorName }}</option>
                                </select>
                            </div>

                            <!-- <div class="col-md-6">Proposed Amount: {{ customerProposedAmount | number : '1.2' }}</div> -->

                        </div>

                        <div *ngIf="showComponents" class="panel-body">
                            <app-disbursed-facility-detail [displayDetails]="loanSystemTypeId != 0 && loanSystemTypeId != 4" [LoadLoanDetails]="reloadLoanDetails" [loanSystemTypeId]="loanSystemTypeId" [customerId]="customerId"></app-disbursed-facility-detail>
                            <app-loan-application-details-view *ngIf="loanSystemTypeId == 4" [loanApplicationDetailId]="reloadLoanDetails"> </app-loan-application-details-view>
                        </div>
                    </div>

                    <p-accordion #accordion>
                        <p-accordionTab *ngIf="showComponents" [selected]="true" header="List of existing loans">
                            <expfacility [reload]="reload" [customer]="getCustomerIds()"></expfacility>
                        </p-accordionTab>
                        <p-accordionTab *ngIf="showComponents" header="List of Written-off Facilities">
                            <expcamsol [reload]="reload" [customer]="getCustomerIds()"></expcamsol>
                        </p-accordionTab>
                    </p-accordion>


                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Customer Financial Statement</h2>
                        </div>
                        <div *ngIf="showFinanceStatement ==false"> <button   pButton type="button" (click)="DisplayFinanceStatementComponent()" label="Show Finacial Statement" i18n-label class="ui-button-info pull-left"> </button></div>
                        <div *ngIf="showComponents && showFinanceStatement ==true" class="panel-body">
                            <app-customer-financial-statement [customerId]="application?.customerId" [viewCustomerFinancialStatement]="true" [canDoFinancialStatementEntry]="false"></app-customer-financial-statement>
                        </div>
                    </div>


                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Customer Rating</h2>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="col-md-2">
                                    <select [attr.disabled]="isAnalyst == false ? true : null" class="form-control" [(ngModel)]="riskRatingId">
                                        <option i18n  value="null">-- Select Ratings--</option>
                                        <option *ngFor="let x of ratings" [value]="x.riskRatingId">{{ x.riskRating }}</option>
                                    </select>
                                </div>
                                <div *ngIf="isAnalyst == true" class="col-md-3">
                                    <button i18n  (click)="saveCustomerRating()" class="btn btn-primary form-control"> Save and Validate Limit</button>
                                </div>
                                <div class="col-md-2">
                                    <span style="vertical-align:-5px;" *ngIf="obligorLimitValidated == true">
                                        <i class="glyphicon glyphicon-ok"></i>
                                    </span>
                                    <span style="vertical-align:-5px;" *ngIf="obligorLimitValidated == false">
                                        <i class="glyphicon glyphicon-remove"></i>
                                    </span>
                                </div>
                                <div>
                                    <b>Limit:</b> {{ limitValidation?.limit | number:'1.2'}}
                                    <b>Exposure:</b> {{ obligorExposure | number:'1.2'}}
                                    <b>Available Limit:</b> {{ (limitValidation?.limit - obligorExposure) | number:'1.2' }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Customer Account Statistics</h2>
                        </div>

                        <!-- <div class="panel-body">
                            <div class="form-group" class="col-md-12">
                                <div class="col-md-4">
                                    <select class="form-control" [(ngModel)]="applicationCustomerId">
                                        <option i18n  value="0">-- Select Customer --</option>
                                        <option *ngFor="let x of applicationCustomers" [value]="x.customerId">{{ x.fullName }}</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    
                                    <button i18n  (click)="getCustomerTurnover()" class="btn btn-primary">Load Customer Turnover</button>
                                    <button i18n  (click)="onCustomerChange()" class="btn btn-primary">Fetch Account Statistics</button>
                                </div>
                            </div>
                        </div> -->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h2 class="panel-title" i18n>Customer Account Statistics</h2>
                            </div>

                            <div class="panel-body">
                                <div class="form-group" class="col-md-12">
                                    <div class="col-md-4">
                                        <select class="form-control" [(ngModel)]="applicationCustomerId">
                                            <option i18n  value="0">-- Select Customer --</option>
                                            <option *ngFor="let x of applicationCustomers" [value]="x.customerId">{{ x.fullName }}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="searchItem" class="control-label col=md-2" i18n>
                                            Start Date
                                        </label>
                                            <p-calendar [(ngModel)]="startDate" dateFormat="dd-MM-yy" [monthNavigator]="true" [yearNavigator]="true"
                                                yearRange="2000:2050" [showIcon]="true">
                                            </p-calendar> 
                                    </div>
                                    <div class="col-md-3">
                                        <label for="searchItem" class="control-label col=md-2" i18n>
                                            End Date
                                        </label>
                                            <p-calendar [(ngModel)]="endDate" dateFormat="dd-MM-yy" [monthNavigator]="true" [yearNavigator]="true"
                                                yearRange="2000:2050" [showIcon]="true">
                                            </p-calendar> 
                                    </div>
                                    <div class="col-md-3">
                                        <button (click)="getCustomerTurnover()" class="btn btn-primary" i18n>
                                            Load Customer Turnover</button>
                                        <button (click)="onCustomerChange()" class="btn btn-primary" i18n>
                                            Fetch Customer Account Statistics</button>
                                    </div>
                                </div>

                               


                            </div>
                        </div>
                    </div>
                    <!-- SHARED COMPONENTS -->
                    <!-- <app-monitoring-triggers [callerId]="2" [reload]="reload" [isAnalyst]="isAnalyst" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-monitoring-triggers> -->
                    <div *ngIf="showAccountStatistics ==false"> <button  pButton type="button" (click)="showAccountStatistics = true" i18n-label label="Show Account Statistics" class="ui-button-info pull-left"> </button></div>
                    <div *ngIf="showComponents && showAccountStatistics">
                        <app-repayment-terms [callerId]="2" [reload]="reload" [isAnalyst]="isNotBusiness()" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems" (hasTerms)="scheduleTermsIsSet($event)"></app-repayment-terms>
                    </div>


                    <!-- <app-collateral-recommendation [callerId]="2" [reload]="reload" [isAnalyst]="true" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-collateral-recommendation> -->
                    <div *ngIf="showComponents ">
                        <app-loan-covenant [callerId]="2" [reload]="reload" [isAnalyst]="true" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-loan-covenant>
                    </div>

                    <!-- END SHARED COMPONENTS -->

                    <!-- <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Management Convey Memo</h2>
                        </div>
                        <div class="panel-body">
                            <p-dataTable [value]="proposedItems" [paginator]="true" [rows]="5">
                                <p-column i18n-header  field="obligorName" header="Facility"></p-column>
                                <p-column i18n-header  field="loanApplicationDetailId" header="loanApplicationDetailId"></p-column>
                                <p-column i18n-header  [style]="{'width':'100px'}">
                                    <ng-template pTemplate="header"></ng-template>
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        <a (click)="editManagementPosition(d)" href="javascript:void(0)">Edit</a>
                                    </ng-template>
                                </p-column>
                            </p-dataTable>
                        </div>
                    </div> -->



<!--

<div class="panel panel-default">
    <div class="panel-heading">
        <h2 i18n  class="panel-title">Existing Loans</h2>
    </div>
    <div class="panel-body">
        <button i18n  *ngIf="existingLoans.length == 0 && showSpinnerExistingLoans == false" (click)="getCustomerExistingLoans()" class="btn btn-default">
            Show Existing Loans
            <span class="glyphicon glyphicon-refresh"></span>
        </button>

        <div *ngIf="showSpinnerExistingLoans == true" class="little-spinner"></div>

        <div *ngIf="displayExistingLoans == true" class="row" style="padding:0 15px 0 15px;">

            <p-dataTable [value]="existingLoans" [responsive]="true">
                <p-column i18n-header  field="loanReferenceNumber" header="Loan Reference Number"></p-column>
                <p-column i18n-header  field="productName" header="Product" [style]="{'width': '200px'}"></p-column>
                <p-column i18n-header  field="equityContribution" header="Equity Contribution" [style]="{'text-align': 'right'}"></p-column>
                <p-column i18n-header  field="disburseDate" header="Date Disbursed">
                    <ng-template let-col let-loan="rowData" pTemplate="body">
                        {{loan[col.field] | date : 'dd/MM/yyyy' }}
                    </ng-template>
                </p-column>
                <p-column i18n-header  field="outstandingPrincipal" header="Oustanding Principal" [style]="{'text-align': 'right'}">
                    <ng-template let-col let-loan="rowData" pTemplate="body">
                        {{loan[col.field] | number : '1.2' }}
                    </ng-template>
                </p-column>
                <p-column i18n-header  field="approvedAmount" header="Amount Approved" [style]="{'text-align': 'right'}">
                    <ng-template let-col let-loan="rowData" pTemplate="body">
                        {{loan[col.field] | number : '1.2' }}
                    </ng-template>
                </p-column>
                <p-footerColumnGroup>
                    <p-row>
                        <p-column i18n-header  footer="Totals:" colspan="4"></p-column>
                        <p-column i18n-header  [footer]="existingExposure" [style]="{'text-align': 'right'}"></p-column>
                        <p-column i18n-header  [footer]="existingApproved" [style]="{'text-align': 'right'}"></p-column>
                    </p-row>
                </p-footerColumnGroup>
            </p-dataTable>
        </div>

    </div>
</div> -->

                    <!-- <app-workflow-routing
                        *ngIf="privilege.canEscalate == true"
                        [currentSelection]="workflowTarget"
                        [enableRouteOperation]="true"
                        [panelLabel]="'Re-route Workflow'"
                        [referenceNumber]="application?.referenceNumber"
                        [operationIds]="[46,71,79]"
                        (rerouted)="resetGrid($event)"
                    ></app-workflow-routing> -->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Application Status
                            </h2>
                        </div>
                        <form novalidate [formGroup]="loanApplicationTagsForm" autocomplete="off">
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">

                                        <div class="col-md-2">
                                            <div class="checkbox-container">
                                                <input formControlName="isProjectRelated" id="isProjectRelated"
                                                    type="checkbox">
                                            </div><label i18n  for="isProjectRelated" class="checkbox">Project Related</label>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="checkbox-container">
                                                <input formControlName="isOnLending" id="isOnLending"
                                                    type="checkbox">
                                            </div><label i18n  for="isOnLending" class="checkbox">On Lending</label>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="checkbox-container">
                                                <input formControlName="isInterventionFunds"
                                                    id="isInterventionFunds" type="checkbox">
                                            </div><label i18n  for="isInterventionFunds" class="checkbox">Intervention Funds</label>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="checkbox-container">
                                                <input formControlName="domiciliationNotInPlace"
                                                    id="domiciliationNotInPlace" type="checkbox">
                                            </div><label i18n  for="domiciliationNotInPlace" class="checkbox">Domiciliation is not in place</label>
                                        </div>
                                        <div class="col-md-2">
                                        <div class="checkbox-container">
                                            <input formControlName="withInstruction" id="withInstruction" type="checkbox">
                                        </div><label i18n  for="withInstruction" class="checkbox">Is With Instruction</label>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="checkbox-container">
                                            <input formControlName="isAgricRelated" id="isAgricRelated" type="checkbox">
                                        </div><label i18n  for="isAgricRelated" class="checkbox">Is Agric Related</label>
                                    </div>

                                    </div>
                                    <div class="form-group">
                                        <div class="col-md-2">
                                            <div class="checkbox-container">
                                                <input formControlName="isSyndicated" id="isSyndicated"
                                                    type="checkbox">
                                            </div><label for="isSyndicated" class="checkbox">Is Syndicated </label>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="panel-footer">
                            <div class="row">
                                <div class="col-md-12">
                                    <button i18n  type="button" (click)="saveLoanApplicationTags(loanApplicationTagsForm)"
                                        class="btn btn-success btn-xs pull-right">Save changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">Actions</h2>
                        </div>
                        <div class="panel-body">

                            <button  *ngIf="(((canForward() || trailCount > 1)) && userIsAccountOfficer != true) || showReferBackForPMU"
                                type="button" (click)="refer()" class="btn btn-primary"><span
                                    class="glyphicon glyphicon-chevron-left" style="padding-right:4px;"></span>
                                    <ng-container i18n> Refer Back</ng-container>
                                </button>

                            <button  *ngIf="!(!canForward() || privilege.canApprove)" type="button"
                                (click)="forward()" class="btn btn-success"><span
                                    class="glyphicon glyphicon-chevron-right" style="padding-right:4px;"></span>
                                    {{AcceptButtonText}}</button>

                                    <button   *ngIf="!(!canForward() || !privilege.canApprove) && !userIsAccountOfficer" type="button"
                                (click)="disapprove()" class="btn btn-danger"><span
                                    class="glyphicon glyphicon-remove" style="padding-right:4px;"></span>
                                    <ng-container i18n>Decline</ng-container>
                                    
                                </button>

                            <button  *ngIf="!(!canForward() || !privilege.canApprove)" type="button"
                                (click)="approve()" class="btn btn-success"><span class="glyphicon glyphicon-ok"
                                    style="padding-right:4px;"></span><span
                                    [innerHTML]="getApproveButtonLabel()"></span></button>

                            <button  *ngIf="privilege.canEscalate == true" type="button" (click)="escalate()"
                                class="btn btn-warning"><span class="glyphicon glyphicon-export"
                                    style="padding-right:4px;"></span><ng-container i18n>Escalate</ng-container></button>

                            <button  *ngIf="isBusiness" type="button" (click)="selectApprover()"
                                class="btn btn-default"><span class="glyphicon glyphicon-user"
                                    style="padding-right:4px;"></span> <ng-container i18n>Select Approver</ng-container> </button>

                            <button   *ngIf="selectedApprover != ''" type="button" class="btn btn-default"
                                style="border-color:transparent;"><i>{{selectedApprover}}</i></button>
                        </div>
                    </div>


                </p-tabPanel>

                <p-tabPanel i18n-header  header="Approval Memorandum" [disabled]="disableAppraisalMemorandumTab">
                    <!-- cam document -->
                    <div class="card no-padding">
                        <div class="panel panel-default">

                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-9">
                                        <form novalidate [formGroup]="documentSectionForm" autocomplete="off">

                                            <select (change)="onDocumentSectionChange($event.target.value)" formControlName="sectionId" name="sectionId" id="sectionId"
                                                class="form-control">
                                                <option i18n  value="">-- Select Document Section --</option>
                                                <option  *ngFor="let x of documentationSections" [value]="x.sectionId">{{ x.staffRoleName }} :: {{ x.title }}</option>
                                            </select>

                                        </form>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="pull-right">
                                            <button  (click)="previewDocumentation()" style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-file"></span><ng-container i18n>Preview</ng-container>
                                                </button>
                                                <button  *ngIf="this.isThirdPartyFacility == false" (click)="previewDocumentationLOS()" style="padding: 3px 6px 3px 6px;">
                                                    <span class="glyphicon glyphicon-file"></span><ng-container i18n> Preview Previous</ng-container>
                                                    </button>
                                            <button  (click)="previewDocumentation(true)" style="padding: 3px 6px 3px 6px;">
                                                <span class="glyphicon glyphicon-print"></span><ng-container i18n>Print</ng-container>
                                                </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- CAM -->
                            <div class="panel-body" style="min-height:350px;">
                                <CKEDITOR *ngIf="editMode" [content]="sectionContent" [height]="'100%'" (contentChange)="contentChange($event)"></CKEDITOR>
                                <div id="print-selected-section" *ngIf="!(editMode == true)" [innerHTML]="sectionContent"
                                    style="overflow:auto;height:320px"></div>
                                <div><i>{{ sectionDescription }}</i></div>
                            </div>

                            <div class="panel-footer">
                                <div class="row" style="padding-left:inherit;">
                                    <div class="col-md-12">
                                        <div class="form-horizontal">
                                            <div *ngIf="(application?.approvalStatusId != 2 && application?.approvalStatusId != 3)" class="form-group">

                                                <button  type="button" (click)="getDocumentTemplate(true)" class="btn btn-warning" [disabled]="disableLoadTemplateForPMU">
                                                    <span class="glyphicon glyphicon-plus" style="padding-right:4px;"></span> 
                                                    <ng-container i18n>Load Template</ng-container>
                                                </button>

                                                <button  [disabled]="selectedSectionIdIndex == null" type="button" (click)="nextSection(1)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-left" style="padding-right:4px;"></span></button>

                                                <button  [disabled]="selectedSectionIdIndex == null" type="button" (click)="nextSection(2)" class="btn btn-default">
                                                    <span class="glyphicon glyphicon-chevron-right" style="padding-right:4px;"></span>
                                                    <ng-container i18n>Next</ng-container>
                                                    
                                                </button>

                                                <button  [disabled]="!canForward() || !canEditDocument() || !editMode" type="button" (click)="saveSection(true)" [disabled]="disableLoadTemplateForPMU" class="btn btn-success"
                                                    style="margin-right:10px;">
                                                    <span class="glyphicon glyphicon-floppy-disk" style="padding-right:4px;"></span> <ng-container i18n>Save Changes</ng-container> </button>
                                                <button   [disabled]="(selectedSectionIdIndex == null || editMode == true)" type="button" (click)="printSelectedSection()"
                                                    class="btn btn-success" style="margin-right:10px;">
                                                    <span class="" style="padding-right:4px;"></span><ng-container i18n>Print Section</ng-container></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                    <!-- endof cam document 1 -->
                    <!-- <pre>{{documentationSections | json}}</pre> -->

                </p-tabPanel>

                <p-tabPanel i18n-header  *ngIf="showComponents" header="Supporting Documents" [disabled]="disableSupportingDocumentsTab">
                    <!-- OPERATION_ID <app-document-upload [reload]="reload" [databaseTable]="8" [applicationId]="application?.loanReviewApplicationId" [referenceNumber]="application?.referenceNumber"></app-document-upload> -->
                    <div *ngIf="showFinanceStatement ==false"> <button  pButton type="button" (click)="showFinanceStatement = true" i18n-label label="Show Document Upload" class="ui-button-info pull-left"> </button></div>
                    <div>

                    </div>
                    <document-upload [reload]="reload" [operationId]="application?.operationId" [customerId]="application?.customerId"
                        [customerGroupId]="application?.customerGroupId"
                        [targetId]="application?.loanReviewApplicationId"
                        [isOperationSpecific]="false" [isLms]="true"
                        (requiredDocumentsUploadSatisfied)="setrequiredUploadValue($event)"
                        [targetReferenceNumber]="application?.relatedReferenceNumber == null ? application?.referenceNumber : application?.relatedReferenceNumber">
                    </document-upload>
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Comments" [disabled]="disableApplicationInformationTab">
                    <div *ngIf="showComponents" class="panel panel-default">
                        <app-approval-comments [operationId]="OPERATION_ID" [reviewApplicationId]="application?.loanReviewApplicationId" (trailCount)="setTrailCount($event)"></app-approval-comments>
                    </div>
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Conditions" [disabled]="disableConditionsTab || application?.operationId == 79">
                    <div class="panel panel-default">
                        <!-- default -->
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2   class="panel-title pull-left">
                                        <ng-container> Conditions </ng-container> <small>- {{ application.referenceNumber }}</small>
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <!-- <app-credit-condition  [callerId]="2" [isAnalyst]="isAnalyst == true" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-credit-condition> -->
                        <!-- <div > <button i18n  pButton type="button" (click)="showCreditCondition = true" label="Show Credit" class="ui-button-info pull-left"> </button></div> -->
                       <div *ngIf="showComponents "><app-credit-condition [operation]="application?.operationId"  [callerId]="2" [isAnalyst]="isAnalyst == true" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-credit-condition></div> 
                    </div>
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Transaction Dynamics" [disabled]="disableConditionsTab || application?.operationId == 79">
                    <div class="panel panel-default">
                        <!-- default -->
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h2  class="panel-title pull-left">
                                        <ng-container i18n>Transaction Dynamics </ng-container> <small>- {{ application.referenceNumber }}</small>
                                    </h2>
                                </div>
                            </div>
                        </div>
<!--
                        <app-transaction-dynamics [callerId]="2" [isAnalyst]="isAnalyst == true" [applicationId]="application?.loanReviewApplicationId"
                            [proposedItems]="proposedItems"></app-transaction-dynamics>
                 -->
                 <app-transaction-dynamics [operation]="application?.operationId" [callerId]="2" [isAnalyst]="isAnalyst == true" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-transaction-dynamics>
                    </div>
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Collateral Information" [disabled]="disableSupportingDocumentsTab">
                    <div *ngIf="showCollateral ==false"> <button  pButton type="button" (click)="DisplayCollateralComponent()" i18n-label label="Show Collateral" class="ui-button-info pull-left"> </button></div>
                    <div *ngIf="showComponents && showCollateral" style="padding: 15px 0px 15px 0px">
                        <!-- (proceedEvent)="refreshCollateral()" -->
                        <collateral-information
                            [applicationId]="application?.loanApplicationId == null ? loanApplicationIds : application?.loanApplicationId"
                            [loanApplicationId]="application?.loanApplicationId == null ? loanApplicationIds : application?.loanApplicationId"
                            [customerGroupId]="application?.customerGroupId" [loanTypeId]="application?.loanTypeId"
                            [isRegistrationDoneViaLoanApplication]="isRegistrationDoneViaLoanApplication"
                            [applicationCustomerId]="application?.customerId" [showCustomerCollaterals]="true"
                            [applicationCustomerName]="application?.customerName" [currencyId]="application?.currencyId"
                            [reloadCustomerCollateral]="reload" [autoMapNew]="true" [collateralAtAppraisal]="true"
                            [loadResourceByDefault]="false"
                            (proceedEvent)="refreshCollateral()"
                            [hideCreateButton]="false" [canEditExternally]="false" [selectedModule]="1">
                        </collateral-information>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">

                                <div class="col-md-12">
                                    <h2  class="panel-title pull-left">
                                        <ng-container i18n>Proposed Collaterals</ng-container> <b [innerHtml]="getCollateralCoverageStatus()"></b>
                                    </h2>
                                </div>
                            </div>
                        </div>

                        <div class="panel-body coll-list">
                            <p-dataTable [value]="proposedCollateral" [paginator]="true" [rows]="3">
                                <p-column i18n-header  field="collateralCode" header="Collateral Code" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header  field="collateralOwnerName" header="Collateral Owner"
                                    filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header  field="productName" header="Product Name" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header  field="customerName" header="Obligor Name" filterMatchMode="contains">
                                </p-column>
                                <p-column i18n-header  field="facilityAmount" header="Propose Facility Amount"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.facilityAmount | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="availableCollateralValue" header="Available Collateral Value"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.baseCurrencyCode}} {{ d.availableCollateralValue | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="expectedCoveragePercentage" header="Expected Collateral Coverage (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.expectedCoveragePercentage }} %
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="expectedCollateralCoverage" header="Expected Coverage"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.expectedCollateralCoverage | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="actualCollateralCoverage" header="Actual Coverage"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{d.facilityCurrencyCode}} {{ d.actualCollateralCoverage | number : '1.2' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="actualCoveragePercentage" header="Actual Collateral Coverage (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.actualCoveragePercentage }} %
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="totalCoverage" header="Total Facility Coverage Achieved (%)"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.totalCoverage }} %
                                    </ng-template>
                                </p-column>

                            </p-dataTable>
                        </div>
                    </div>
                    <!-- ======== end ======== -->
                </p-tabPanel>

                <p-tabPanel i18n-header  header="Monitoring Triggers" [disabled]="disableTriggersTab || application?.operationId == 79" *ngIf="isAnalyst">

                    <!-- <div class="panel-body">
                    <div class="col-md-6">
                        <select (change)="onFacilityChange($event.target.value)" class="form-control" [ngClass]="reloadLoanDetails == null ? 'required-input' : 'valid-input'">
                            <option i18n  value="null">-- Select Facility--</option>
                            <option i18n  *ngFor="let x of proposedItems" [value]="x.loanApplicationDetailId">{{ x.approvedProductName }} -- {{ x.obligorName
                                }}</option>
                        </select>
                    </div>
                    </div> -->

                    <app-monitoring-triggers [callerId]="2" [reload]="reload" [isAnalyst]="isAnalyst" [applicationId]="application?.loanReviewApplicationId" [proposedItems]="proposedItems"></app-monitoring-triggers>

                </p-tabPanel>

                <p-tabPanel i18n-header  *ngIf="application != null && showComponents == true" header="Job Requests" [disabled]="loanApplicationDetailId == undefined || loanApplicationDetailId == null">
                    <div *ngIf="loanApplicationDetailId != null && loanApplicationDetailId != undefined">
                        <job-request-template
                            [hideCloseButton]=true
                            [operationAvailable]=true
                            [targetId]="loanApplicationDetailId"
                            [jobSourceId]= jobSourceId
                            [moduleReferenceNumber]="loanApplicationDetail?.applicationReferenceNumber"
                            [operationsId]="OPERATION_ID"
                            [isApplicationLevel]="false"
                            [useFacilityDropdownToDetermineTarget]="false"
                            [facilityList]="proposedItems">
                        </job-request-template>

                        <!-- <job-request-template [targetId]=loanApplId [operationAvailable]="true" [moduleReferenceNumber]=selectedApplicationReferenceNumber
                            [operationsId]=loanApplOperationId (displayOption)="CallRequestClose()">
                        </job-request-template> -->
                    </div>
                </p-tabPanel>

            </p-tabView>
        </div>
    </div>
</div>

<!-- MODALS -->


<!--append modal-->
<p-dialog [responsive]=true [(visible)]="displayAppendModal" id="append-modal" modal="modal" showEffect="fade" width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n  class="panel-title">Load Document Template</h2>
            <div class="pull-right">
                <a class="close" (click)="displayAppendModal=false">&times;</a>
            </div>
        </div>

        <form novalidate [formGroup]="appendForm" autocomplete="off">

            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n  for="creditTemplateId" class="control-label col-md-4">Document Template</label>
                        <div class="col-md-8">
                            <select name="creditTemplateId" id="creditTemplateId" formControlName="creditTemplateId" class="form-control" [ngClass]="appendForm.controls['creditTemplateId'].valid ? 'valid-input' : 'required-input'">
                                <option i18n  value="">-- Select Document Template --</option>
                                <option  *ngFor="let x of documentTemplates" [value]="x.templateId">{{ x.templateName }}</option>
                            </select>
                        </div>
                    </div>

                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button i18n  type="button" (click)="loadDocumentTemplate(appendForm)" [disabled]="appendForm.invalid" class="btn btn-warning pull-right">Load Document</button>
                    </div>
                </div>
            </div>

        </form>

    </div>
</p-dialog>
<!--end of append modal-->




<!--modal for all documentation -->

<p-dialog [responsive]=true [(visible)]="displayDocumentation" [contentStyle]="{'overflow':'visible','max-height': '90vh','overflow-y': 'scroll'}" [styleClass]="'padding-bottom-xl'"
  [draggable]="false" appendToBody="true"
    modal="modal" showEffect="fade" width="1200">
    <div *ngIf="displayDocumentation" style="margin-bottom:0" style="min-height:100vh; height:100vh;" class="panel panel-default">

        <div class="panel-heading">
            <h2   class="panel-title">
                <ng-container i18n> Appraisal Documentation for REFERENCE:</ng-container>
                <strong>{{ application?.applicationReferenceNumber }}</strong> of OBLIGOR:
                <strong>{{ application?.customerName }}</strong>
            </h2>
            <div class="pull-right">
                <a class="close" (click)="closeDocumentation()">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="overflow:auto;height:100vh">
            <div *ngFor="let x of documentations">
                <p><strong>{{x.title}}</strong></p>
                <span [innerHtml]="x.templateDocument"></span>
            </div>
        </div>

    </div>
</p-dialog>

<!--modal ends-->



<!--terms form modal-->
<!-- <p-dialog [responsive]=true [(visible)]="displayCommentForm" id="terms-modal" modal="modal" showEffect="fade" width="450">

    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n  class="panel-title">{{ commentTitle }}</h2>
        </div>

        <form novalidate [formGroup]="commentForm" autocomplete="off">

            <div class="panel-body">
                <div class="form-horizontal">

                    <div *ngIf="forwardAction == 5" class="form-group">
                        <label i18n  for="staffName" class="col-md-12">Target Level / Staff</label>
                        <div class="col-md-12">
                            <select (change)="onTargetStaffLevelChange($event.target.value)" type="text" name="trailId" formControlName="trailId" id="trailId"
                                class="form-control" [ngClass]="!commentForm.controls['trailId'].valid ? 'required-input' : 'valid-input'">
                                <option i18n  value="">-- Select Staff / Level --</option>
                                <option i18n  *ngFor="let x of backtrail" [value]="x.approvalTrailId">{{ x.fromApprovalLevelName }} -- {{ x.staffName }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-12">
                            <label i18n  for="comment">Comment</label>
                        </div>
                        <div class="col-md-12">
                            <textarea style="height:87px;" name="comment" formControlName="comment" id="comment" class="form-control" [ngClass]="!commentForm.controls['comment'].valid ? 'required-input' : 'valid-input'"></textarea>
                        </div>
                    </div>

                    <div class="form-group" *ngIf="isBusiness === false && forwardAction !== 5">
                        <label i18n  for="" class="col-md-12">Decision</label>
                        <div class="col-md-6">
                            <select name="vote" formControlName="vote" [ngClass]="!commentForm.controls['vote'].valid ? 'required-input' : 'valid-input'"
                                id="vote" class="form-control">
                                <option i18n  value="">-- Select Decision --</option>
                                <option i18n  value="1">No</option>
                                <option i18n  value="2">Yes</option>
                                <option i18n  *ngIf="isBoard == true" value="3">No with condition</option>
                                <option i18n  *ngIf="isBoard == false" value="4">Yes with condition</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <div *ngIf="errorMessage.length > 0" class="alert alert-danger col-md-12" role="alert">
                            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <span class="sr-only">Error: </span>{{ errorMessage }}
                        </div>
                    </div>

                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button  type="button" (click)="forwardCam(commentForm)" [disabled]="commentForm.invalid" class="btn btn-success pull-right">
                            <span class="glyphicon glyphicon-send" style="padding-right:4px;"></span> <ng-container i18n>Save and Send</ng-container></button>
                        <button i18n  type="button" (click)="cancelForm()" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button>
                    </div>
                </div>
            </div>

        </form>

    </div>
</p-dialog> -->
<!--end of form modal-->


<!--comment form modal-->

<p-dialog [responsive]=true [(visible)]="displayCommentForm" id="comment-modal" modal="modal" showEffect="fade"
    width="1200" [contentStyle]="{'overflow':'auto','max-height':'700px'}">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 class="panel-title">
                {{ commentTitle }}

            </h2>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="panel-body">

                    <div *ngIf="warningMessage != ''" class="alert alert-danger">
                        <strong i18n>Warning!</strong> {{ warningMessage }}
                    </div>

                    <div style="display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700;"><ng-container i18n>Loans -</ng-container>
                    
                        <small i18n>Select facility to review</small>
                    </div>

                    <p-dataTable [value]="proposedItems" [paginator]="true" [rows]="5" selectionMode="single" (onRowSelect)="onLineRowSelect($event.data)">

                        <p-column i18n-header  field="obligorName" header="Customer Name"></p-column>
                        <p-column i18n-header  field="approvedProductName" header="Product Name"></p-column>
                        <p-column i18n-header  field="operationName" header="Operation"></p-column>
                        <p-column i18n-header  field="reviewDetails" header="Review Details"></p-column>

                        <p-column i18n-header  *ngIf="canSupport()" field="statusId" header="Status" [style]="{'color':'#555','text-align':'center','width':'150px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <select (change)="onLineItemChange(5,$event.target.value,d.loanApplicationDetailId)">
                                    <option i18n  *ngIf="d.statusId != 2 && d.statusId != 3" value="">-- Select Status --</option>
                                    <option  *ngIf="d.statusId != 3" value="3">
                                        <small i18n>Not Supported</small>
                                    </option>
                                    <option   *ngIf="d.statusId != 2" value="2">
                                        <ng-container><small i18n>Not Supported</small></ng-container>
                                    </option>
                                    <option   *ngIf="d.statusId == 3" value="3" selected="selected">
                                        <ng-container ><small i18n>Not Supported</small></ng-container>
                                    </option>
                                    <option   *ngIf="d.statusId == 2" value="2" selected="selected">
                                        <small i18n>Supported</small>
                                    </option>
                                </select>
                            </ng-template>
                        </p-column>

                        <p-column i18n-header  field="statusId" header="" [style]="{'text-align':'right','width':'30px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="d.statusId == 2">
                                    <i class="glyphicon glyphicon-ok"></i>
                                </span>
                                <span *ngIf="d.statusId == 3">
                                    <i class="glyphicon glyphicon-remove"></i>
                                </span>
                            </ng-template>
                        </p-column>


                        <p-column i18n-header  field="loanApplicationDetailId" header="" [style]="{'text-align':'right','width':'25px'}">
                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                <span *ngIf="touchedLineItems.indexOf(d.loanApplicationDetailId) > -1">*</span>
                            </ng-template>
                        </p-column>

                    </p-dataTable>

                </div>
            </div>
        </div>

        <form novalidate [formGroup]="commentForm" autocomplete="off">
                <div class="col-md-5" style="background-color:#F5F5F5;border-left:solid 1px #ccc;">
                    <div class="panel-body">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <div *ngIf="errorMessage.length > 0" class="alert alert-danger col-md-12" role="alert"
                                    style="margin: 0 15px 0 15px;width: -webkit-fill-available;">
                                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                    <span class="sr-only">Error: </span>{{ errorMessage }}
                                </div>
                            </div>
                            <div *ngIf="forwardAction == 5" class="form-group">
                                <label i18n  for="staffName" class="col-md-12">Target Level / Staff</label>
                                <div class="col-md-12">

                                    <select (change)="onTargetStaffLevelChange($event.target.value)" type="text" name="trailId" formControlName="trailId" id="trailId"
                                        class="form-control" [ngClass]="!commentForm.controls['trailId'].valid ? 'required-input' : 'valid-input'">
                                        <option i18n  value="">-- Select Staff / Level --</option>
                                        <option *ngFor="let x of backtrail" [value]="x.approvalTrailId">{{ x.fromApprovalLevelName }} -- {{ x.staffName }}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-md-12">
                                    <label i18n  for="comment">Comment/Recommendation</label>
                                </div>
                                <div class="col-md-12">
                                    <textarea style="height:87px;" name="comment" formControlName="comment" id="comment" class="form-control" [ngClass]="!commentForm.controls['comment'].valid ? 'required-input' : 'valid-input'"></textarea>
                                </div>
                            </div>

                            <div class="form-group" *ngIf="isBusiness == false && forwardAction != 5">
                                <label i18n  for="" class="col-md-12">Decision</label>
                                <div class="col-md-6">
                                    <select name="vote" formControlName="vote" [ngClass]="!commentForm.controls['vote'].valid ? 'required-input' : 'valid-input'"
                                        id="vote" class="form-control">
                                        <option i18n  value="">-- Select Decision --</option>
                                        <option i18n  value="1">No</option>
                                        <option i18n  value="2">Yes</option>
                                        <option i18n  *ngIf="isBoard == true" value="3">No with condition</option>
                                        <option i18n  *ngIf="isBoard == false" value="4">Yes with condition</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="forwardCam(commentForm)" [disabled]="commentForm.invalid" class="btn btn-success pull-right">
                        <span class="glyphicon glyphicon-send" style="padding-right:4px;"></span>
                        <ng-container i18n>Save and Send</ng-container>
                        
                    </button>
                    <button i18n  type="button" (click)="cancelForm()" style="margin-right:5px" class="btn btn-danger pull-right">Cancel</button>
                </div>
            </div>
        </div>

        <!-- <div>{{commentForm.value | json}}</div> -->

    </div>

</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayManagementPositionForm" id="terms-modal" modal="modal" showEffect="fade"
    width="900">

    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n  class="panel-title">Management Convey Memo</h2>
        </div>

        <div class="panel-body">
            <div class="form-horizontal">

                <div class="form-group">
                    <div class="col-md-12">
                        <p-editor [(ngModel)]="managementPosition" [style]="{'height':'320px'}">
                            <p-header>
                                <span class="ql-formats">
                                <select class="ql-header">
                                <option value="1" i18n>Heading</option>
                                <option  value="2" i18n>Subheading</option>
                                <option  selected i18n>Normal</option>
                                </select>
                                <select class="ql-font">
                                <option selected i18n>Sans Serif</option>
                                <option value="serif" i18n>Serif</option>
                                <option value="monospace" i18n>Monospace</option>
                                </select>
                                </span>
                                <span class="ql-formats">
                                <button class="ql-bold" aria-label="Bold"></button>
                                <button class="ql-italic" aria-label="Italic"></button>
                                <button  class="ql-underline" aria-label="Underline"></button>
                                </span>
                                <span class="ql-formats">
                                <select class="ql-color"></select>
                                <select class="ql-background"></select>
                                </span>
                                <span class="ql-formats">
                                <button  class="ql-list" value="ordered" aria-label="Ordered List"></button>
                                <button  class="ql-list" value="bullet" aria-label="Unordered List"></button>
                                <select class="ql-align">
                                <option  selected></option>
                                <option  value="center"></option>
                                <option  value="right"></option>
                                <option  value="justify"></option>
                                </select>
                                </span>
                                <span class="ql-formats">
                                <button  class="ql-link" aria-label="Insert Link"></button>
                                <button  class="ql-code-block" aria-label="Insert Code Block"></button>
                                </span>
                                <span class="ql-formats">
                                <button  class="ql-clean" aria-label="Remove Style"></button>
                                </span>
                            </p-header>
                        </p-editor>
                    </div>
                </div>

            </div>
        </div>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button i18n  type="button" (click)="saveManagementPosition()" [disabled]="managementPosition == null" class="btn btn-success pull-right">
                        Save and Close</button>
                    <button i18n  type="button" (click)="displayManagementPositionForm=false" style="margin-right:5px" class="btn btn-danger pull-right">
                        Cancel</button>
                </div>
            </div>
        </div>

    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayPageFour" [contentStyle]="{'overflow':'auto','max-height':'600px'}"
    modal="modal" showEffect="fade" width="1000">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n  class="panel-title">Account Statistics</h2>
        </div>
        <!-- <div class="panel-body">
            <div class="form-group col-md-12">
                <!-- <div class="col-md-6"> 
                <div class="form-group">
                    <label i18n  class="control-label col-md-2">From:</label>
                    <div class="col-md-2">
                        <select name="fromMonth" [(ngModel)]="fromMonth" id="fromMonth" class="form-control">
                            <option i18n  value="0">--Select Month--</option>
                            <option i18n  value="1">Jan</option>
                            <option i18n  value="2">Feb</option>
                            <option i18n  value="3">Mar</option>
                            <option i18n  value="4">Apr</option>
                            <option i18n  value="5">May</option>
                            <option i18n  value="6">Jun</option>
                            <option i18n  value="7">Jul</option>
                            <option i18n  value="8">Aug</option>
                            <option i18n  value="9">Sep</option>
                            <option i18n  value="10">Oct</option>
                            <option i18n  value="11">Nov</option>
                            <option i18n  value="12">Dec</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="number" maxlength="4" minlength="0" min="2000" name="fromYear" id="fromYear"
                            placeholder="Year" [(ngModel)]="fromYear" class="form-control">
                    </div>
                </div>
                <!-- </div> -->
                <!-- <div class="col-md-6"> --
                <div class="form-group">
                    <label i18n  class="control-label col-md-2">Accounts</label>
                    <div class="col-md-4">
                        <select name="account" [(ngModel)]="account" id="account" class="form-control">
                            <option i18n  value="0">-- Filter By Selected Account --</option>
                            <option  *ngFor="let x of accounts" [value]="x.accountNumber">{{ x.accountNumber }}</option>
                        </select>
                    </div>
                    <!-- <div class="col-md-6"></div> --
                </div>
                <!-- </div> --

            </div>
            <div class="form-group col-md-12">
                <!-- <div class="col-md-6"> --
                <div class="form-group">
                    <label i18n  class="control-label col-md-2">To:</label>
                    <div class="col-md-2">
                        <select name="toMonth" [(ngModel)]="toMonth" id="toMonth" class="form-control">
                            <option i18n  value="0">--Select Month--</option>
                            <option i18n  value="1">Jan</option>
                            <option i18n  value="2">Feb</option>
                            <option i18n  value="3">Mar</option>
                            <option i18n  value="4">Apr</option>
                            <option i18n  value="5">May</option>
                            <option i18n  value="6">Jun</option>
                            <option i18n  value="7">Jul</option>
                            <option i18n  value="8">Aug</option>
                            <option i18n  value="9">Sep</option>
                            <option i18n  value="10">Oct</option>
                            <option i18n  value="11">Nov</option>
                            <option i18n  value="12">Dec</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="number" maxlength="4" minlength="0" min="2000" name="toYear" id="toYear" placeholder="Year"
                            [(ngModel)]="toYear" class="form-control">
                    </div>
                </div>
                <!-- </div> -->
                <!-- <div class="col-md-6"></div> --
            </div>

            <!-- <div class="col-md-2 col-md-offset-10">
                        <button i18n  type="button" (click)="filter()" class="btn btn-success btn-block">Filter</button>
                    </div> --
        </div> -->
        <!-- <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button i18n  type="button" (click)="filter()" class="btn btn-md btn-success pull-right">Filter</button>
                </div>
            </div>
        </div> -->

        <p-tabView>
            <p-tabPanel i18n-header  header="Turnover Details">
                <div class="panel-body">
                        <p-dataTable [value]="firstTransaction" #dt [paginator]="true" [rows]="10" [rowsPerPageOptions]="[15,20,30]" selectionMode="single">
                                <p-header>
                                        <div class="ui-helper-clearfix">
                                            <button type="button" pButton icon="fa-file-o" iconPos="left" i18n-label label="Export to CSV" (click)="dt.exportCSV()" style="float:left"></button>
                                        </div>
                                    </p-header>
                            <p-column i18n-header  field="accountNumber" [filter]="true" filterMatchMode="contains" header="Account Number"></p-column>
                            <p-column i18n-header  field="productName" header="Account Type"></p-column>
                            <!-- <p-column i18n-header  field="period" header="Period"></p-column> -->

                            <p-column i18n-header  field="max_Debit_Balance" header="Highest Debit Balance" [filter]="false"
                                filterMatchMode="contains" [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.max_Debit_Balance | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="min_Debit_Balance" header="Lowest Debit Balance" [filter]="false"
                                filterMatchMode="contains" [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.min_Debit_Balance | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="max_Credit_Balance" header="Highest Credit Balance" [filter]="false"
                                filterMatchMode="contains" [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.max_Credit_Balance | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="min_Credit_Balance" header="Lowest Credit Balance" [filter]="false"
                                filterMatchMode="contains" [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.min_Credit_Balance | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="debit_Turnover" header="Debit Turn Over" [filter]="false" filterMatchMode="contains"
                                [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.debit_Turnover | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="credit_Turnover" header="Credit Turn Over" [filter]="false" filterMatchMode="contains"
                                [style]="{'text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.credit_Turnover | number : '1.2' }}
                                </ng-template>
                            </p-column>

                        </p-dataTable>
                </div>
            </p-tabPanel>
            <p-tabPanel i18n-header  header="Revenue Item">
                <div class="panel-body">
                        <p-dataTable [value]="secondTransaction" #ds [paginator]="true" [rows]="10" [rowsPerPageOptions]="[15,20,30]" selectionMode="single">
                                <p-header>
                                        <div class="ui-helper-clearfix">
                                            <button type="button" pButton icon="fa-file-o" iconPos="left" i18n-label label="Export to CSV" (click)="ds.exportCSV()" style="float:left"></button>
                                        </div>
                                    </p-header>
                            <p-column i18n-header  field="accountNumber" [filter]="true" filterMatchMode="contains" header="Account Number"></p-column>
                            <!-- <p-column i18n-header  field="productName" header="Account Type"></p-column> -->
                            <p-column i18n-header  field="period" header="Period"></p-column>

                            <p-column i18n-header  field="float_Charge" header="Amount" [filter]="false" filterMatchMode="contains"
                                [style]="{'width':'120px','text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.float_Charge | number : '1.2' }}
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  field="interest" header="Interest" [filter]="false" filterMatchMode="contains"
                                [style]="{'width':'180px','text-align':'right'}">
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    {{ d.interest | number : '1.2' }}
                                </ng-template>
                            </p-column>

                        </p-dataTable>
                </div>
            </p-tabPanel>
        </p-tabView>
    </div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12">
                <button i18n  type="button" (click)="displayPageFour=false" style="margin-right:5px" class="btn btn-danger pull-right">Close</button>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayApproverSearchForm" modal="modal" id="searchModal" showEffect="fade"
    width="650">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <div style="margin-left:0" class="row">
                <h2 i18n  class="panel-title pull-left">
                    Search Staff
                </h2>
                <div class="pull-right">
                    <a class="close" style="margin: -10px 8px;" (click)="displayApproverSearchForm=false;nextLevelId = 0">&times;</a>
                </div>
            </div>
        </div>
        <div style="padding:3px" class="panel-body">
            <div class="form-group">
                <div class="col-md-12">
                    <input type="text" id="search" #approvalInPut (keyup)="searchApprover($event.target.value)"
                        class="form-control" placeholder="Type in the staff name...">

                    <!-- <input type="text" id="search" #approvalInPut class="form-control"
                        placeholder="Type in the staff name..."> -->
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-12">
                    <p>
                        <!--{{mfacilityType}}-->
                    </p>
                    <table *ngIf="availableApprovers" class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th i18n>Staff Code</th>
                                <th i18n>First Name</th>
                                <th i18n>Middle Name</th>
                                <th i18n>Last Name</th>
                                <th i18n>Staff Role</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr (click)="pickSearchedApprover(res)" style="cursor: pointer"
                                *ngFor="let res of availableApprovers; let i = index">
                                <td>{{res.staffCode}}</td>
                                <td>{{res.firstName}}</td>
                                <td>{{res.secondName}}</td>
                                <td>{{res.lastName}}</td>
                                <td>{{res.staffRoleName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</p-dialog>



<scroll-to-top-button></scroll-to-top-button>

<!-- <pre>{{ application.applicationDetails | json }}</pre> -->

<!--end of form modal-->

<!-- CAM: {{camDocument}} -->
<!--
PRIVI: <pre>{{ privilege | json }}</pre> -->

<!-- <pre>{{ application | json }}</pre> -->

<!--
<pre>isBusiness: {{ isBusiness }}</pre>
<pre>isAnalyst: {{ isAnalyst }}</pre> -->
<!-- <pre>{{ documentations | json }}</pre> -->