<div class="ui-g">
    <div class="ui-g-12 no-padding">
        <div class="card no-padding">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-12">
                            <h2 i18n  class="panel-title pull-left">
                                List of Written-off Loans
                            </h2>
                        </div>
                    </div>
                </div>
                <div class="panel-body">
                    <p-dataTable #dt [paginator]="true" [rows]="15" [value]="loanOperationApprovalData" [responsive]=true selectionMode="single" [(selection)]="loanSelection" (onRowSelect)="onSelectedLoanChange()">
                        <p-header>
                            <div class="ui-helper-clearfix">
                                <button  type="button" pButton icon="fa-file-o" iconPos="left" i18n-label i18n-label label="Export to CSV" (click)="dt.exportCSV()" style="float:left"></button>
                            </div>
                        </p-header>
                        <p-column i18n-header  field="lmsrApplicationReferenceNumber" header="Application Ref." sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  field="customerName" header="Customer Name" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  field="casaAccount" header="Account Number" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  field="relationshipManagerName" header="Relationship Manager" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  field="operationTypeName" header="Operation Type" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                        <p-column i18n-header  field="newEffectiveDate" header="Effective Date" sortable="false" [filter]="false" filterMatchMode="contains">
                            <ng-template let-col let-ln="rowData" pTemplate="body">
                                {{ln[col.field] | date : 'dd/MM/yyyy' }}
                            </ng-template>
                        </p-column>
                        <p-column i18n-header  [style]="{'width':'95px', 'text-align':'center'}">
                            <ng-template pTemplate="header">
                                View
                            </ng-template>
                            <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                <button type="button" (click)="viewLoanDetails(row, $event)">
                                  <i class="glyphicon glyphicon-eye-open"></i>
                              </button>

                            </ng-template>
                        </p-column>

                        <!-- <p-column i18n-header  [style]="{'width':'95px', 'text-align':'center'}">
                        <ng-template pTemplate="header">
                            Initiate Loan Recovery
                        </ng-template>
                        <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                            <button i18n  type="button" (click)="loanRecovery()">
                                <i class="glyphicon glyphicon-pencil"></i>
                            </button>
                            
                        </ng-template>
                    </p-column> -->
                    </p-dataTable>
                </div>
            </div>
        </div>
    </div>
</div>

<p-dialog [responsive]=true [(visible)]="showApplicationForm" id="add-modal" modal="modal" showEffect="fade" width="900">

    <div style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2 i18n  class="panel-title"> New Application </h2>
        </div>

        <p-tabView>
            <p-tabPanel i18n-header  header="Application Form">
                <form novalidate [formGroup]="applicationForm" autocomplete="off">

                    <div class="panel-body">
                        <div class="form-horizontal">

                            <div class="form-group">
                                <label i18n  class="control-label col-md-6">Activity type</label>
                                <label i18n  class="control-label col-md-3">.</label>
                                <div class="col-md-6">
                                    <select (change)="onChangeSelectedOperationType($event.target.value)" name="operationTypeId" formControlName="operationTypeId" id="operationTypeId" class="form-control" [ngClass]="applicationForm.controls['operationTypeId'].valid ? 'valid-input' : 'required-input'">
                                        <option i18n  [value]="0">-- Select Activity Type --</option>
                                        <option  *ngFor="let pc of remedialOperationTypes" value="{{pc.operationTypeId}}">
                                            {{pc.operationTypeName}}
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <button   style="width:100%;" (click)="validateSubAllocationTranche(applicationForm)" [disabled]="applicationForm.invalid" class="btn btn-primary form-control">
                                        <i class="glyphicon glyphicon-plus"></i> <ng-container i18n>Add</ng-container>
                                    </button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label i18n  for="reviewDetails" class="control-label col-md-8">Review Details</label>
                                <label i18n  for="duration" class="control-label col-md-4" *ngIf="showDuration">Duration</label>
                                <div class="col-md-8">
                                    <textarea style="height:50px;" name="reviewDetails" formControlName="reviewDetails" id="reviewDetails" class="form-control" [ngClass]="applicationForm.controls['reviewDetails'].valid ? 'valid-input' : 'required-input'"></textarea>
                                </div>
                                <div class="col-md-4" *ngIf="showDuration">
                                    <input type="text" name="duration" formControlName="duration" id="duration" class="form-control" min="10" max="90" [ngClass]="applicationForm.controls['duration'].valid ? 'valid-input' : 'required-input'">

                                </div>
                            </div>

                        </div>

                        <p-dataTable [value]="applicationCollection" [paginator]="true" [rows]="5" [(selection)]="loanSelection" dataKey="id" (onRowSelect)="onSelectedLoanChange()">
                            <p-column i18n-header  field="operationType" header="Operation Type" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header  field="reviewDetails" header="Review Details" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            <p-column i18n-header  [style]="{'width':'60px'}">
                                <ng-template pTemplate="header"></ng-template>
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    <div style="text-align:center">
                                        <a i18n (click)="editApplication(d)" href="javascript:void(0)">Edit</a>
                                    </div>
                                </ng-template>
                            </p-column>

                            <p-column i18n-header  [style]="{'width':'60px'}">
                                <ng-template pTemplate="header"></ng-template>
                                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                    <div style="text-align:center">
                                        <a i18n (click)="removeApplicationCollection(d)" href="javascript:void(0)">Remove</a>
                                    </div>
                                </ng-template>
                            </p-column>
                        </p-dataTable>

                    </div>

                </form>
            </p-tabPanel>
        </p-tabView>

        <form [formGroup]="regionForm" autocomplete="off">
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button i18n  type="button" (click)="submitForm(regionForm)" [disabled]="(applicationCollection.length < 1 || applicationCollection.length >1)  || regionForm.invalid" class="btn btn-success pull-right">Submit Application</button>
                        <button i18n  type="button" (click)="closeForm()" style="margin-right:5px" class="btn btn-primary pull-right">Close</button>
                    </div>
                </div>
            </div>
        </form>


    </div>
</p-dialog>

<fintrakbanking-message [title]="title" [message]="message" [show]="show" [cssClass]="cssClass" (closeEvent)="hideMessage($event)"></fintrakbanking-message>

<p-dialog [responsive]=true [(visible)]="displayRestructuringApprovalModal" [contentStyle]="{'overflow':'scroll','max-height':'600px'}" modal="modal" width="1200">
    <div class="panel-body">
        <div class="form-horizontal">
            <p-tabView>
                <p-tabPanel i18n-header  header="Basic Information">
                    <div class="panel panel-default" id="print-section-basic-information">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Basic Information
                            </h2>
                        </div>
                        <div class="panel-body">
                            <table class="table table-customer-information">
                                <tbody>
                                    <tr>
                                        <td>
                                            <strong i18n>Customer Group Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerGroupName ? loanSelectedData.customerGroupName : 'N/A'}}
                                        </td>
                                        <td>
                                            <strong i18n>Customer Branch</strong>
                                        </td>
                                        <td >{{ loanSelectedData.branchName ? loanSelectedData.branchName : 'N/A'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Customer Code</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerCode ? loanSelectedData.customerCode : 'N/A' }}</td>
                                        <td>
                                            <strong i18n>Customer Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerName ? loanSelectedData.customerName : 'N/A'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Application Reference Number</strong>
                                        </td>
                                        <td >{{ loanSelectedData.applicationReferenceNumber }}</td>
                                        <td>
                                            <strong i18n>Loan Reference Number</strong>
                                        </td>
                                        <td >{{ loanSelectedData.loanReferenceNumber }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Type of Loan</strong>
                                        </td>
                                        <td >{{ loanSelectedData.loanTypeName }}</td>
                                        <td>
                                            <strong i18n>Product Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productName }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>GL Account Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productAccountName }}</td>
                                        <td>
                                            <strong i18n>GL Account Number</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productAccountNumber }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Relationship Manager</strong>
                                        </td>
                                        <td >{{ loanSelectedData.relationshipManagerName }}</td>
                                        <td>
                                            <strong i18n>Relationship officer</strong>
                                        </td>
                                        <td >{{ loanSelectedData.relationshipOfficerName }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Sector Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.sectorName}} </td>
                                        <td>
                                            <strong i18n>Sub-Sector Name</strong>
                                        </td>
                                        <td >{{loanSelectedData.subSectorName }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>MIS Code</strong>
                                        </td>
                                        <td >{{ loanSelectedData.misCode}} </td>
                                        <td>
                                            <strong i18n>Team MIS Code Loan</strong>
                                        </td>
                                        <td >{{ loanSelectedData.teamMiscode }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Profile Loan</strong>
                                        </td>
                                        <td >{{ loanSelectedData.profileLoan}} </td>
                                        <td>
                                            <strong i18n>Customer Sensitivity Level</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerSensitivityLevelName }}</td>
                                        <!-- <td><strong i18n>Team MIS Code Loan</strong></td> <td >{{ loanSelectedData.teamMiscode }}</td> -->
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Contingent Information" *ngIf="contingentFacility">
                    <div class="panel panel-default" id="print-section-contingent">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Contingent Information
                            </h2>
                        </div>
                        <div class="panel-body">
                            <table class="table table-customer-information">
                                <tbody>
                                    <tr>
                                        <td>
                                            <strong i18n>Facility Reference No:</strong>
                                        </td>
                                        <td >{{ loanSelectedData.loanReferenceNumber ? loanSelectedData.loanReferenceNumber : 'N/A'}}
                                        </td>
                                        <td>
                                            <strong i18n>Application Reference No:</strong>
                                        </td>
                                        <td >{{ loanSelectedData.applicationReferenceNumber ? loanSelectedData.applicationReferenceNumber : 'N/A'}}</td>

                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Customer Code</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerCode }}</td>
                                        <td>
                                            <strong i18n>Customer Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.customerName ? loanSelectedData.customerName : 'N/A'}}</td>


                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n> Product Account Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productAccountName }}</td>
                                        <td>
                                            <strong i18n>Product Type</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productTypeName }}</td>

                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n> product Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productName }}</td>
                                        <td>
                                            <strong i18n>Branch Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.branchName }}</td>

                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Initiating Officer</strong>
                                        </td>
                                        <td >{{ loanSelectedData.relationshipOfficerName ? loanSelectedData.relationshipOfficerName : 'N/A' }}</td>
                                        <!-- <td>
                                            <strong i18n>Business Manager</strong>
                                        </td>
                                        <td >{{ loanSelectedData.relationshipManagerName }}</td> -->

                                    </tr>
                                    <tr>
                                        <!-- <td>
                                <strong i18n> Booking Date</strong>
                              </td>
                              <td >{{ loanSelectedData.bookingDate | date }}</td> -->
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.effectiveDate | date }}</td>
                                        <td>
                                            <strong i18n> Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.maturityDate | date }}</td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <strong i18n> Contingent Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.principalAmount | number:'1.2' }}</td>


                                        <td>
                                            <strong i18n> Currency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.currency}}</td>
                                    </tr>


                                    <tr>

                                        <td>
                                            <strong i18n> Date Approved</strong>
                                        </td>
                                        <td >{{ loanSelectedData.dateApproved | date }}</td>

                                    </tr>
                                    <tr width="100%">
                                        <td>
                                            <strong>
                                      <h5><ng-container i18n>Changes Made For </ng-container>{{ loanSelectedData.operationTypeName }}</h5>
                                  </strong>
                                        </td>
                                    </tr>
                                    <tr *ngIf="ContingentLiabilityRebook">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date: 'dd-MM-yyyy' }}</td>

                                    </tr>
                                    <tr *ngIf="ContingentLiabilityRebook">
                                        <td>
                                            <strong i18n>Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newTenor}}</td>
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>
                                    <tr *ngIf="CancelContingentLiability">
                                        <td>
                                            <strong i18n>Reason For Cancellation</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>

                                    <tr *ngIf="ContingentLiabilityRenewal">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date: 'dd-MM-yyyy' }}</td>

                                    </tr>
                                    <tr *ngIf="ContingentLiabilityRenewal">
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>



                                    <tr *ngIf="ContingentLiabilityTermination">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>




                                    <tr *ngIf="ContingentLiabilityTenorExtension">
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>


                                    <tr *ngIf="ContingentLiabilityAmountReduction">
                                        <td>
                                            <strong i18n>Reduced Amount </strong>
                                        </td>
                                        <td >{{ loanSelectedData.prepayment | number:'1.2' }}</td>
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>
                                    <tr *ngIf="ContingentLiabilityAmountAddition">
                                        <td>
                                            <strong i18n>Added Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.prepayment | number:'1.2' }}</td>
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails}}</td>
                                    </tr>
                                    <tr width="100%" *ngIf="ContingentLiabilityAmountAddition">
                                        <td>
                                            <strong>
                                      <h5  i18n>Preview Amount Ammended</h5>
                                  </strong>
                                        </td>
                                    </tr>
                                    <tr *ngIf="ContingentLiabilityAmountAddition">
                                        <td>
                                            <strong i18n>Ammended Amount</strong>
                                        </td>
                                        <td >{{ ammendedAmount | number:'1.2' }}</td>

                                    </tr>
                                    <tr width="100%" *ngIf="ContingentLiabilityAmountReduction">
                                        <td>
                                            <strong>
                                      <h5 i18n>Preview Amount Ammended</h5>
                                  </strong>
                                        </td>
                                    </tr>
                                    <tr *ngIf="ContingentLiabilityAmountReduction">
                                        <td>
                                            <strong i18n>Ammended Amount</strong>
                                        </td>
                                        <td >{{ ammendedAmount | number:'1.2' }}</td>

                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>

                </p-tabPanel>

                <p-tabPanel i18n-header  header="Approval Information" *ngIf="!contingentFacility">
                    <div class="panel panel-default" id="print-section-approval-information">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Approval Information
                            </h2>
                        </div>
                        <div class="panel-body">
                            <table class="table table-customer-information">
                                <tbody>
                                    <tr>
                                        <td>
                                            <strong i18n>GL Account Name</strong>
                                        </td>
                                        <td >{{ loanSelectedData.productAccountName }}</td>
                                        <td>
                                            <strong i18n>Principal Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.principalAmount | number: '1.2'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.effectiveDate | date: 'dd-MM-yyyy'}}</td>
                                        <td>
                                            <strong i18n>Booked On</strong>
                                        </td>
                                        <td >{{ loanSelectedData.bookingDate | date: 'dd-MM-yyyy'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Booked By</strong>
                                        </td>
                                        <td >{{ loanSelectedData.creatorName}}</td>
                                        <td>
                                            <strong i18n>Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.maturityDate | date: 'dd-MM-yyyy'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Approved Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.approvedAmount | number: '1.2'}}</td>
                                        <td>
                                            <strong i18n>Outstanding Principal</strong>
                                        </td>
                                        <td >{{ loanSelectedData.outstandingPrincipal | number: '1.2'}}</td>
                                    </tr>
                                    <tr *ngIf="!isOverDraft">
                                        <td>
                                            <strong i18n>First Interest Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.firstInterestPaymentDate | date: 'dd-MM-yyyy'}}</td>
                                        <td>
                                            <strong i18n>First Principal PaymentDate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.firstPrincipalPaymentDate | date: 'dd-MM-yyyy'}}</td>

                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.interestRate}}</td>
                                        <td *ngIf="!isOverDraft">
                                            <strong i18n>Principal Frequency Type</strong>
                                        </td>
                                        <td *ngIf="!isOverDraft">{{ loanSelectedData.pricipalFrequencyTypeName }}</td>
                                    </tr>
                                    <tr>
                                        <td *ngIf="!isOverDraft">
                                            <strong i18n>Interest Frequency Type</strong>
                                        </td>
                                        <td *ngIf="!isOverDraft">{{ loanSelectedData.interestFrequencyTypeName }}</td>
                                        <td>
                                            <strong i18n>Integral Fee Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.integralFeeAmount | number: '1.2'}}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n>Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.tenor }}</td>
                                        <td *ngIf="!isOverDraft">
                                            <strong i18n>Scheduled Prepayment Date</strong>
                                        </td>
                                        <td *ngIf="!isOverDraft"> {{ loanSelectedData.scheduledPrepaymentDate | date: 'dd-MM-yyyy'}}
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <strong i18n> Past Due Interest</strong>
                                        </td>
                                        <td >{{ loanSelectedData.pastDueInterest }}</td>
                                        <td>
                                            <strong i18n> Past Due Principal</strong>
                                        </td>
                                        <td >{{ loanSelectedData.pastDuePrincipal }}</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong i18n> Interest On Past Due Interest</strong>
                                        </td>
                                        <td >{{ loanSelectedData.interestOnPastDueInterest }}</td>
                                        <td>
                                            <strong i18n> Interest On Past Due Principal</strong>
                                        </td>
                                        <td >{{ loanSelectedData.interestOnPastDuePrincipal }}</td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <strong i18n> Accrued Interest</strong>
                                        </td>
                                        <td >{{ loanSelectedData.accruedInterest }}</td>
                                        <td>
                                            <strong i18n> Total Oustanding</strong>
                                        </td>
                                        <td >{{ loanSelectedData.writeOffAmount }}</td>

                                    </tr>



                                    <tr width="100%">
                                        <td>
                                            <strong>
                                      <h5><ng-container i18n>Changes Made For </ng-container>{{ loanSelectedData.operationTypeName }}</h5>
                                  </strong>
                                        </td>
                                    </tr>

                                    <tr *ngIf="loanSelectedData.operationTypeId == 80">
                                        <th i18n>S/No</th>
                                        <th i18n>Date</th>
                                        <th style="text-align: right">Amount : {{loanSelectedData.prepaymentAmount}}</th>
                                    </tr>
                                    <tr *ngFor="let p of scatterdPayments;let indx=index">
                                        <td >{{indx + 1}}</td>
                                        <td >{{p.paymentDate | date}}</td>
                                        <td style="text-align: right;width:120px">{{p.paymentAmount | number:'1.2'}}</td>
                                    </tr>

                                    <tr *ngIf="RegulatoryInterestRateChange">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>New Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>

                                    </tr>
                                    <tr *ngIf="PrepaymentChange">
                                        <td>
                                            <strong i18n>Prepayment</strong>
                                        </td>
                                        <td >{{ loanSelectedData.prepayment | number: '1.2'}}</td>
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date: 'dd-MM-yyyy' }}</td>

                                    </tr>
                                    <tr *ngIf="PaymentDateChange">
                                        <td>
                                            <strong i18n>Old Principal First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.firstPrincipalPaymentDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Old Interest First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.firstInterestPaymentDate | date: 'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="PaymentDateChange">
                                        <td>
                                            <strong i18n>New Principal First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFirstPaymentDate | date: 'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>New Interest First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFirstPaymentDate | date: 'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="PaymentDateChange">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="TenorChange">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy'}}</td>
                                    </tr>
                                    <tr *ngIf="TenorChange">
                                        <td>
                                            <strong i18n>New Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newTenor }}</td>
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date: 'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="CASAAccountChange">
                                        <td>
                                            <strong i18n>Old Account</strong>
                                        </td>
                                        <td >{{ loanSelectedData.casaAccount}} - {{ loanSelectedData.casaAccountName }}</td>
                                        <td>
                                            <strong i18n>New Account</strong>
                                        </td>
                                        <td >{{ loanSelectedData.cASA_Account }} - {{ loanSelectedData.cASA_AccountName }}</td>
                                    </tr>
                                    <tr *ngIf="CASAAccountChange">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy'}}</td>
                                    </tr>
                                    <tr *ngIf="Restucture">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date: 'dd-MM-yyyy'}}</td>
                                        <td>
                                            <strong i18n>New Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="Restucture">
                                        <td>
                                            <strong i18n>Interest Frequencyuency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFrequencyTypeName }}</td>
                                        <td>
                                            <strong i18n>Principal Frequency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFrequencyTypeName }}</td>
                                    </tr>
                                    <tr *ngIf="Restucture">
                                        <td>
                                            <strong i18n>Interest First Pmt Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFirstPaymentDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Principal First Pmt Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFirstPaymentDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="Restucture">
                                        <td>
                                            <strong i18n>New Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newTenor }}</td>
                                        <td>
                                            <strong i18n>New Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>


                                    <tr *ngIf="Others">
                                        <!-- <td>
                                              <strong i18n>Loan Amount</strong>
                                          </td>
                                          <td >{{ loanSelectedData.totalOutstanding}}</td>
                                          <td> -->
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.effectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.maturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="Others">
                                        <td>
                                            <strong i18n>Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.tenor }}</td>
                                    </tr>



                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Interest First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFirstPaymentDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Interest Frquency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFrequencyTypeName}}</td>
                                    </tr>
                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Maturity Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Principal First Payment Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFirstPaymentDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Principal Frequency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFrequencyTypeName}}</td>
                                        <td>
                                            <strong i18n>Tenor</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newTenor}}</td>
                                    </tr>
                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Loan Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.prepayment | number: '1.2'}}</td>
                                    </tr>
                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Schedule Type</strong>
                                        </td>
                                        <td >{{ loanSelectedData.scheduledPrepaymentFrequencyTypeName }}</td>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>
                                    <tr *ngIf="LoanRecapitalization">
                                        <td>
                                            <strong i18n>Basis</strong>
                                        </td>
                                        <td >{{ loanSelectedData.scheduleDayCountConventionName }}</td>
                                        <td>
                                            <strong i18n> Type</strong>
                                        </td>
                                        <td >{{ type }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftInterestRateReview">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Expiry Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftInterestRateReview">
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>
                                    <tr *ngIf="Overdrafttopup">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Expiry Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="Overdrafttopup">
                                        <td>
                                            <strong i18n>Limit</strong>
                                        </td>
                                        <td >{{ loanSelectedData.overDraftTopup }}</td>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>

                                    <tr *ngIf="OverdraftTenorExtension">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Expiry Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftTenorExtension">
                                        <td>
                                            <strong i18n>Limit</strong>
                                        </td>
                                        <td >{{ loanSelectedData.overDraftTopup }}</td>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>




                                    <tr *ngIf="FeechargeChange">
                                        <td>
                                            <strong i18n>New Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                        <td>
                                            <strong i18n>New Fee Amount</strong>
                                        </td>
                                        <td >{{ loanSelectedData.prepayment | number: '1.2' }}</td>
                                    </tr>
                                    <tr *ngIf="FeechargeChange">
                                        <td>
                                            <strong i18n>Interest Frequencyuency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterestFrequencyTypeName }}</td>
                                        <td>
                                            <strong i18n>Principal Frequency</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newPrincipalFrequencyTypeName }}</td>
                                    </tr>


                                    <tr *ngIf="OverdraftSubAllocation">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Expiry Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftSubAllocation">
                                        <td>
                                            <strong i18n>CASA Account</strong>
                                        </td>
                                        <td >{{ loanSelectedData.cASA_AccountId }}</td>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftSubAllocation">
                                        <td>
                                            <strong i18n>Limit</strong>
                                        </td>
                                        <td >{{ loanSelectedData.overDraftTopup }}</td>

                                    </tr>

                                    <tr *ngIf="OverdraftRenewal">
                                        <td>
                                            <strong i18n>Effective Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newEffectiveDate | date:'dd-MM-yyyy' }}</td>
                                        <td>
                                            <strong i18n>Expiry Date</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newMaturityDate | date:'dd-MM-yyyy' }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftRenewal">
                                        <td>
                                            <strong i18n>Limit</strong>
                                        </td>
                                        <td >{{ loanSelectedData.overDraftTopup }}</td>
                                        <td>
                                            <strong i18n>Interest Rate</strong>
                                        </td>
                                        <td >{{ loanSelectedData.newInterateRate }}</td>
                                    </tr>
                                    <tr *ngIf="OverdraftRenewal">
                                        <td>
                                            <strong i18n>Operation Details</strong>
                                        </td>
                                        <td >{{ loanSelectedData.reviewDetails }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Attachments" *ngIf="showAttachedDocument">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Attached Documents
                                <!-- {{ supportingDocuments.length }} -->
                            </h2>
                        </div>
                        <div class="panel-body">

                            <p-dataTable [value]="attachmentDocuments" [paginator]="true" [rows]="5">
                                <p-column i18n-header  field="documentTitle" header="Document Title" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="fileExtension" header="Type" [filter]="true" filterMatchMode="contains" [style]="{'width':'60px'}"></p-column>

                                <p-column i18n-header  [style]="{'width':'150px'}">
                                    <ng-template pTemplate="header"> </ng-template>
                                    <ng-template pTemplate="body" let-d="rowData" let-i="rowIndex">
                                        <a *ngIf="['jpg','jpeg', 'png'].indexOf(d.fileExtension.toLowerCase()) > -1" (click)="viewDocument(d)" href="javascript:void(0)" i18n>View</a>
                                        <a *ngIf="['doc','docx', 'pdf','xls', 'xlsx'].indexOf(d.fileExtension.toLowerCase()) > -1" (click)="DownloadDocument(d.documentId)" href="javascript:void(0)" i18n>Download</a>
                                    </ng-template>
                                </p-column>

                            </p-dataTable>
                        </div>
                    </div>
                </p-tabPanel>


                <p-tabPanel i18n-header  header="Manual Fees" *ngIf="hasFees">
                    <div class="panel panel-default" id="print-section-manual-fee">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Fees
                            </h2>
                        </div>
                        <div class="panel-body">

                            <p-dataTable [value]="loanOperationApprovalFees" [paginator]="true" [rows]="5">
                                <p-column i18n-header  field="chargeFeeName" header="Charge Fee" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="casaAccountName" header="CASA Account " [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="description" header="Description" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="feeAmount" header="Amount" sortable="true" [filter]="true" filterMatchMode="contains">
                                    <ng-template let-col let-ln="rowData" pTemplate="body">
                                        {{ln[col.field] | number:'1.2' }}
                                    </ng-template>
                                </p-column>


                            </p-dataTable>
                        </div>
                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Approval Memorandum" *ngIf="loanSelectedData?.lmsLoanReferenceNumber !=null">

                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-9">

                                </div>
                                <div class="col-md-3">
                                    <div class="pull-right">
                                        <button  (click)="previewDocumentation()" style="padding: 3px 6px 3px 6px;">
                                                    <span class="glyphicon glyphicon-file"></span><ng-container i18n>LMS Preview</ng-container>
                                                    </button>
                                        <button    (click)="previewDocumentationLos()" style="padding: 3px 6px 3px 6px;">
                                                        <span class="glyphicon glyphicon-file"></span><ng-container i18n>LOS Preview</ng-container>
                                                        </button>
                                        <button    (click)="print()" style="padding: 3px 6px 3px 6px;">
                                                    <span class="glyphicon glyphicon-print"></span> <ng-container i18n>Print</ng-container></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CAM -->

                        <div class="panel-body" style="overflow:auto;height:450px" id="print-section">
                            <div *ngFor="let x of preDocumentations">
                                <p><strong>{{x.title}}</strong></p>
                                <span [innerHtml]="x.templateDocument"></span>
                            </div>


                        </div>
                    </div>

                </p-tabPanel>

                <p-tabPanel i18n-header  header="Offer Letter" [activeIndex]="activeTabindex" *ngIf="displayReport==true">
                    <div class="panel-body">
                        <div class="col-md-12" *ngIf="displayTestReport" style=" width:949px; height: 350px; overflow:auto;">
                            <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="350px" width="949px" style="overflow:auto"></iframe>
                        </div>
                    </div>
                </p-tabPanel>



                <p-tabPanel i18n-header  header="Covenant Details">
                    <div style="margin-bottom:0" class="panel panel-default" id="print-section-convenant">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Covenant Details
                            </h2>
                        </div>
                        <div class="panel-body">
                            <p-dataTable [value]="convenatDetails" [responsive]="true">
                                <p-header i18n>Covenant Details</p-header>
                                <p-column i18n-header  field="covenantDetail" header="Covenant"></p-column>
                                <p-column i18n-header  field="covenantAmount" header="Amount"></p-column>
                                <p-column i18n-header  field="covenantDate" header="Date"></p-column>
                                <p-column i18n-header  field="frequencyTypeName" header="Frequency"></p-column>
                            </p-dataTable>
                        </div>

                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Fees Details">
                    <div style="margin-bottom:0" class="panel panel-default" id="print-section-fees">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Fees Details
                            </h2>
                        </div>
                        <div class="panel-body">
                            <p-dataTable [value]="chargeFeeDetails" [responsive]="true">
                                <p-header i18n>Fees Details</p-header>
                                <p-column i18n-header  field="chargeFeeName" header="Charge Fee Name"></p-column>
                                <p-column i18n-header  field="feeAmount" header="Fee Amount"></p-column>
                                <p-column i18n-header  field="feeIntervalName" header="Fee Interval"></p-column>
                                <p-column i18n-header  field="feeRateValue" header="Rate(%)"></p-column>
                            </p-dataTable>
                        </div>

                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Collateral Details">
                    <div style="margin-bottom:0" class="panel panel-default" id="print-section-collateral">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Collateral Details
                            </h2>
                        </div>

                        <div class="panel-body">
                            <p-dataTable [value]="collateralDetails" [responsive]="true">
                                <p-header i18n>Collateral Details</p-header>
                                <p-column i18n-header  field="collateralCode" header="Code"></p-column>
                                <p-column i18n-header  field="collateralType" header="Collateral Type"></p-column>
                                <p-column i18n-header  field="collateralValue" header="Value"></p-column>
                                <p-column i18n-header  field="haircut" header="Haircut"></p-column>
                                <!-- <p-column i18n-header  field="securityValue" header="Security Value"></p-column> -->
                            </p-dataTable>
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <div class="col-md-12">
                                </div>
                            </div>
                        </div>
                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Schedule Details" *ngIf="!displayCustomerODDetails">
                    <div style="margin-bottom:0" class="panel panel-default" id="print-section-schedule">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Schedule Details
                            </h2>
                        </div>
                        <div class="panel-body">
                            <fieldset>
                                <table style="margin-bottom: 20px">
                                    <tr>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding: 4px">Granted Amount</td>
                                        <td  style="text-align: right;padding-left: 10px;padding: 4px">{{loanSelection?.principalAmount}}</td>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding-left: 20px;padding: 4px">Interest Rate
                                        </td>
                                        <td style="text-align: right;padding: 4px">{{loanSelection?.interestRate}} %</td>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding-left: 20px;padding: 4px">Effective Interest Rate</td>
                                        <td  style="text-align: right;padding: 4px">{{loanSelection?.effectiveInterestRate | number: '1.2-2'}} %</td>
                                    </tr>
                                    <tr>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding: 4px">Effective Date</td>
                                        <td style="text-align: right;padding-left: 10px;padding: 4px">{{loanSelection?.effectiveDate | date}}</td>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding-left: 20px;padding: 4px">Maturity Date
                                        </td>
                                        <td  style="text-align: right;padding: 4px">{{loanSelection?.maturityDate | date}}
                                        </td>
                                        <td i18n style="font-size: 12px;font-weight: bold;padding-left: 20px;padding: 4px">Schedule Type
                                        </td>
                                        <td  style="text-align: right;padding: 4px">{{loanSelection?.scheduleTypeName}}</td>
                                    </tr>
                                </table>

                            </fieldset>


                            <p-dataTable scrollable="true" scrollHeight="200px" [value]="loanScheduleDetails" [responsive]=true selectionMode="single">
                                <p-column i18n-header  [style]="{'width':'80px'}" field="paymentNumber" header="No"></p-column>
                                <p-column i18n-header  field="paymentDate" header="Payment Date">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span>{{schedule[col.field] | date}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="startPrincipalAmount" header="Start Principal">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="periodPaymentAmount" header="Periodic Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="periodPrincipalAmount" header="Principal Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="periodInterestAmount" header="Interest Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span  style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="endPrincipalAmount" header="Balance">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>

                                <p-column i18n-header  field="amortisedStartPrincipalAmount" header="AM Start Principal">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span  style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="amortisedPeriodPaymentAmount" header="AM Periodic Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span  style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="amortisedPeriodPrincipalAmount" header="AM Principal Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="amortisedPeriodInterestAmount" header="AM Interest Amount">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="amortisedEndPrincipalAmount" header="AM Balance">
                                    <ng-template let-col let-schedule="rowData" pTemplate="body">
                                        <span  style="text-align: right">{{schedule[col.field] | number: '1.2-2'}}</span>
                                    </ng-template>
                                </p-column>
                            </p-dataTable>
                        </div>

                    </div>

                </p-tabPanel>

                <p-tabPanel i18n-header  header="Supporting Documents">
                    {{loanSelectedData?.loanReviewApplicationId}} | {{loanSelectedData?.applicationReferenceNumber}}
                    <div class="panel panel-default" id="print-section-support-document">
                        <div class="panel-heading">
                            <h2 i18n  class="panel-title">
                                Supporting Documents
                                <!-- {{ supportingDocuments.length }} -->
                            </h2>
                        </div>
                        <div class="panel-body">
                            <document-upload *ngIf="loanSelectedData != null && loanSelectedData?.customerId > 0" [deleteLink]="false" [panelTitle]="CREDITAPPRIASALDOC" [showUploadForm]="false" [reload]="loanSelectedData.lmsLoanApplicationId" [isLms]="true" [operationId]="loanSelectedData.lmsOperationId"
                                [customerId]="loanSelectedData.customerId" [customerGroupId]="loanSelectedData.groupCustomerId" [isOperationSpecific]="false" [targetId]="loanSelectedData.lmsLoanApplicationId" [targetReferenceNumber]="loanSelectedData.lmsrApplicationReferenceNumber">
                            </document-upload>

                        </div>
                    </div>

                </p-tabPanel>
                <p-tabPanel i18n-header  header="Customer Information">
                    <app-customer-information-detail [loadWithCustomerId]="selectedCustomerId">
                    </app-customer-information-detail>
                    <div class="panel-heading">
                        <h2 i18n  class="panel-title">
                            Customer Details
                        </h2>
                    </div>
                </p-tabPanel>
                <p-tabPanel i18n-header  header="Comments">

                    <div class="panel panel-default" id="print-section-comment">
                        <div class="panel-heading">
                            <h3 i18n>Approval Comments</h3>
                        </div>
                        <div class="panel-body">
                            <p-dataTable resizableColumns="false" [value]="trail" width="1500" height="100%" [paginator]="true" [rows]="30" scrollable="true">
                                <p-column i18n-header  [style]="{'width':'100px'}" field="systemArrivalDateTime" header="Date Initiated" sortable="true" [filter]="true" filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.systemArrivalDateTime | date: 'short' }}
                                    </ng-template>
                                </p-column>
                                <p-column i18n-header  field="fromStaffName" header="Staff Name" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="comment" header="Comment" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="fromApprovalLevelName" header="Approval Level" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="approvalStatus" header="Status" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                                <p-column i18n-header  field="approvalState" header="State" sortable="true" [filter]="true" filterMatchMode="contains"></p-column>
                            </p-dataTable>
                        </div>


                    </div>

                </p-tabPanel>
                <!-- <p-tabPanel i18n-header  header="CRMS Regulatory" *ngIf="isCRMSstaff && !terminateRebook">
                    <crms-regulatories-operations [loanSystemTypeId]="loanSystemTypeId" [loanId]="loanId" [isLms]="isLms">
                    </crms-regulatories-operations>
                </p-tabPanel> -->


            </p-tabView>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <div class="btn-group pull-right">
                            <button i18n  (click)="hideModal()" type="button" class="btn btn-danger" style="margin-right:5px">Close</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

</p-dialog>


<!-- <p-dialog [responsive]=true [(visible)]=displayJobrequest showHeader="false" id="Job-request-modal" modal="modal"
  showEffect="fade" width="700">
  <div *ngIf="loanSelectedData != null">
      <job-request-template [targetId]=loanApplDetailId [jobSourceId]=jobSourceId [operationAvailable]="true"
          [moduleReferenceNumber]=lmsLoanReferenceNumber [operationsId]=lmsOperationId (displayOption)="CallRequestClose()"
          [isApplicationLevel]="false" [useFacilityDropdownToDetermineTarget]="false">
      </job-request-template>
  </div>
</p-dialog> -->

<p-dialog [responsive]=true [(visible)]="displayDocument" modal="modal" showEffect="fade" width="1200">
    <div style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2  class="panel-title">
                <ng-container i18n>Document Title:</ng-container>
                <strong>{{ selectedDocument }}</strong>
            </h2>
            <div class="pull-right">
                <a class="close" (click)="displayDocument=false">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="overflow:auto;height:450px">

            <img *ngIf="binaryFile" style="max-width: 100%; display: block 2px black;" [src]="'data:image/jpg;base64,'+binaryFile" alt="" class="img-thumbnail">

        </div>

    </div>
</p-dialog>
<!--modal for all documentation -->

<p-dialog [responsive]=true [(visible)]="displayDocumentation" modal="modal" showEffect="fade" width="1200">
    <div *ngIf="displayDocumentation" style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2   class="panel-title">
                <ng-container i18n> Appraisal Documentation for REFERENCE:</ng-container>
                <strong>{{ loanSelectedData?.applicationReferenceNumber }}</strong> of OBLIGOR:
                <strong>{{ loanSelectedData?.customerName }}</strong>
            </h2>
            <div class="pull-right">
                <a class="close" (click)="closeDocumentation()">&times;</a>
            </div>
        </div>

        <div class="panel-body" style="overflow:auto;height:450px">
            <div *ngFor="let x of documentations">
                <p><strong>{{x.title}}</strong></p>
                <span [innerHtml]="x.templateDocument"></span>
            </div>
        </div>

    </div>
</p-dialog>