<div class="ui-g">
    <!--*ngIf="!isGlobal" -->
    <div class="ui-g-12 no-padding">
        <div class="card no-padding">
            <div style="margin-bottom:0" class="panel panel-default">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-12">
                            <h2 i18n class="panel-title pull-left">
                                Project Site Report
                            </h2>
                        </div>
                    </div>
                </div>
                <div style="padding:3px" class="panel-body">
                    <p-tabView [activeIndex]="activeTabindex" (onChange)="onTabChange($event)">
                        <p-tabPanel i18n-header header="Loan Applications">
                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h2 i18n class="panel-title pull-left">
                                            List of Facilities
                                        </h2>

                                        <div class="pull-right">
                                            <button pButton (click)="customerSearch()" type="button"
                                            i18n-label  label="Get Facility" icon="fa fa-add"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body"> 
                                <p-dataTable [value]="applications" [paginator]="true" [rows]="7"
                                    [rowsPerPageOptions]="[10,20,30]" (onRowSelect)="onRowSelect($event.data)"
                                    (onRowUnselect)="onRowSelectUnselect($event.data)">
                                    <p-column i18n-header selectionMode="multiple"></p-column>
                                    <p-column i18n-header field="customerName" header="Customer Name" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="customerCode" header="Customer Code" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="loanPurpose" header="Loan Purpose" sortable="true" [filter]="true"
                                        filterMatchMode="contains"></p-column>
                                    <!-- <p-column i18n-header field="reportTypeName" header="Facility Type" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column> -->
                                    <p-column i18n-header field="applicationDate" header="Date" sortable="true" [filter]="true"
                                        filterMatchMode="contains">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.applicationDate | date: 'dd-MM-yyyy' }}
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header field="applicationReferenceNumber" header="Reference" sortable="true"
                                        [filter]="true" filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
                                    <p-column i18n-header field="loanReferenceNumber" header="Loan Reference" sortable="true"
                                        [filter]="true" filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
                                    <p-column i18n-header field="legalContingentCode" header="Legal Reference Code" sortable="true"
                                        [filter]="true" filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
                                    <p-column i18n-header field="productName" header="Product Name" sortable="true"
                                        [filter]="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="approvedAmount" header="Approved Amount" sortable="true" [filter]="true"
                                        filterMatchMode="contains" [style]="{'text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.approvedAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="principalAmount" header="Loan Amount" sortable="true" [filter]="true"
                                        filterMatchMode="contains" [style]="{'text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.principalAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="totalUtilized" header="Total Utilized Amount" sortable="true" [filter]="true"
                                        filterMatchMode="contains" [style]="{'text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.totalUtilized | number : '1.2' }}
                                        </ng-template>
                                    </p-column>
                                    
                                    <!-- <p-column i18n-header [style]="{'width':'120px'}" [filter]="true" filterMatchMode="contains">
                                        <ng-template let-row="rowData" let-i="rowIndex" pTemplate="body">
                                            <div class="btn-group"
                                                [innerHtml]="getLoanApplicationStatus(row.applicationStatusId)"></div>
                                        </ng-template>
                                    </p-column> -->
                                    <!-- <p-column i18n-header>
                                            <ng-template pTemplate="header"> </ng-template>
                                            <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                <div style="text-align:center">
                                                    <a (click)="viewLoans(d)" href="javascript:void(0)">View</a>
                                                </div>
                                            </ng-template>
                                        </p-column> -->

                                </p-dataTable>
                            </div>
                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">
                                        <button type="button" (click)="createReport()"
                                            class="btn btn-success pull-right" i18n>Create Report</button>

                                    </div>
                                </div>
                            </div>
                        </p-tabPanel>

                        <p-tabPanel i18n-header header="Project Site Report">
                            <div class="panel-heading">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h2 i18n class="panel-title pull-left">
                                            Project Site Report
                                        </h2>
                                        <!-- <div class="pull-right">
                                            <button (click)="showProjectSiteReportForm()" pButton type="button"
                                                label="Add New" icon="fa-plus"></button>
                                        </div> -->
                                    </div>
                                </div>
                            </div>

                            <div class="panel-body">

                                <p-dataTable [value]="ProjectSiteReports" [responsive]="true" [paginator]="true"
                                    [rows]="5">

                                    <p-column i18n-header field="clientName" header="Client Name" [filter]="true" sortable="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="contractorName" header="Contractor Name" [filter]="true"
                                        sortable="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="consultantName" header="Consultant Name" [filter]="true"
                                        sortable="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="psrRepeortType" header="Facility Type" [filter]="true"
                                        sortable="true" filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="projectAmount" header="Project Cost" sortable="true"
                                        [filter]="true" filterMatchMode="contains" [style]="{'text-align':'right'}">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.projectAmount | number : '1.2' }}
                                        </ng-template>
                                    </p-column>

                                    <p-column i18n-header field="currency" header="Currency" sortable="true"
                                        filterMatchMode="contains"></p-column>
                                    <p-column i18n-header field="projectDescription" header="Project Description" sortable="true"
                                        filterMatchMode="contains">
                                    </p-column>
                                    <p-column i18n-header field="inspectionDate" header="Inspection Date" sortable="true"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.inspectionDate | date: 'dd-MM-yyyy' }}
                                    </ng-template>
                                </p-column>
                                    <!-- <p-column i18n-header field="commencementDate" header="Project Commencement Date"
                                        sortable="true" filterMatchMode="contains">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.commencementDate | date: 'dd-MM-yyyy' }}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="completionDate" header="Project Completion Date (Planned)"
                                        sortable="true" filterMatchMode="contains">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.completionDate | date: 'dd-MM-yyyy' }}
                                        </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="inspectionDate" header="Inspection Date" sortable="true"
                                    filterMatchMode="contains">
                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                        {{ d.inspectionDate | date: 'dd-MM-yyyy' }}
                                    </ng-template>
                                </p-column>
                                    <p-column i18n-header field="nextVisitationDate" header="Next Visitation Date" sortable="true"
                                        filterMatchMode="contains">
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            {{ d.nextVisitationDate | date: 'dd-MM-yyyy' }}
                                        </ng-template>
                                    </p-column> -->

                                    <p-column i18n-header field="approvalStatusName" header="Approval Status" sortable="true"
                                        filterMatchMode="contains" [filter]="true">
                                    </p-column>

                                    <p-column i18n-header [style]="{'width':'300px'}" header="View">
                                        <ng-template pTemplate="header"> </ng-template>
                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                            <div style="text-align:center">
                                                <a (click)="viewFacilities(d)" href="javascript:void(0)" i18n>Facilities</a>
                                                <span style="padding:3px;">|</span>
                                                <a (click)="addComment(d)" href="javascript:void(0)"i18n>All Comment</a>
                                                <span *ngIf="d.approvalStatusId ==0" style="padding:3px;">|</span>
                                                <a *ngIf="d.approvalStatusId ==0" (click)="deleteProjectSiteReport(d)"
                                                    href="javascript:void(0)" i18n>Remove</a>
                                                <span *ngIf="d.approvalStatusId ==0 || d.approvalStatusId == 5"
                                                    style="padding:3px;">|</span>
                                                <a *ngIf="d.approvalStatusId ==0 || d.approvalStatusId == 5"
                                                    (click)="editProjectSiteReports(d)"
                                                    href="javascript:void(0)" i18n>Edit</a>
                                                <span *ngIf="d.approvalStatusId ==0" style="padding:3px;">|</span>
                                                <a *ngIf="d.approvalStatusId ==0" (click)="scheduleForApproval(d)"
                                                    href="javascript:void(0)" i18n>Approval</a>

                                            </div>
                                        </ng-template>
                                    </p-column>

                                </p-dataTable>

                            </div>

                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">
                                        <button (click)="activeTabindex=0;" class="pull-right btn btn-info"
                                            style="margin-right:5px" i18n>Back To List</button>
                                    </div>
                                </div>
                            </div>
                        </p-tabPanel>
                        <!-- ======================= -->

                        <p-tabPanel i18n-header header=" Evaluation Report" [disabled]="disableTab">

                            <div class="panel-body">

                                <div class="col-md-1"></div>
                                <div class="col-md-10">
                                    <p-accordion>
                                        <!-- ===================================== -->
                                        <p-accordionTab i18n-header header="Performance Analysis" [selected]="true"
                                            *ngIf="psrReportTypeId == 2">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            PERFORMANCE ANALYSIS
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId == 0 && performanceAnalysisReportCount == 0"
                                                                (click)="displayPsrPerformanceAnalysis=true" pButton
                                                                type="button" label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-body" *ngIf="showInput">
                                                <p-dataTable [value]="performanceAnalysisReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="valueOfCollateral" header="Value Of Collateral"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.valueOfCollateral | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <!-- <p-column i18n-header field="ipc" header="IPC" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.ipc | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="pmu" header="PMU" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.pmu | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="amountDisbursed" header="Amount Disbursed"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.amountDisbursed | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column> -->
                                                    <p-column i18n-header field="amountRequested" header="Amount Requested"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.amountRequested | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>

                                                    <p-column i18n-header [style]="{'width':'200px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a (click)="myAnalysisDetail(d)"
                                                                    href="javascript:void(0)" i18n>Detail</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deletePsrPerformanceAnalysis(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editPsrPerformanceAnalysis(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>

                                                </p-dataTable>

                                            </div>
                                            <div class="panel-body">
                                                <table *ngIf="showAnalysisDetail" class="table table-casa-information">
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                <strong i18n>Value Of Collateral:</strong>
                                                            </td>
                                                            <td>
                                                                {{analysisDetail.valueOfCollateral | number : '1.2' }}
                                                            </td>
                                                            <td>
                                                                <strong i18n>Certified VOWD to Date:</strong>
                                                            </td>
                                                            <td>{{ analysisDetail.ipc | number : '1.2' }}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <strong i18n>PMU assessed Work to Date:</strong>
                                                            </td>
                                                            <td>{{ analysisDetail.pmu | number : '1.2' }}</td>
                                                            <td>
                                                                <strong></strong>
                                                            </td>
                                                            <td></td>

                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <strong i18n>Amount Disbursed:</strong>
                                                            </td>
                                                            <td>{{ analysisDetail.amountDisbursed | number : '1.2' }}
                                                            </td>
                                                            <td>
                                                                <strong i18n>Amount Requested :</strong>
                                                            </td>
                                                            <td>{{ analysisDetail.amountRequested | number : '1.2' }}
                                                            </td>

                                                        </tr>


                                                    </tbody>
                                                </table>
                                                <div class="panel-footer" *ngIf="showAnalysisDetail">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="pull-right">
                                                                <button
                                                                    (click)="showInput=true; showAnalysisDetail=false;"
                                                                    pButton type="button" i18n-label label="Back"
                                                                    icon="fa-plus"></button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </p-accordionTab>
                                        <!-- =========================================== -->
                                        <p-accordionTab i18n-header header="Performance Evaluation">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            PERFORMANCE EVALUATION
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0 && performanceEvaluationsReportCount == 0"
                                                                (click)="displayPsrPerformanceEvaluation=true" pButton
                                                                type="button" i18n-label label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-body" *ngIf="showInput">
                                                <p-dataTable [value]="performanceEvaluationsReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="psrReportType" header="Report Type" sortable="true"
                                                        filterMatchMode="contains"></p-column>
                                                    <p-column i18n-header *ngIf="psrReportTypeId==1" field="projectSum" header="Project Cost"
                                                    sortable="true" filterMatchMode="contains">
                                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                        {{ d.projectSum | number : '1.2' }}
                                                    </ng-template>
                                                     </p-column>
                                                     <p-column i18n-header *ngIf="psrReportTypeId==2" field="apgIssued" header="APG Issued"
                                                    sortable="true" filterMatchMode="contains">
                                                    <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                        {{ d.apgIssued | number : '1.2' }}
                                                    </ng-template>
                                                     </p-column>   
                                                    <p-column i18n-header *ngIf="psrReportTypeId == 1" field="progressPayment" header="Progress Payment To Date"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.progressPayment | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="disbursedTodate" header="Disbursed To date"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.disbursedTodate | number : '1.2' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header [style]="{'width':'200px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a (click)="detail(d)"
                                                                    href="javascript:void(0)" i18n>Detail</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deletePsrPerformanceEvaluation(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editPsrPerformanceEvaluation(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>

                                                </p-dataTable>

                                            </div>
                                            <div class="panel-body">
                                                <table *ngIf="showDetail" class="table table-casa-information">
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                <strong i18n>Project Cost:</strong>
                                                            </td>
                                                            <td colspan="2" style="text-align:left">
                                                                {{performanceDetail.projectSum | number : '1.2'}}</td>
                                                            <td *ngIf="psrReportTypeId==2">
                                                                <strong i18n>APG Issued:</strong>
                                                            </td>
                                                            <td *ngIf="psrReportTypeId==2">
                                                                {{ performanceDetail.apgIssued | number : '1.2'}}
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td *ngIf="psrReportTypeId == 2">
                                                                <strong i18n>Amount Received:</strong>
                                                            </td>
                                                            <td *ngIf="psrReportTypeId == 2">{{ performanceDetail.amountReceived | number : '1.2'}}</td>
                                                            <td>
                                                                <strong i18n>PMU Assessd VOWD To Date:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.pmuAssessed | number : '1.2'}}</td>
                                                            <td>
                                                                <strong i18n>Amount Disbursed To Date:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.disbursedTodate | number : '1.2' }}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <strong i18n>Independent Consultant To Date:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.consoltantVowd | number : '1.2'}}</td>
                                                            <td>
                                                                <strong i18n>Cost Variation:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.costVariation | number : '1.2'}}</td>
                                                            <td>
                                                                <strong i18n>Time Variation:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.timeVariation }}</td>
                                                        </tr>
                                                        <tr>
                                                            <td *ngIf="psrReportTypeId==2">
                                                                <strong i18n>Certified VOWD To Date:</strong>
                                                            </td>
                                                            <td *ngIf="psrReportTypeId==2">{{ performanceDetail.certifiedVowd | number : '1.2'}}</td>
                                                            <td *ngIf="psrReportTypeId==2">
                                                                <strong i18n>Amortised APG:</strong>
                                                            </td>
                                                            <td *ngIf="psrReportTypeId==2">
                                                                {{ performanceDetail.amortisedApg | number : '1.2'}}</td>
                                                            <td *ngIf="psrReportTypeId==1">
                                                                <strong i18n>Progress Payment to date:</strong>
                                                            </td>
                                                            <td *ngIf="psrReportTypeId==1">{{ performanceDetail.progressPayment  | number : '1.2'}}</td>
                                                        </tr>
                                                        <!-- <tr>
                                                            <td>
                                                                <strong i18n>Project Cost at Inception:</strong>
                                                            </td>
                                                            <td>{{ performanceDetail.initialProjectSum | number : '1.2'}}</td>

                                                        </tr> -->
                                                    </tbody>
                                                </table>
                                                <div class="panel-footer" *ngIf="showDetail">
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="pull-right">
                                                                <button (click)="showInput=true; showDetail=false;"
                                                                    pButton type="button" i18n-label label="Back"
                                                                    icon="fa-plus"></button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </p-accordionTab>


                                        <p-accordionTab i18n-header header="Comments">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            COMMENT FROM INSPECTION
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0 && commentReportCount == 0"
                                                                (click)="displayCommentReport=true" pButton
                                                                type="button" label="Add New" icon="fa-plus"></button>
                                                                <button *ngIf="approvalStatusId != 2" (click)="displayCommentImagesReport=true" pButton
                                                                type="button" i18n-label label="Add Supporting Images" style="margin-right:5px" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel-body">
                                                <p-dataTable [value]="commentReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="comment" header="comment" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.comment"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header [style]="{'width':'140px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editCommentReport(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deleteCommentReport(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>

                                                </p-dataTable>
                                            </div>
                                            <div class="panel-heading">
                                            <div class="row" *ngIf="imageCommentReport.length > 0">
                                                <div class="col-md-12">
                                                    <h2 i18n class="panel-title pull-left">
                                                        COMMENT SUPPORING IMAGES
                                                    </h2>
                                                </div>
                                            </div>
                                            </div>
                                            <div class="panel-body" *ngIf="imageCommentReport.length > 0">
                                                <p-dataTable [value]="imageCommentReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="psrCommentImageId" header="ID" sortable="true"
                                                        [filter]="true" filterMatchMode="contains"></p-column>
                                                    <p-column i18n-header field="imageCaption" header="Image Caption"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.imageCaption"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="fileName" header="File Name" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.fileName"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header [style]="{'width':'140px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editCommentImage(d)"
                                                                    href="javascript:void(0)" i18n>Replace</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deleteCommentImage(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>
                                                </p-dataTable>
                                            </div>
                                        </p-accordionTab>
                                        <p-accordionTab i18n-header header="Observations">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            OBSERVATIONS AND IMPACT
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0 && observationReportCount == 0"
                                                                (click)="displayObservationReportM()" pButton
                                                                type="button"  i18n-label label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="panel-body">
                                                <p-dataTable [value]="observationReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="comment" header="comment" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.comment"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header [style]="{'width':'100px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editObservationReport(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deleteObservationReport(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>

                                                </p-dataTable>
                                            </div>
                                        </p-accordionTab>
                                        <p-accordionTab i18n-header header="Recommendations">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            RECOMMENDATIONS
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0 && recommendationReportCount == 0"
                                                                (click)="displayDecommendationReport=true" pButton
                                                                type="button" i18n-header label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="panel-body">
                                                <p-dataTable [value]="recommendationReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="comment" header="comment" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.comment"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <!-- <p-column i18n-header field="customerRating" header="Customer Rating"
                                                        sortable="true" [filter]="true" filterMatchMode="contains">
                                                    </p-column>
                                                    <p-column i18n-header field="projectRiskRating" header="ProjectRisk Rating"
                                                        sortable="true" [filter]="true" filterMatchMode="contains">
                                                    </p-column> -->
                                                    <p-column i18n-header [style]="{'width':'100px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editRecommendationReport(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deleteRecommendationReport(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>

                                                </p-dataTable>
                                            </div>
                                        </p-accordionTab>
                                        <p-accordionTab i18n-header header="Tasks">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            TASKS FOR NEXT INSPECTION
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0 && taskReportCount == 0"
                                                                (click)="displayTaskReport=true" pButton type="button" i18n-label
                                                                label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="panel-body">
                                                <p-dataTable [value]="taskReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="comment" header="comment" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.comment"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="nextInspectionDate" header="Next Inpectioan Date"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            {{ d.nextInspectionDate | date: 'dd-MM-yyyy' }}
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header [style]="{'width':'100px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editTaskReport(d)"
                                                                    href="javascript:void(0)" i18n>Edit</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deleteTaskReport(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>
                                                </p-dataTable>
                                            </div>
                                        </p-accordionTab>

                                        <p-accordionTab i18n-header header="Supporting Images">
                                            <div class="panel-heading">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h2 i18n class="panel-title pull-left">
                                                            PROJECT SITE IMAGES
                                                        </h2>
                                                        <div class="pull-right">
                                                            <button *ngIf="approvalStatusId ==0"
                                                                (click)="addSiteImage()" pButton type="button" i18n-label
                                                                label="Add New" icon="fa-plus"></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="panel-body">
                                                <p-dataTable [value]="imageReport" [responsive]="true"
                                                    [paginator]="false" [rows]="5">
                                                    <p-column i18n-header field="psrImageId" header="ID" sortable="true"
                                                        [filter]="true" filterMatchMode="contains"></p-column>
                                                    <p-column i18n-header field="imageCaption" header="Image Caption"
                                                        sortable="true" filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.imageCaption"></span>
                                                        </ng-template>
                                                    </p-column>
                                                    <p-column i18n-header field="fileName" header="File Name" sortable="true"
                                                        filterMatchMode="contains">
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <span [innerHtml]="d.fileName"></span>
                                                        </ng-template>
                                                    </p-column>

                                                    <p-column i18n-header [style]="{'width':'100px'}" header="View">
                                                        <ng-template pTemplate="header"> </ng-template>
                                                        <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                                                            <div style="text-align:center">
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="editPsrImage(d)"
                                                                    href="javascript:void(0)" i18n>Replace</a>
                                                                <span *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    style="padding:3px;">|</span>
                                                                <a *ngIf="approvalStatusId ==0 || approvalStatusId ==5"
                                                                    (click)="deletePsrImage(d)"
                                                                    href="javascript:void(0)" i18n>Remove</a>
                                                            </div>
                                                        </ng-template>
                                                    </p-column>
                                                </p-dataTable>
                                            </div>
                                        </p-accordionTab>

                                        <div class="panel-footer">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <button type="button" (click)="psrReport()"
                                                        class="btn btn-success pull-right" i18n>View Report</button>
                                                </div>
                                            </div>
                                        </div>
                                    </p-accordion>
                                </div>
                                <div class="col-md-1"></div>

                            </div>

                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">
                                        <button (click)="activeTabindex=0;" class="pull-right btn btn-info"
                                            style="margin-right:5px" i18n>Back To List</button>
                                    </div>
                                </div>
                            </div>
                        </p-tabPanel>
                        <p-tabPanel i18n-header header="Approval Comments" [disabled]="disableTab">
                            <div *ngIf="projectSiteReportId">
                                <p-dataTable [value]="approvalWorkflowData" [paginator]="true" [rows]="5" [responsive]="true">
                                    <p-column i18n-header field="requestStaffName" header="Intiated By"></p-column>
                                    <p-column i18n-header field="requestApproval Level" header="Initiator Approval Level"></p-column>
                                    <p-column i18n-header field="responseApproval Level" header="Response Approval Level"></p-column>
                                    <p-column i18n-header field="approvalStatus" header="Approval Status"></p-column>
                                    <p-column i18n-header field="comment" header="Comment"></p-column>
                                    <p-column i18n-header field="systemArrivalDate" header="Date of Arrival">
                                      <ng-template let-col let-apr="rowData" pTemplate="body">
                                        {{apr[col.field] | date: 'medium'}}
                                      </ng-template>
                                    </p-column>
                                    <p-column i18n-header field="systemResponseDate" header="Date of Response">
                                      <ng-template let-col let-apr="rowData" pTemplate="body">
                                        {{apr[col.field] | date: 'medium' }}
                                      </ng-template>
                                    </p-column>
                                  </p-dataTable>
                              </div>
                          </p-tabPanel>

                        <!-- ==================================== -->
                        <!-- <p-tabPanel i18n-header header="Customer Information" [disabled]="disableTab3">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h2 i18n class="panel-title pull-left">
                                                    Customer Information
                                            </h2>
                                           <div class="pull-right">
                                                <button (click)="showProjectSiteReportForm()" pButton type="button"
                                                    label="Add New" icon="fa-plus"></button>
                                            </div> 
                                        </div>
                                    </div>
                                </div>
    
                                <div class="panel-body" >
    
                                <app-customer-information-detail [loadWithCustomerId]="customerId"
			                    	(customer)="setCustomerName($event)">
				                </app-customer-information-detail>
    
                                </div>
    
                                <div class="panel-footer">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <button (click)="activeTabindex=0;" class="pull-right btn btn-info"
                                                style="margin-right:5px">Back To List</button>
                                        </div>
                                    </div>
                                </div>
                            </p-tabPanel> -->
                        <!-- ======================================= -->

                    </p-tabView>
                </div>
            </div>
        </div>
    </div>
</div>




<p-dialog [responsive]=true [(visible)]="showApplicationSearchForm" id="add-modal" modal="modal" showEffect="fade"
    width="450">
    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Search Application
            </h2>
        </div>

        <form autocomplete="off">

            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label i18n for="searchString" class="control-label col-md-12">Loan Application Reference Number /Customer Name</label>
                        <div class="col-md-12">
                            <input type="text" name="parameter" [(ngModel)]="parameter" id="parameter"
                                class="form-control">
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" (click)="search()" class="btn btn-success pull-right" i18n>Search</button>
                        <button type="button" (click)="showApplicationSearchForm=false" style="margin-right:5px"
                            class="btn btn-danger pull-right" i18n>Cancel</button>
                    </div>
                </div>
            </div>

        </form>

    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayProjectSiteReportForm" id="ct-modal" modal="modal" showEffect="fade"
    width="800" height="600">

    <div style="margin-bottom:0" class="panel panel-default">
        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Project Site Report
            </h2>
        </div>

        <form novalidate [formGroup]="projectSiteReportForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label i18n for="collateralCode" class="control-label col-md-2">Facility Type</label>
                        <div class="col-md-4">
                            <select id="psrReportTypeId" formControlName="psrReportTypeId" name="psrReportTypeId"
                                class="form-control"
                                [ngClass]="!projectSiteReportForm.controls['psrReportTypeId'].valid ? 'required-input' : 'valid-input'">
                                <option i18n value="">Select Facility Type</option>
                                <option *ngFor="let curr of PsrReportTypes" value="{{curr.psrReportTypeId}}">
                                    {{curr.reportTypeName}}
                                </option>
                            </select>
                        </div>
                        <label i18n for="collateralCode" class="control-label col-md-2">Client Name</label>
                        <div class="col-md-4">
                            <input type="text" name="clientName" formControlName="clientName" id="clientName"
                                class="form-control"
                                [ngClass]="projectSiteReportForm.controls['clientName'].valid ? 'valid-input' : 'required-input'">
                        </div>

                    </div>


                    <div class="form-group">

                        <label i18n for="haircut" class="control-label col-md-2">Contractor Name</label>
                        <div class="col-md-4">
                            <input type="text" name="contractorName" formControlName="contractorName"
                                id="contractorName" class="form-control"
                                [ngClass]="projectSiteReportForm.controls['contractorName'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="Currency" class="control-label col-md-2">Currency</label>
                        <div class="col-md-4">
                            <select id="currencyId" formControlName="currencyId" name="currencyId" class="form-control"
                                [ngClass]="!projectSiteReportForm.controls['currencyId'].valid ? 'required-input' : 'valid-input'">
                                <option i18n value="">Select Currency</option>
                                <option *ngFor="let curr of currencies" value="{{curr.currencyId}}">
                                    {{curr.currencyName}}
                                </option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label i18n for="consultantName" class="control-label col-md-2">Consultant Name</label>
                        <div class="col-md-4">
                            <input type="text" name="consultantName" formControlName="consultantName"
                                id="consultantName" class="form-control"
                                [ngClass]="projectSiteReportForm.controls['consultantName'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="haircut" class="control-label col-md-2">Project Cost</label>
                        <div class="col-md-4">
                            <input type="text" name="projectAmount" formControlName="projectAmount" formatM
                                id="projectAmount" class="numeric form-control"
                                [ngClass]="projectSiteReportForm.controls['projectAmount'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>

                    <div class="form-group">
                        <label i18n for="collateralCode" class="control-label col-md-2">Project Location</label>
                        <div class="col-md-4">
                            <input type="text" name="projectLocation" formControlName="projectLocation"
                                id="projectLocation" class=" form-control"
                                [ngClass]="projectSiteReportForm.controls['projectLocation'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="haircut" class="control-label col-md-2">Project Description</label>
                        <div class="col-md-4">
                            <textarea name="projectDescription" formControlName="projectDescription"
                                id="projectDescription" class="form-control"
                                [ngClass]="projectSiteReportForm.controls['projectDescription'].valid ? 'valid-input' : 'required-input'"></textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <label i18n for="collateralCode" class="control-label col-md-2">Project Commencement Date</label>
                        <div class="col-md-4">
                            <p-calendar id="commencementDate" appendTo="form" dateFormat="dd/mm/yy" formControlName="commencementDate" [monthNavigator]="true"
                                [yearNavigator]="true" yearRange="1900:2050" [showIcon]="true"
                                [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225', 'z-index': '999'}"
                                
                                [ngClass]="projectSiteReportForm.controls['commencementDate'].valid ? 'valid-input' : 'required-input'">
                            </p-calendar>
                        </div>
                        <label for="haircut" class="control-label col-md-2">Project Completion Date (Planned)</label>
                        <div class="col-md-4">
                            <p-calendar id="completionDate" dateFormat="dd/mm/yy" formControlName="completionDate" [monthNavigator]="true"
                                [yearNavigator]="true" yearRange="1900:2050" [showIcon]="true"
                                [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225', 'z-index': '999'}"
                                
                                [ngClass]="projectSiteReportForm.controls['completionDate'].valid ? 'valid-input' : 'required-input'">
                            </p-calendar>
                        </div>
                    </div>


                    <div class="form-group">
                        <!-- <label i18n for="collateralCode" class="control-label col-md-2">Next Visitation Date</label>
                        <div class="col-md-4">
                            <p-calendar id="nextVisitationDate" formControlName="nextVisitationDate"
                                [monthNavigator]="true" [yearNavigator]="true" yearRange="1900:2030" [showIcon]="true"
                                [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225'}"
                                [style]="{'width': '100%', 'z-index': '999'}"
                                [ngClass]="projectSiteReportForm.controls['nextVisitationDate'].valid ? 'valid-input' : 'required-input'">
                            </p-calendar>
                        </div> -->
                        <label i18n for="inspectionDate" class="control-label col-md-2">Inspection Date</label>
                        <div class="col-md-4">
                            <p-calendar id="inspectionDate" dateFormat="dd/mm/yy" formControlName="inspectionDate" [monthNavigator]="true"
                                [yearNavigator]="true" yearRange="1900:2050" [showIcon]="true"
                                [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225', 'z-index': '999'}"
                                
                                [ngClass]="projectSiteReportForm.controls['inspectionDate'].valid ? 'valid-input' : 'required-input'">
                            </p-calendar>
                        </div>
                    </div>
                    <br>
                </div>
                <br>
            </div>
            <br>

        </form>
        <br>

        <p-accordion>
            <br>
            <p-accordionTab i18n-header header="List Of Facilities">
                <table class="table table-bordered table-hover">

                    <tr>
                        <th i18n>Reference Number</th>
                        <th i18n>Loan Reference</th>
                        <th i18n>Legal Reference Code</th>
                        <th i18n>Loan Purpose</th>
                        <th i18n>Approved Amount</th>
                        <th i18n>Loan Amount</th>
                        <th i18n>Total Utilized Amount</th>
                        <th i18n>Product Name</th>
                        <th i18n>Is Project Related</th>
                    </tr>

                    <tr *ngFor="let objscan of selectedFacilitiesRows">
                        <td>{{ objscan.applicationReferenceNumber }}</td>
                        <td>{{ objscan.loanReferenceNumber}}</td>
                        <td>{{ objscan.legalContingentCode}}</td>
                        <td>{{ objscan.loanPurpose}}</td>
                        <td>{{ objscan.approvedAmount | number : '1.2' }}</td>
                        <td>{{ objscan.principalAmount | number : '1.2' }}</td>
                        <td>{{ objscan.totalUtilized | number : '1.2' }}</td>
                        <td>{{ objscan.productName}}</td>
                        <td>{{ objscan.isProjectRelated}}</td>
                    </tr>

                </table>
            </p-accordionTab>
        </p-accordion>



        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveProjectSiteReport(projectSiteReportForm)"
                        [disabled]="projectSiteReportForm.invalid" class="btn btn-success pull-right" i18n>Save and Close</button>
                    <button type="button" (click)="displayProjectSiteReportForm=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>

</p-dialog>


<fintrakbanking-message [title]="title" [message]="message" [show]="show" [cssClass]="cssClass" (closeEvent)="hideMessage($event)"></fintrakbanking-message>

<p-dialog [responsive]=true [(visible)]="displayCommentReport" id="ct-modal" modal="modal" showEffect="fade"
    width="600">

    <div style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Comment
            </h2>
        </div>

        <form novalidate [formGroup]="psrCommentForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n for="comment" class="control-label col-md-12">Comment</label>
                        <div class="col-md-12">
                            <app-ckeditior-project *ngIf="displayCommentReport==true"
                                (contentChange)="contentChange($event)" [content]="ckEditorContent" [height]="200">
                            </app-ckeditior-project>

                        </div>
                    </div>

                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveComment(psrCommentForm)" [disabled]="psrCommentForm.invalid"
                        class="btn btn-success pull-right" i18n>Save and Close</button>
                    <button type="button" (click)="displayCommentReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>
    
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayObservationReport" id="ct-modal" modal="modal" showEffect="fade"
    width="600">

    <div style="margin-bottom:0" class="panel panel-default" *ngIf="displayObservationReport==true">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Observation
            </h2>
        </div>

        <div class="panel-body">
            <div class="form-horizontal">

                <div class="form-group">
                    <label i18n for="comment" class="control-label col-md-12">Comment</label>
                    <div class="col-md-12">
                        <app-ckeditior-project *ngIf="displayObservationReport==true" [content]="ckEditorContent"
                            (contentChange)="contentChange($event)" [height]="200">
                        </app-ckeditior-project>
                    </div>
                </div>


            </div>
        </div>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveObservation(psrObservationForm)"
                        [disabled]="psrObservationForm.invalid" class="btn btn-success pull-right" i18n>Save and  Close</button>
                    <button type="button" (click)="closeModal()" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>

</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayTaskReport" id="ct-modal" modal="modal" showEffect="fade" width="600">

    <div style="margin-bottom:0" class="panel panel-default" *ngIf="displayTaskReport==true">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Next Inspection Task
            </h2>
        </div>

        <form novalidate [formGroup]="psrNextInspectionTaskForm"
            (ngSubmit)="saveNextInspectionTask(psrNextInspectionTaskForm)" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n for="comment" class="control-label col-md-12">Comment</label>
                        <div class="col-md-12">

                            <app-ckeditior-project *ngIf="displayTaskReport == true" [content]="ckEditorContent"
                                (contentChange)="contentChange($event)" [height]="100">
                            </app-ckeditior-project>
                        </div>
                    </div>
                    <div class="form-group">
                        <label i18n for="nextInspectionDate" class="control-label col-md-12">Next Inspection Date</label>
                        <div class="col-md-12">
                            <p-calendar id="nextInspectionDate" formControlName="nextInspectionDate" 
                            [minDate]='currentDate'
                                [monthNavigator]="true" [yearNavigator]="true" yearRange="1980:2090" [showIcon]="true"
                                [inputStyle]="{'width': '100%','border-left':'3px solid #3cd225'}"
                                [style]="{'width': '100%', 'z-index': '999'}"
                                [ngClass]="psrNextInspectionTaskForm.controls['nextInspectionDate'].valid ? 'valid-input' : 'required-input'">
                            </p-calendar>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                    <div class="form-group">
                        <div class="col-md-6">
                            <div class="checkbox-container">
                                <input formControlName="isDone" id="isDone" type="checkbox">
                            </div><label i18n class="checkbox">Is Done</label>
                        </div>
                        <div class="col-md-6">
                        </div>
                    </div>


                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveNextInspectionTask(psrNextInspectionTaskForm)"
                        [disabled]="psrNextInspectionTaskForm.invalid" class="btn btn-success pull-right" i18n>Save and  Close</button>
                    <button type="button" (click)="displayTaskReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>

</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayDecommendationReport" id="ct-modal" modal="modal" showEffect="fade"
    width="600">

    <div style="margin-bottom:0" class="panel panel-default" *ngIf="displayDecommendationReport==true">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Recommendation
            </h2>
        </div>

        <form novalidate [formGroup]="psrRecommendationForm" (ngSubmit)="saveRecommendation(psrRecommendationForm)" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n for="comment" class="control-label col-md-12">Comment</label>
                        <div class="col-md-12">
                            <app-ckeditior-project *ngIf="displayDecommendationReport==true"
                                (contentChange)="contentChange($event)" [content]="ckEditorContent" [height]="200">
                            </app-ckeditior-project>
                        </div>
                    </div>
                    <!-- <div class="form-group">
                        <label i18n for="projectRiskRating" class="control-label col-md-2">Project Risk Rating</label>
                        <div class="col-md-8">
                            <select id="projectRiskRating" formControlName="projectRiskRating" name="projectRiskRating"
                                class="form-control"
                                [ngClass]="!psrRecommendationForm.controls['projectRiskRating'].valid ? 'required-input' : 'valid-input'">
                                <option i18n value="">Select Project Risk Rating</option>
                                <option i18n value="High">High</option>
                                <option i18n value="Below Average">Below Average</option>
                                <option i18n value="Medium">Medium</option>
                                <option i18n value="Low">Low</option>
                            </select>

                        </div>
                    </div> -->
                    <!-- <div class="form-group">
                        <label i18n for="customerRating" class="control-label col-md-2">Customer Tier</label>
                        <div class="col-md-8">
                            <select id="customerRating" formControlName="customerRating" name="customerRating"
                                class="form-control"
                                [ngClass]="!psrRecommendationForm.controls['customerRating'].valid ? 'required-input' : 'valid-input'">
                                <option i18n value="">Select Customer Rating</option>
                                <option i18n value="3">3</option>
                                <option i18n value="2">2</option>
                                <option i18n value="1">1</option>
                            </select>
                        </div>
                    </div> -->
                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveRecommendation(psrRecommendationForm)"
                        [disabled]="psrRecommendationForm.invalid" class="btn btn-success pull-right" i18n>Save and  Close</button>
                    <button type="button" (click)="displayDecommendationReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>

</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayPsrPerformanceAnalysis" id="ct-modal" modal="modal" showEffect="fade"
    width="850">

    <div style="margin-bottom:0" class="panel panel-default" *ngIf="displayPsrPerformanceAnalysis==true">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Performance Analysis
            </h2>
        </div>

        <form novalidate [formGroup]="psrPerformanceAnalysisForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div class="form-group">
                        <label i18n for="valueOfCollateral" class="control-label col-md-2">Value of Collateral
                        </label>
                        <div class="col-md-4">
                            <input type="text" name="valueOfCollateral" formControlName="valueOfCollateral"
                                id="valueOfCollateral" class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['valueOfCollateral'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="amountRequested" class="control-label col-md-2">Amount Requested</label>
                        <div class="col-md-4">
                            <input type="text" name="amountRequested" formControlName="amountRequested"
                                id="amountRequested" class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['amountRequested'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <!-- <label i18n for="ipc" class="control-label col-md-2">IPC </label>
                        <div class="col-md-4">
                            <input name="ipc" formControlName="ipc" id="ipc" class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['ipc'].valid ? 'valid-input' : 'required-input'">
                        </div> -->
                    </div>

                    <!-- <div class="form-group">
                        <label i18n for="pmu" class="control-label col-md-2">PMU</label>
                        <div class="col-md-4">
                            <input name="pmu" formControlName="pmu" id="pmu" class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['pmu'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="amountRequested" class="control-label col-md-2">Amount Requested</label>
                        <div class="col-md-4">
                            <input type="text" name="amountRequested" formControlName="amountRequested"
                                id="amountRequested" class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['amountRequested'].valid ? 'valid-input' : 'required-input'">
                        </div> 
                    </div>

                    <div class="form-group">
                        <label i18n for="amountDisbursed" class="control-label col-md-2">Amount Disbursed</label>
                        <div class="col-md-4">
                            <input name="amountDisbursed" formControlName="amountDisbursed" id="amountDisbursed"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceAnalysisForm.controls['amountDisbursed'].valid ? 'valid-input' : 'required-input'">
                        </div>

                    </div> -->

                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="savePsrPerformanceAnalysis(psrPerformanceAnalysisForm)"
                        [disabled]="psrPerformanceAnalysisForm.invalid" class="btn btn-success pull-right">Save and  Close</button>
                    <button type="button" (click)="displayPsrPerformanceAnalysis=false" style="margin-right:5px"
                        class="btn btn-danger pull-right">Cancel</button>
                </div>
            </div>
        </div>
    </div>

</p-dialog>


<p-dialog [responsive]=true [(visible)]="displayPsrPerformanceEvaluation" id="ct-modal" modal="modal" showEffect="fade"
    width="850">

    <div style="margin-bottom:0" class="panel panel-default" *ngIf="displayPsrPerformanceEvaluation==true">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Performance Evaluation
            </h2>
        </div>

        <form novalidate [formGroup]="psrPerformanceEvaluationForm"
            (ngSubmit)="savePsrPerformanceEvaluation(psrPerformanceEvaluationForm)" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">

                    <div *ngIf="psrReportTypeId==1" class="form-group">
                        <label i18n for="projectSum" class="control-label col-md-2">Current Project Cost</label>
                        <div class="col-md-4">
                            <input type="text" name="projectSum" formControlName="projectSum" id="projectSum"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['projectSum'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="pmuAssessed" class="control-label col-md-2">PMU Assessd VOWD To Date</label>
                        <div class="col-md-4">
                            <input type="text" name="pmuAssessed" formatM formControlName="pmuAssessed" id="amortisedApg"
                                class="numeric form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['pmuAssessed'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <!-- <label i18n for="progressPayment" class="control-label col-md-2">Progress Payment to date</label>
                        <div class="col-md-4">
                            <input name="progressPayment" formatM formControlName="progressPayment" id="progressPayment"
                                class="numeric form-control" 
                                [ngClass]="psrPerformanceEvaluationForm.controls['progressPayment'].valid ? 'valid-input' : 'required-input'">
                        </div> -->
                        <!-- <label i18n for="initialProjectSum" class="control-label col-md-2">Project Cost at Inception</label>
                        <div class="col-md-4">
                            <input name="initialProjectSum" formControlName="initialProjectSum" id="initialProjectSum"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['initialProjectSum'].valid ? 'valid-input' : 'required-input'">
                        </div> -->
                    </div>
                    <div class="form-group">

                        <label i18n for="disbursedTodate" class="control-label col-md-2">Amount Disbursed To Date</label>
                        <div class="col-md-4">
                            <input name="disbursedTodate" formControlName="disbursedTodate" id="disbursedTodate"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['disbursedTodate'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="consoltantVowd" class="control-label col-md-2">Independent Consultant VOWD To   Date</label>
                        <div class="col-md-4">
                            <input type="text" name="consoltantVowd" formatM formControlName="consoltantVowd" id="amortisedApg"
                                class="numeric form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['consoltantVowd'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>

                    <div class="form-group">

                        <label i18n for="costVariation" class="control-label col-md-2">Cost Variation</label>
                        <div class="col-md-4">
                            <input name="costVariation" formControlName="costVariation" id="costVariation"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['costVariation'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="timeVariation" class="control-label col-md-2">Time Variation</label>
                        <div class="col-md-4">
                            <input type="text" name="timeVariation" formControlName="timeVariation" id="amortisedApg"
                                class=" form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['timeVariation'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>

                    <div class="form-group" *ngIf="psrReportTypeId==2" >

                        <label i18n for="certifiedVowd" class="control-label col-md-2">Certified VOWD To Date</label>
                        <div class="col-md-4">
                            <input name="certifiedVowd" formatM formControlName="certifiedVowd" id="certifiedVowd"
                                class="numeric form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['certifiedVowd'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="pmuAssessed" class="control-label col-md-2">PMU Assessd VOWD To Date</label>
                        <div class="col-md-4">
                            <input type="text" name="pmuAssessed" formatM formControlName="pmuAssessed" id="amortisedApg"
                                class="numeric form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['pmuAssessed'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>

                    <div *ngIf="psrReportTypeId==2" class="form-group">
                        <label i18n for="haircut" class="control-label col-md-2"> APG Amount  Received</label>
                        <div class="col-md-4">
                            <input name="amountReceived" formControlName="amountReceived" id="amountReceived"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['amountReceived'].valid ? 'valid-input' : 'required-input'">
                        </div>
                        <label i18n for="haircut" class="control-label col-md-2">APG Issued</label>
                        <div class="col-md-4">
                            <input name="apgIssued" formatM formControlName="apgIssued" id="apgIssued" class="numeric form-control"
                                [ngClass]="psrPerformanceEvaluationForm.controls['apgIssued'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>

                    <div class="form-group">

                        <label i18n *ngIf="psrReportTypeId==2" for="projectSum" class="control-label col-md-2">Amortised  APG</label>
                        <div *ngIf="psrReportTypeId==2" class="col-md-4">
                            <input type="text" name="apgReceived" formControlName="amortisedApg" id="amortisedApg"
                                class="numeric form-control" formatM
                                [ngClass]="psrPerformanceEvaluationForm.controls['amortisedApg'].valid ? 'valid-input' : 'required-input'">
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="savePsrPerformanceEvaluation(psrPerformanceEvaluationForm)"
                        [disabled]="psrPerformanceEvaluationForm.invalid" class="btn btn-success pull-right">Save and  Close</button>
                    <button type="button" (click)="displayPsrPerformanceEvaluation=false" style="margin-right:5px"
                        class="btn btn-danger pull-right">Cancel</button>
                </div>
            </div>
        </div>
    </div>

</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayReport" width="1200" modal="modal" showEffect="fade">
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="row">
                <div class="col-md-12">
                    <h2 i18n class="panel-title pull-left">
                        Project Site Report

                    </h2>
                    <button type="button" (click)="displayReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>


                </div>
            </div>
        </div>
        <div class="panel-body">

            <div class="col-md-12" *ngIf="displayTestReport" style=" width:1200px; overflow:auto;">
                <iframe [src]="reportSrc" id="report" name="report" frameborder="2" height="500px" width="1500px"
                    style="overflow:auto"></iframe>
            </div>
        </div>
    </div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12">
                <button type="button" (click)="displayReport=false" style="margin-right:5px"
                    class="btn btn-danger pull-right" i18n>Cancel</button>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="showFacilieis" width="1100" modal="modal" showEffect="fade">
    <div class="panel-heading">
        <div class="row">
            <div class="col-md-12">
                <h2 i18n class="panel-title pull-left">
                    List of Facilities
                </h2>

            </div>
        </div>
    </div>
    <div class="panel-body">
        <p-dataTable [value]="facilities" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[10,20,30]">

            <p-column i18n-header field="applicationReferenceNumber" header="Reference" sortable="true" [filter]="true"
                filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
            <p-column i18n-header field="loanReferenceNumber" header="Loan Reference" sortable="true"
                [filter]="true" filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
            <p-column i18n-header field="legalContingentCode" header="Legal Reference Code" sortable="true"
                  [filter]="true" filterMatchMode="contains" [style]="{'width':'10%'}"></p-column>
            <p-column i18n-header field="customerName" header="Customer Name" sortable="true" [filter]="true"
                filterMatchMode="contains"></p-column>
            <p-column i18n-header field="productName" header="Facility Name" sortable="true" [filter]="true"
                filterMatchMode="contains"></p-column>
            <p-column i18n-header field="relationshipOfficerName" header="Relationship Officer Name" sortable="true" [filter]="true"
                filterMatchMode="contains"></p-column>
            <p-column i18n-header field="loanPurpose" header="Loan Purpose" sortable="true" [filter]="true"
                filterMatchMode="contains"></p-column>
            <p-column i18n-header field="applicationDate" header="Date" sortable="true" [filter]="true" filterMatchMode="contains">
                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                    {{ d.applicationDate | date: 'dd-MM-yyyy' }}
                </ng-template>
            </p-column>
            <p-column i18n-header field="approvedAmount" header="Approved Amount" sortable="true" [filter]="true"
                filterMatchMode="contains" [style]="{'text-align':'right'}">
                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                    {{ d.approvedAmount | number : '1.2' }}
                </ng-template>
            </p-column>
            <p-column i18n-header field="principalAmount" header="Loan Amount" sortable="true" [filter]="true"
                filterMatchMode="contains" [style]="{'text-align':'right'}">
                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                    {{ d.principalAmount | number : '1.2' }}
                </ng-template>
            </p-column>
            <p-column i18n-header field="totalUtilized" header="Total Utilized Amount" sortable="true" [filter]="true"
                filterMatchMode="contains" [style]="{'text-align':'right'}">
                <ng-template let-d="rowData" let-i="rowIndex" pTemplate="body">
                    {{ d.totalUtilized | number : '1.2' }}
                </ng-template>
            </p-column>
            <p-column i18n-header field="isProjectRelated" header="Is Project Related" sortable="true" filterMatchMode="contains">
            </p-column>
        </p-dataTable>
    </div>
    <div class="panel-footer">
        <div class="row">
            <div class="col-md-12">
                <button type="button" (click)="showFacilieis=false" class="btn btn-success pull-right" i18n>Close</button>

            </div>
        </div>
    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayImagesReport" id="image-modal" modal="modal" showEffect="fade"
    width="800">

    <div style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Site Comment Images
            </h2>
        </div>

        <form novalidate [formGroup]="psrImageForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label i18n for="Picture" class="control-label col-md-4">Upload Picture</label>
                        <div class="col-md-8">
                            <input type="file" (change)="onFileChange($event)" formControlName="fileData"
                                [ngClass]="!psrImageForm.controls['fileData'].valid ? 'required-input' : 'valid-input'"
                                placeholder="Upload file" accept=".jpg,.jpeg,.JPG,.PNG,.png,JPEG" #fileInput
                                name="fileInput" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label i18n for="Image Caption" class="control-label col-md-4">Image Caption</label>
                        <div class="col-md-8">
                            <textarea formControlName="imageCaption"
                                [ngClass]="!psrImageForm.controls['imageCaption'].valid ? 'required-input' : 'valid-input'"
                                class="form-control"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="savePsrImage(psrImageForm)" [disabled]="psrImageForm.invalid"
                        class="btn btn-success pull-right" i18n>Save and  Close</button>
                    <button type="button" (click)="displayImagesReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>
</p-dialog>

<p-dialog [responsive]=true [(visible)]="displayCommentImagesReport" id="image-modal" modal="modal" showEffect="fade"
    width="800">

    <div style="margin-bottom:0" class="panel panel-default">

        <div class="panel-heading">
            <h2 i18n class="panel-title">
                Project Comment Images
            </h2>
        </div>

        <form novalidate [formGroup]="psrCommentImageForm" autocomplete="off">
            <div class="panel-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label i18n for="Picture" class="control-label col-md-4">Upload Picture</label>
                        <div class="col-md-8">
                            <input type="file" (change)="onFileChange($event)" formControlName="fileData"
                                [ngClass]="!psrCommentImageForm.controls['fileData'].valid ? 'required-input' : 'valid-input'"
                                placeholder="Upload file" accept=".jpg,.jpeg,.JPG,.PNG,.png,JPEG" #fileInput
                                name="fileInput" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label i18n for="Image Caption" class="control-label col-md-4">Image Caption</label>
                        <div class="col-md-8">
                            <textarea formControlName="imageCaption"
                                [ngClass]="!psrCommentImageForm.controls['imageCaption'].valid ? 'required-input' : 'valid-input'"
                                class="form-control"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="panel-footer">
            <div class="row">
                <div class="col-md-12">
                    <button type="button" (click)="saveCommentImage(psrCommentImageForm)" [disabled]="psrCommentImageForm.invalid"
                        class="btn btn-success pull-right" i18n>Save</button>
                        <button type="button" (click)="displayCommentImagesReport=false" style="margin-right:5px"
                        class="btn btn-danger pull-right" i18n>Cancel</button>
                </div>
            </div>
        </div>


    </div>
</p-dialog>